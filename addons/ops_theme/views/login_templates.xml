<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <!-- ===================================================================== -->
    <!-- OPS THEME v2.0 - SPLIT-SCREEN LOGIN                                   -->
    <!-- ===================================================================== -->

    <!-- Override login_layout to use split-screen design -->
    <template id="login_layout" inherit_id="web.login_layout" name="OPS Login Layout" priority="100">
        <!-- Replace the container with our split-screen layout -->
        <xpath expr="//div[hasclass('container')]" position="replace">
            <t t-set="company" t-value="request.env.company"/>
            <main class="ops-login-wrapper">
                <div class="ops-login-container">

                    <!-- LEFT PANEL: Company Branding -->
                    <div class="ops-login-brand"
                         t-attf-style="background: linear-gradient(135deg, #{company.ops_primary_color or '#1e293b'} 0%, #0f172a 100%);">

                        <!-- Company Logo -->
                        <img t-attf-src="/web/binary/company_logo?company={{ company.id }}"
                             class="ops-login-logo"
                             alt="Company Logo"
                             onerror="this.style.display='none'"/>

                        <!-- Welcome Container -->
                        <div class="ops-login-welcome">
                            <h1>Welcome</h1>
                            <p t-if="company and company.name" t-esc="company.ops_login_tagline or company.name"/>
                            <p t-else="">Enterprise Resource Planning</p>
                        </div>

                        <!-- Decorative Element -->
                        <div class="ops-login-decoration">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>

                    <!-- RIGHT PANEL: Login Form -->
                    <div class="ops-login-form-panel">
                        <div class="ops-login-form-container">

                            <!-- Mobile Logo (shown only on small screens) -->
                            <div class="ops-login-mobile-logo">
                                <img t-attf-src="/web/binary/company_logo?company={{ company.id }}"
                                     alt="Company Logo"
                                     onerror="this.parentElement.style.display='none'"/>
                            </div>

                            <!-- Login Header -->
                            <div class="ops-login-header">
                                <h2>Sign In</h2>
                                <p>Enter your credentials to access your account</p>
                            </div>

                            <!-- Original login content inserted here -->
                            <t t-out="0"/>

                            <!-- Footer -->
                            <div class="ops-login-footer">
                                <small>Powered by <strong>OPS Framework</strong></small>
                            </div>
                        </div>
                    </div>

                </div>
            </main>
        </xpath>
    </template>

    <!-- ===================================================================== -->
    <!-- Add color mode support to login page HTML element                     -->
    <!-- ===================================================================== -->
    <template id="login_html_attrs" inherit_id="web.frontend_layout" name="OPS Login HTML Attrs" priority="99">
        <xpath expr="//html" position="attributes">
            <attribute name="data-color-mode">light</attribute>
        </xpath>
    </template>

    <!-- ===================================================================== -->
    <!-- Inject critical inline styles for login (before SCSS loads)          -->
    <!-- ===================================================================== -->
    <template id="login_inline_styles" inherit_id="web.frontend_layout" name="OPS Login Inline Styles" priority="101">
        <xpath expr="//head" position="inside">
            <style type="text/css">
                /* Critical CSS v2.0 - loads before SCSS to prevent flash */
                html, body, .ops-login-body {
                    margin: 0 !important;
                    padding: 0 !important;
                    min-height: 100vh;
                    overflow-x: hidden;
                }
                .ops-login-wrapper {
                    min-height: 100vh;
                    display: flex;
                }
                .ops-login-container {
                    display: flex !important;
                    width: 100%;
                    min-height: 100vh;
                }
                .ops-login-brand {
                    flex: 1;
                    display: flex !important;
                    flex-direction: column;
                    align-items: center;
                    justify-content: center;
                    padding: 3rem;
                    color: #fff;
                    position: relative;
                    overflow: hidden;
                }
                .ops-login-form-panel {
                    flex: 1;
                    display: flex !important;
                    align-items: center;
                    justify-content: center;
                    padding: 3rem 2rem;
                    background-color: #ffffff;
                }
                /* Hide default Odoo card styling */
                .ops-login-form-panel .card {
                    background: transparent !important;
                    border: none !important;
                    box-shadow: none !important;
                    max-width: none !important;
                }
                .ops-login-form-panel .card-body {
                    padding: 0 !important;
                }
                /* Hide default Odoo login header/footer */
                .ops-login-form-panel .text-center.pb-3.border-bottom,
                .ops-login-form-panel .text-center.pb-3,
                .ops-login-form-panel .text-center.small.border-top,
                .ops-login-form-panel .text-center.small {
                    display: none !important;
                }
                /* Mobile: hide brand panel */
                @media (max-width: 767.98px) {
                    .ops-login-brand { display: none !important; }
                    .ops-login-mobile-logo { display: block !important; }
                    .ops-login-form-panel { min-height: 100vh; }
                }
                @media (min-width: 768px) {
                    .ops-login-mobile-logo { display: none; }
                }
            </style>
        </xpath>
    </template>

</odoo>
