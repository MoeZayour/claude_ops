<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <!-- ===================================================================== -->
    <!-- Override login_layout to use split-screen design                      -->
    <!-- ===================================================================== -->
    <template id="login_layout" inherit_id="web.login_layout" name="OPS Login Layout" priority="100">
        <!-- Replace the container with our split-screen layout -->
        <xpath expr="//div[hasclass('container')]" position="replace">
            <t t-set="company" t-value="request.env.company"/>
            <main class="ops-login-wrapper">
                <div class="ops-login-container">

                    <!-- Left Panel: Company Branding -->
                    <div t-attf-class="ops-login-brand"
                         t-attf-style="background-color: #{company.ops_primary_color or '#1e293b'};">

                        <!-- Company Logo -->
                        <img t-attf-src="/web/binary/company_logo?company={{ company.id }}"
                             class="ops-login-logo"
                             alt="Company Logo"
                             onerror="this.style.display='none'"/>

                        <!-- Tagline -->
                        <h1 class="ops-login-tagline"
                            t-esc="company.ops_login_tagline or 'Enterprise Resource Planning'"/>
                    </div>

                    <!-- Right Panel: Login Form -->
                    <div class="ops-login-form-panel">
                        <div class="ops-login-form-container">
                            <h2 class="ops-login-title">Sign In</h2>

                            <!-- Original login content inserted here -->
                            <t t-out="0"/>

                            <!-- Powered by Footer -->
                            <p class="ops-powered-by">
                                Powered by <strong>OPS Framework</strong>
                            </p>
                        </div>
                    </div>

                </div>
            </main>
        </xpath>
    </template>

    <!-- ===================================================================== -->
    <!-- Add color mode support to login page HTML element                     -->
    <!-- ===================================================================== -->
    <template id="login_html_attrs" inherit_id="web.frontend_layout" name="OPS Login HTML Attrs" priority="99">
        <xpath expr="//html" position="attributes">
            <attribute name="data-color-mode">light</attribute>
        </xpath>
    </template>

    <!-- ===================================================================== -->
    <!-- Inject critical inline styles for login (before SCSS loads)          -->
    <!-- ===================================================================== -->
    <template id="login_inline_styles" inherit_id="web.frontend_layout" name="OPS Login Inline Styles" priority="101">
        <xpath expr="//head" position="inside">
            <style type="text/css">
                /* Critical CSS - loads before SCSS to prevent flash */
                html, body, .ops-login-body {
                    margin: 0 !important;
                    padding: 0 !important;
                    min-height: 100vh;
                    overflow-x: hidden;
                }
                .ops-login-wrapper {
                    min-height: 100vh;
                    display: flex;
                }
                .ops-login-container {
                    display: flex !important;
                    width: 100%;
                    min-height: 100vh;
                }
                .ops-login-brand {
                    flex: 1;
                    display: flex !important;
                    flex-direction: column;
                    align-items: center;
                    justify-content: center;
                    padding: 2rem;
                    color: #fff;
                }
                .ops-login-form-panel {
                    flex: 1;
                    display: flex !important;
                    align-items: center;
                    justify-content: center;
                    padding: 2rem;
                    background-color: #ffffff;
                }
                /* Hide default Odoo card styling */
                .ops-login-form-panel .card {
                    background: transparent !important;
                    border: none !important;
                    box-shadow: none !important;
                    max-width: none !important;
                }
                .ops-login-form-panel .card-body {
                    padding: 0 !important;
                }
                /* Hide default Odoo login header/footer */
                .ops-login-form-panel .text-center.pb-3.border-bottom,
                .ops-login-form-panel .text-center.small.border-top {
                    display: none !important;
                }
                /* Mobile: hide brand panel */
                @media (max-width: 767.98px) {
                    .ops-login-brand { display: none !important; }
                    .ops-login-form-panel { min-height: 100vh; }
                }
            </style>
        </xpath>
    </template>

</odoo>
