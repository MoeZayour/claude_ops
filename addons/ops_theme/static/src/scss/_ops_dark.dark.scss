///
/// OPS Dark Mode — Essential Overrides
/// ====================================
/// Design tokens + Bootstrap variable fixes + OPS-specific dark overrides.
/// Odoo's 62+ native .dark.scss files handle mail, editor, spreadsheet etc.
/// BS5 auto-inverts most standard components via [data-bs-theme="dark"].
///
/// This file fills gaps: bg-view hatching, form sheet surfaces, settings page,
/// and the #1e293b primary color derivation issue (muted link colors).
///

// =============================================================================
// DESIGN TOKENS + BOOTSTRAP VARIABLE OVERRIDES
// =============================================================================

html[data-bs-theme="dark"] {
    // OPS surface layers
    --ops-dm-bg-deep:      #0f172a;
    --ops-dm-bg-surface:   #1e293b;
    --ops-dm-bg-elevated:  #263548;
    --ops-dm-bg-hover:     #334155;

    // Borders
    --ops-dm-border:       #475569;
    --ops-dm-border-subtle:#334155;

    // Text
    --ops-dm-text:         #f1f5f9;
    --ops-dm-text-body:    #cbd5e1;
    --ops-dm-text-muted:   #94a3b8;

    // Accent
    --ops-dm-accent:       #3b82f6;
    --ops-dm-accent-hover: #60a5fa;
    --ops-dm-accent-subtle:rgba(59,130,246,0.15);

    // Fix BS5 dark derivations from #1e293b primary (CRITICAL)
    --body-bg:        var(--ops-dm-bg-deep);
    --body-color:     var(--ops-dm-text-body);
    --secondary-bg:   var(--ops-dm-bg-surface);
    --tertiary-bg:    var(--ops-dm-bg-elevated);
    --border-color:   var(--ops-dm-border);
    --link-color:     var(--ops-dm-accent);
    --link-hover-color: var(--ops-dm-accent-hover);
    --link-color-rgb: 59, 130, 246;
    --link-hover-color-rgb: 96, 165, 250;
    --primary-text-emphasis: #60a5fa;
    --primary-bg-subtle: #1a2744;
    --primary-border-subtle: #2d4a7a;
}

// =============================================================================
// CORE LAYOUT — Fix bg-view hatched pattern + form surfaces
// =============================================================================

html[data-bs-theme="dark"] {
    .o_web_client {
        background-color: var(--ops-dm-bg-deep) !important;
        color-scheme: dark;
    }
    .o_action_manager, .o_content, .o_view_controller, .o_form_sheet_bg, .o_form_nosheet, .bg-view {
        background-color: var(--ops-dm-bg-deep) !important;
        background-image: none !important;
    }
    .o_form_sheet {
        background-color: var(--ops-dm-bg-surface) !important;
        border-color: var(--ops-dm-border) !important;
    }
}

// =============================================================================
// SETTINGS — OPS compile-time variable overrides
// =============================================================================

html[data-bs-theme="dark"] {
    .o_base_settings_view .o_form_renderer {
        --settings__tab-bg: var(--ops-dm-bg-surface);
        --settings__tab-bg--active: var(--ops-dm-accent-subtle);
        --settings__tab-color: var(--ops-dm-text-body);
        --settings__title-bg: var(--ops-dm-bg-surface);
    }
    .o_setting_container .settings,
    .o_settings_container, .o_base_settings,
    .app_settings_block {
        background-color: var(--ops-dm-bg-deep) !important;
        background-image: none !important;
    }
    .app_settings_block h2 {
        background-color: var(--ops-dm-bg-surface) !important;
        color: var(--ops-dm-text) !important;
    }
}

// =============================================================================
// NAVBAR — Branded bar border in dark mode
// =============================================================================

html[data-bs-theme="dark"] .o_main_navbar {
    border-bottom: 1px solid var(--ops-dm-border) !important;
}
