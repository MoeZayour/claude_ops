<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- KPI Security Groups -->
    <record id="group_kpi_user" model="res.groups">
        <field name="name">KPI User</field>
        <field name="comment">Can view KPI boards and KPIs</field>
    </record>

    <record id="group_kpi_manager" model="res.groups">
        <field name="name">KPI Manager</field>
        <field name="implied_ids" eval="[(4, ref('group_kpi_user'))]"/>
        <field name="comment">Can create and configure KPI boards</field>
    </record>

    <!-- Record Rules for ops.kpi.board -->
    <record id="rule_kpi_board_company" model="ir.rule">
        <field name="name">KPI Board: Company Filter</field>
        <field name="model_id" ref="model_ops_kpi_board"/>
        <field name="domain_force">[('company_id', 'in', company_ids)]</field>
        <field name="groups" eval="[(4, ref('base.group_user'))]"/>
    </record>

    <!-- Record Rules for ops.kpi -->
    <record id="rule_kpi_all" model="ir.rule">
        <field name="name">KPI: All Users Can Read</field>
        <field name="model_id" ref="model_ops_kpi"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('base.group_user'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="False"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>

    <record id="rule_kpi_manager_full" model="ir.rule">
        <field name="name">KPI: Managers Full Access</field>
        <field name="model_id" ref="model_ops_kpi"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('group_kpi_manager'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="True"/>
        <field name="perm_unlink" eval="True"/>
    </record>

    <!-- Record Rules for ops.kpi.value -->
    <record id="rule_kpi_value_company" model="ir.rule">
        <field name="name">KPI Value: Company Filter</field>
        <field name="model_id" ref="model_ops_kpi_value"/>
        <field name="domain_force">[('company_id', 'in', company_ids)]</field>
        <field name="groups" eval="[(4, ref('base.group_user'))]"/>
    </record>

    <!-- IT Admin Blindness for KPI Values -->
    <record id="rule_kpi_value_it_admin_blind" model="ir.rule">
        <field name="name">KPI Value: IT Admin Blindness</field>
        <field name="model_id" ref="model_ops_kpi_value"/>
        <field name="domain_force">[('id', '=', 0)]</field>
        <field name="groups" eval="[(4, ref('ops_matrix_core.group_ops_it_admin'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="True"/>
        <field name="perm_unlink" eval="True"/>
    </record>

    <!-- Record Rules for ops.kpi.widget -->
    <record id="rule_kpi_widget_user" model="ir.rule">
        <field name="name">KPI Widget: Users Can Read</field>
        <field name="model_id" ref="model_ops_kpi_widget"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('base.group_user'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="False"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>

    <record id="rule_kpi_widget_manager" model="ir.rule">
        <field name="name">KPI Widget: Managers Full Access</field>
        <field name="model_id" ref="model_ops_kpi_widget"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('group_kpi_manager'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="True"/>
        <field name="perm_unlink" eval="True"/>
    </record>
</odoo>
