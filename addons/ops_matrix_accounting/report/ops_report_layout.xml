<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!--
        OPS Matrix Corporate Report Layout
        ==================================
        PHASE 24: THE MERIDIAN NATIVE (wkhtmltopdf)

        DESIGN PHILOSOPHY:
        - "Meridian Executive" aesthetic - Management Consulting feel
        - High contrast: Deep Black (#000000) + Executive Gold (#c9a962) + Red (#DA291C)
        - TABLE-BASED LAYOUTS ONLY (wkhtmltopdf compatible)
        - NO Flexbox, NO Grid, NO CSS Variables
        - Inline CSS preferred for reliability

        TYPOGRAPHY:
        - Primary: Georgia (serif for elegance)
        - Sans: Arial, Helvetica (headers)
        - Monospace: Consolas (numbers)

        VALUE DISPLAY:
        - Zeros: Show as "0.00" in Light Grey (#cccccc)
        - Negatives: Red (#DA291C) with parentheses
        - Positives: Black

        WKHTMLTOPDF COMPATIBILITY:
        - Uses basic CSS2.1 properties
        - Table-based layouts
        - Inline styles for reliability
        - No modern CSS features
    -->

    <!-- ============================================
         THE MERIDIAN NATIVE - MASTER STYLESHEET
         ============================================ -->
    <template id="ops_report_styles">
        <style type="text/css">
            /* ============================================
               PHASE 24: THE MERIDIAN NATIVE
               wkhtmltopdf-Compatible Design System
               ============================================ */

            /* === PAGE SETUP === */
            @page {
                size: A4 portrait;
                margin: 15mm 15mm 20mm 15mm;
            }

            /* === FORCE PRINT COLORS === */
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            /* === BASE TYPOGRAPHY === */
            body, html {
                font-family: Arial, Helvetica, sans-serif;
                font-size: 10pt;
                line-height: 1.4;
                color: #000000;
                background-color: #ffffff;
                margin: 0;
                padding: 0;
            }

            /* ============================================
               THE MERIDIAN PAGE CONTAINER
               ============================================ */
            .ops-meridian-page {
                background: #ffffff;
                padding: 0;
                margin: 0;
            }

            .ops-report,
            .ops-report-container,
            .ops-consulting-page {
                background: #ffffff;
            }

            /* Meridian Page with padding (for content pages) */
            .ops-meridian-page.padded {
                padding: 40px;
            }

            /* ============================================
               MERIDIAN DESIGN TOKENS (CSS2.1 Compatible)
               ============================================
               These are the core color constants used throughout:
               - GOLD: #C9A962 (Executive Gold - Brand accent)
               - BLACK: #1A1A1A (Primary Black - Text/headers)
               - RED: #DA291C (Corporate Red - Negatives)
               - MUTED: #FAFAFA (Light Grey - Backgrounds)
               - ZERO: #cccccc (Zero values display)
            ============================================ */

            /* ============================================
               MERIDIAN HEADER SYSTEM (Table-Based)
               Two-Column Layout: Company Left, Report Details Right
               ============================================ */

            /* The iconic gold top border - MERIDIAN GOLD #C9A962 */
            .ops-meridian-accent {
                height: 4px;
                background-color: #C9A962;
                border: none;
                margin: 0;
                padding: 0;
            }

            /* Gold accent bar with margin */
            .ops-meridian-gold-bar {
                height: 4px;
                background-color: #C9A962;
                margin-bottom: 20px;
            }

            /* Master header table - 2-column layout */
            .ops-header-master,
            .ops-meridian-header {
                width: 100%;
                border-collapse: collapse;
                margin-top: 20px;
            }

            .ops-header-master td,
            .ops-meridian-header td {
                vertical-align: top;
                padding: 0;
            }

            .ops-meridian-header .left-col {
                width: 60%;
                vertical-align: top;
            }

            .ops-meridian-header .right-col {
                width: 40%;
                text-align: right;
                vertical-align: top;
            }

            /* Report title styling - Georgia serif for elegance */
            .ops-title-main {
                font-size: 32px;
                font-weight: 300;
                font-family: Georgia, 'Times New Roman', serif;
                color: #1A1A1A;
                margin: 0;
                padding: 0;
                line-height: 1.1;
            }

            .ops-title-company {
                font-size: 14px;
                font-weight: 600;
                color: #666666;
                text-transform: uppercase;
                letter-spacing: 2px;
                margin-top: 8px;
            }

            .ops-title-date {
                font-size: 10px;
                color: #999999;
                text-transform: uppercase;
                letter-spacing: 1px;
            }

            /* Black separator line - Primary Black #1A1A1A */
            .ops-header-separator {
                height: 2px;
                background-color: #1A1A1A;
                border: none;
                margin: 15px 0 20px 0;
            }

            /* ============================================
               ACCOUNTING EQUATION BAR (Balance Sheet)
               ============================================ */
            .ops-equation-bar {
                width: 100%;
                text-align: center;
                padding: 20px 0;
                border-bottom: 1px solid #eeeeee;
                margin-bottom: 25px;
            }

            .ops-equation-text {
                font-size: 20px;
                font-family: Georgia, 'Times New Roman', serif;
                color: #000000;
            }

            .ops-equation-symbol {
                color: #cccccc;
                margin: 0 15px;
            }

            /* ============================================
               META INFO BAR
               ============================================ */
            .ops-meta-bar {
                background-color: #f8f9fa;
                border: 1px solid #e5e7eb;
                padding: 12px 16px;
                margin-bottom: 25px;
            }

            .ops-meta-bar table {
                width: 100%;
                border-collapse: collapse;
            }

            .ops-meta-bar td {
                padding: 4px 8px;
                vertical-align: top;
            }

            .ops-meta-label {
                font-weight: 600;
                color: #374151;
                text-transform: uppercase;
                letter-spacing: 0.3px;
                font-size: 8pt;
            }

            .ops-meta-value {
                color: #000000;
                font-weight: 500;
                font-size: 10pt;
            }

            /* ============================================
               THE MERIDIAN TABLE (Core Data Table)
               - Headers: Light grey bg (#FAFAFA), black bottom border
               - Numbers: Georgia serif, right-aligned
               - tr.total: Double bottom border
               ============================================ */
            .ops-native-table,
            .ops-table-consulting,
            .ops-meridian-table {
                width: 100%;
                border-collapse: collapse;
                font-size: 10pt;
                margin-bottom: 20px;
            }

            /* Table Headers - Muted background with black border */
            .ops-native-table thead th,
            .ops-table-consulting thead th,
            .ops-meridian-table thead th,
            .ops-header-row th {
                background-color: #FAFAFA;
                padding: 12px 10px;
                text-align: left;
                font-size: 8pt;
                font-weight: 600;
                color: #374151;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 2px solid #1A1A1A;
                font-family: Arial, Helvetica, sans-serif;
            }

            .ops-native-table thead th.text-end,
            .ops-table-consulting thead th.text-end,
            .ops-meridian-table thead th.text-end,
            .ops-native-table thead th.num,
            .ops-table-consulting thead th.num,
            .ops-meridian-table thead th.num {
                text-align: right;
            }

            /* Table Body Cells */
            .ops-native-table tbody td,
            .ops-table-consulting tbody td,
            .ops-meridian-table tbody td {
                padding: 10px;
                color: #1A1A1A;
                border-bottom: 1px solid #e5e7eb;
                vertical-align: middle;
            }

            /* Number cells - Georgia serif font */
            .ops-native-table tbody td.text-end,
            .ops-table-consulting tbody td.text-end,
            .ops-meridian-table tbody td.text-end,
            .ops-native-table tbody td.num,
            .ops-table-consulting tbody td.num,
            .ops-meridian-table tbody td.num,
            .ops-value-cell,
            td.number {
                text-align: right;
                font-family: Georgia, 'Times New Roman', serif;
                font-size: 10pt;
            }

            /* === SECTION TITLES === */
            .ops-section-title {
                color: #DA291C;
                font-weight: bold;
                text-transform: uppercase;
                letter-spacing: 2px;
                font-size: 11pt;
                padding: 15px 10px 8px 10px;
                border-bottom: 1px solid #cccccc;
            }

            /* === INDENTATION LEVELS === */
            .indent-0, .level-0 {
                padding-left: 10px;
                font-weight: 700;
            }

            .indent-1, .level-1 {
                padding-left: 25px;
                font-weight: 600;
            }

            .indent-2, .level-2 {
                padding-left: 45px;
                font-weight: 400;
            }

            .indent-3, .level-3 {
                padding-left: 65px;
                font-weight: 400;
                font-style: italic;
                color: #4b5563;
            }

            /* === VALUE STYLING === */
            .ops-value-zero {
                color: #cccccc !important;
            }

            .ops-value-negative {
                color: #DA291C !important;
            }

            .ops-value-positive {
                color: #000000 !important;
            }

            .ops-value-revenue {
                color: #059669 !important;
            }

            .ops-value-expense {
                color: #DA291C !important;
            }

            /* === ROW TYPES === */
            /* Section Header Row */
            tr.section-header td,
            .ops-native-table tr.section-header td,
            .ops-table-consulting tr.section-header td,
            .ops-meridian-table tr.section-header td {
                font-weight: 700;
                font-size: 11pt;
                color: #1A1A1A;
                padding-top: 18px;
                padding-bottom: 8px;
                border-bottom: 1px solid #9ca3af;
                background-color: transparent;
            }

            /* Subtotal Row */
            tr.subtotal-row td,
            .ops-native-table tr.subtotal-row td,
            .ops-table-consulting tr.subtotal-row td,
            .ops-meridian-table tr.subtotal-row td {
                font-weight: 600;
                border-top: 1px solid #1A1A1A;
                background-color: #FAFAFA;
                padding-top: 10px;
                padding-bottom: 10px;
            }

            /* Total Row - Single top, DOUBLE bottom border (MERIDIAN STANDARD) */
            tr.total-row td,
            tr.total td,
            .ops-native-table tr.total-row td,
            .ops-table-consulting tr.total-row td,
            .ops-meridian-table tr.total-row td,
            .ops-meridian-table tr.total td,
            .ops-total-row td {
                font-weight: 700;
                font-size: 11pt;
                border-top: 2px solid #1A1A1A;
                border-bottom: 4px double #1A1A1A;
                padding-top: 12px;
                padding-bottom: 12px;
                background-color: #ffffff;
            }

            /* Grand Total Row - Primary Black background */
            tr.grand-total-row td,
            tr.grand-total td,
            .ops-native-table tr.grand-total-row td,
            .ops-table-consulting tr.grand-total-row td,
            .ops-meridian-table tr.grand-total-row td,
            .ops-meridian-table tr.grand-total td {
                font-weight: 700;
                font-size: 12pt;
                background-color: #1A1A1A !important;
                color: #ffffff !important;
                padding: 14px 10px;
                border: none;
            }

            tr.grand-total-row td.num,
            tr.grand-total td.num,
            .ops-native-table tr.grand-total-row td.num,
            .ops-table-consulting tr.grand-total-row td.num,
            .ops-meridian-table tr.grand-total-row td.num,
            .ops-meridian-table tr.grand-total td.num {
                color: #ffffff !important;
                font-family: Georgia, 'Times New Roman', serif;
            }

            /* Alternating row backgrounds */
            .ops-native-table.striped tbody tr:nth-child(even) td,
            .ops-table-consulting.striped tbody tr:nth-child(even) td {
                background-color: #fafafa;
            }

            /* ============================================
               SECTION BLOCKS (Colored Headers)
               MERIDIAN COLOR ASSIGNMENTS:
               - Revenue/Equity: Green (#059669)
               - Expense: Red (#DA291C)
               - Asset: Blue (#2563eb)
               - Liability: Orange (#d97706)
               - Neutral: Primary Black (#1A1A1A)
               ============================================ */
            .ops-section-block {
                margin-bottom: 25px;
            }

            .ops-section-header {
                padding: 10px 14px;
                color: #ffffff;
                font-weight: 700;
                font-size: 11pt;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                font-family: Arial, Helvetica, sans-serif;
            }

            .ops-section-header.revenue { background-color: #059669 !important; }
            .ops-section-header.expense { background-color: #DA291C !important; }
            .ops-section-header.asset { background-color: #2563eb !important; }
            .ops-section-header.liability { background-color: #d97706 !important; }
            .ops-section-header.equity { background-color: #059669 !important; }
            .ops-section-header.neutral { background-color: #1A1A1A !important; }
            .ops-section-header.gold { background-color: #C9A962 !important; }

            .ops-section-header table {
                width: 100%;
                border-collapse: collapse;
            }

            .ops-section-header .section-title {
                color: #ffffff;
            }

            .ops-section-header .section-amount {
                text-align: right;
                font-family: Georgia, 'Times New Roman', serif;
                color: #ffffff;
            }

            /* ============================================
               SUMMARY BOX (Results / Totals)
               ============================================ */
            .ops-summary-box {
                margin-top: 25px;
                padding: 20px 25px;
            }

            .ops-summary-box.profit {
                background-color: #059669 !important;
                color: #ffffff;
            }

            .ops-summary-box.loss {
                background-color: #DA291C !important;
                color: #ffffff;
            }

            .ops-summary-box.neutral {
                background-color: #000000 !important;
                color: #ffffff;
            }

            .ops-summary-label {
                font-size: 9pt;
                font-weight: 600;
                color: #ffffff;
                text-transform: uppercase;
                letter-spacing: 1px;
            }

            .ops-summary-equation {
                font-size: 9pt;
                color: #cccccc;
                margin-top: 3px;
            }

            .ops-summary-value {
                font-family: Georgia, 'Times New Roman', serif;
                font-size: 28pt;
                font-weight: 700;
                color: #ffffff;
            }

            .ops-summary-badge {
                background-color: rgba(255, 255, 255, 0.15);
                border: 1px solid rgba(255, 255, 255, 0.25);
                padding: 10px 16px;
                text-align: center;
            }

            .ops-summary-badge-text {
                font-size: 11pt;
                font-weight: 600;
                color: #ffffff;
            }

            /* ============================================
               MARGIN / PERFORMANCE INDICATOR
               ============================================ */
            .ops-margin-card {
                background-color: #ffffff;
                border: 1px solid #e5e7eb;
                border-left: 4px solid #000000;
                padding: 16px 20px;
                margin-top: 20px;
            }

            .ops-margin-card.excellent { border-left-color: #059669; }
            .ops-margin-card.healthy { border-left-color: #2563eb; }
            .ops-margin-card.warning { border-left-color: #d97706; }
            .ops-margin-card.critical { border-left-color: #DA291C; }

            .ops-margin-label {
                font-size: 9pt;
                font-weight: 600;
                color: #374151;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }

            .ops-margin-formula {
                font-size: 9pt;
                color: #6b7280;
                margin-top: 2px;
            }

            .ops-margin-value {
                font-family: Georgia, 'Times New Roman', serif;
                font-size: 32pt;
                font-weight: 700;
            }

            .ops-margin-value.excellent { color: #059669; }
            .ops-margin-value.healthy { color: #2563eb; }
            .ops-margin-value.warning { color: #d97706; }
            .ops-margin-value.critical { color: #DA291C; }

            /* ============================================
               STATUS PILLS
               ============================================ */
            .ops-status-pill {
                display: inline-block;
                padding: 6px 14px;
                font-size: 9pt;
                font-weight: 600;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }

            .ops-status-pill.excellent { background-color: #d1fae5; color: #059669; }
            .ops-status-pill.healthy { background-color: #dbeafe; color: #2563eb; }
            .ops-status-pill.acceptable { background-color: #f3f4f6; color: #4b5563; }
            .ops-status-pill.warning { background-color: #fef3c7; color: #d97706; }
            .ops-status-pill.loss { background-color: #fee2e2; color: #DA291C; }

            /* ============================================
               ALERT BANNERS
               ============================================ */
            .ops-alert {
                padding: 14px 18px;
                margin: 15px 0;
                border-left: 4px solid;
                font-size: 10pt;
            }

            .ops-alert.success {
                background-color: #ecfdf5;
                border-color: #059669;
                color: #065f46;
            }

            .ops-alert.warning {
                background-color: #fffbeb;
                border-color: #d97706;
                color: #92400e;
            }

            .ops-alert.danger {
                background-color: #fef2f2;
                border-color: #DA291C;
                color: #991b1b;
            }

            .ops-alert.info {
                background-color: #eff6ff;
                border-color: #2563eb;
                color: #1e40af;
            }

            .ops-alert strong {
                font-weight: 700;
            }

            /* ============================================
               NOTES SECTION
               ============================================ */
            .ops-notes-section {
                margin-top: 30px;
                padding: 16px 20px;
                background-color: #f8f9fa;
                border: 1px solid #e5e7eb;
                border-left: 4px solid #000000;
            }

            .ops-notes-title {
                font-size: 9pt;
                font-weight: 700;
                color: #374151;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                margin-bottom: 10px;
            }

            .ops-notes-list {
                list-style: none;
                margin: 0;
                padding: 0;
            }

            .ops-notes-list li {
                font-size: 9pt;
                color: #4b5563;
                padding: 4px 0 4px 18px;
                position: relative;
            }

            .ops-notes-list li:before {
                content: "\2022";
                position: absolute;
                left: 0;
                color: #DA291C;
                font-weight: bold;
            }

            /* ============================================
               PAGE FOOTER
               ============================================ */
            .ops-page-footer {
                margin-top: 35px;
                padding-top: 15px;
                border-top: 1px solid #e5e7eb;
            }

            .ops-footer-text {
                font-size: 8pt;
                color: #6b7280;
            }

            .ops-footer-confidential {
                font-size: 7pt;
                font-weight: 700;
                color: #9ca3af;
                text-transform: uppercase;
                letter-spacing: 1px;
                padding: 4px 10px;
                background-color: #f3f4f6;
                border: 1px solid #e5e7eb;
                display: inline-block;
            }

            /* ============================================
               KPI CARDS (Cover Page)
               ============================================ */
            .ops-kpi-grid {
                width: 100%;
                border-collapse: separate;
                border-spacing: 15px 0;
                margin-bottom: 25px;
            }

            .ops-kpi-card {
                background-color: #ffffff;
                border: 1px solid #e5e7eb;
                border-left: 4px solid #000000;
                padding: 18px 20px;
                vertical-align: top;
            }

            .ops-kpi-card.revenue { border-left-color: #059669; }
            .ops-kpi-card.expense { border-left-color: #DA291C; }
            .ops-kpi-card.profit { border-left-color: #059669; }
            .ops-kpi-card.loss { border-left-color: #DA291C; }
            .ops-kpi-card.asset { border-left-color: #2563eb; }
            .ops-kpi-card.neutral { border-left-color: #000000; }

            .ops-kpi-label {
                font-size: 8pt;
                font-weight: 600;
                color: #6b7280;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }

            .ops-kpi-value {
                font-family: Georgia, 'Times New Roman', serif;
                font-size: 24pt;
                font-weight: 700;
                margin-top: 6px;
                color: #000000;
            }

            .ops-kpi-value.revenue { color: #059669; }
            .ops-kpi-value.expense { color: #DA291C; }
            .ops-kpi-value.positive { color: #059669; }
            .ops-kpi-value.negative { color: #DA291C; }

            .ops-kpi-subtext {
                font-size: 9pt;
                color: #6b7280;
                margin-top: 4px;
            }

            /* ============================================
               COVER PAGE STYLING
               ============================================ */
            .ops-cover-page {
                background-color: #ffffff;
                min-height: 100%;
            }

            .ops-cover-header {
                background-color: #000000;
                padding: 30px 40px;
                color: #ffffff;
            }

            .ops-cover-logo-initial {
                display: inline-block;
                width: 56px;
                height: 56px;
                background-color: #DA291C;
                text-align: center;
                line-height: 56px;
                font-size: 28px;
                font-weight: 700;
                color: #ffffff;
                vertical-align: middle;
                margin-right: 15px;
            }

            .ops-cover-company-info {
                display: inline-block;
                vertical-align: middle;
            }

            .ops-cover-company-text {
                font-size: 22pt;
                font-weight: 700;
                color: #ffffff;
            }

            .ops-cover-tagline {
                font-size: 10pt;
                color: #999999;
                text-transform: uppercase;
                letter-spacing: 2px;
                margin-top: 4px;
            }

            .ops-cover-period-box {
                background-color: #333333;
                border: 1px solid #555555;
                padding: 12px 20px;
                text-align: right;
            }

            .ops-cover-period-label {
                font-size: 8pt;
                color: #999999;
                text-transform: uppercase;
                letter-spacing: 1px;
            }

            .ops-cover-period-value {
                font-size: 14pt;
                font-weight: 600;
                color: #ffffff;
                margin-top: 3px;
            }

            .ops-cover-accent {
                height: 5px;
                background-color: #c9a962;
            }

            .ops-cover-title-section {
                padding: 50px 40px 40px 40px;
                text-align: center;
            }

            .ops-cover-doc-type {
                font-size: 10pt;
                font-weight: 600;
                color: #DA291C;
                text-transform: uppercase;
                letter-spacing: 3px;
                margin-bottom: 12px;
            }

            .ops-cover-main-title {
                font-size: 36pt;
                font-weight: 300;
                font-family: Georgia, 'Times New Roman', serif;
                color: #000000;
                text-transform: uppercase;
                letter-spacing: 4px;
                margin: 0;
                line-height: 1.2;
            }

            .ops-cover-branch {
                font-size: 12pt;
                color: #6b7280;
                margin-top: 15px;
            }

            .ops-cover-content {
                padding: 0 40px 40px 40px;
            }

            .ops-cover-meta {
                padding: 25px 40px;
                border-top: 1px solid #e5e7eb;
                margin-top: 40px;
            }

            /* ============================================
               UTILITY CLASSES
               ============================================ */
            .text-end { text-align: right !important; }
            .text-center { text-align: center !important; }
            .text-left { text-align: left !important; }
            .font-bold { font-weight: 700; }
            .font-semibold { font-weight: 600; }
            .font-normal { font-weight: 400; }
            .no-break { page-break-inside: avoid; }

            /* Font utilities */
            .ops-font-tabular,
            .ops-mono {
                font-family: 'Consolas', 'Monaco', monospace;
            }

            .ops-uppercase {
                text-transform: uppercase;
                letter-spacing: 1.5px;
            }

            .ops-thin { font-weight: 300; }
            .ops-bold { font-weight: 700; }
            .ops-semibold { font-weight: 600; }

            /* Page break control */
            .page-break-before { page-break-before: always; }
            .page-break-after { page-break-after: always; }

            /* Legacy compatibility */
            .ops_table_matrix { width: 100%; border-collapse: collapse; }
            .ops-total-row { font-weight: 600; }
            .ops-grand-total { font-weight: 700; }

            /* ============================================
               MERIDIAN STANDARD - HIERARCHICAL ACCOUNT DISPLAY
               For Chart of Accounts indentation in reports
               ============================================ */
            /* Level indicators with visual hierarchy */
            tr.level-0 td:first-child { font-weight: 700; font-size: 11pt; color: #1A1A1A; }
            tr.level-1 td:first-child { padding-left: 20px; font-weight: 600; color: #374151; }
            tr.level-2 td:first-child { padding-left: 35px; font-weight: 500; color: #4b5563; }
            tr.level-3 td:first-child { padding-left: 50px; font-weight: 400; color: #6b7280; font-style: italic; }
            tr.level-4 td:first-child { padding-left: 65px; font-weight: 400; color: #9ca3af; font-style: italic; }

            /* Account type row styling */
            tr.account-group td { background-color: #f8f9fa; font-weight: 600; }
            tr.account-detail td { font-weight: 400; }
            tr.account-subtotal td { font-weight: 600; border-top: 1px solid #1A1A1A; }

            /* ============================================
               COMPARISON COLUMNS (Prior Year / Budget)
               ============================================ */
            .ops-compare-col {
                background-color: #f8f9fa;
            }

            .ops-variance-positive {
                color: #059669 !important;
                font-weight: 600;
            }

            .ops-variance-negative {
                color: #DA291C !important;
                font-weight: 600;
            }

            .ops-variance-neutral {
                color: #6b7280;
            }

            /* Variance percentage badge */
            .ops-variance-badge {
                display: inline-block;
                padding: 2px 8px;
                font-size: 8pt;
                font-weight: 600;
                border-radius: 2px;
            }

            .ops-variance-badge.positive {
                background-color: #d1fae5;
                color: #059669;
            }

            .ops-variance-badge.negative {
                background-color: #fee2e2;
                color: #DA291C;
            }

            /* ============================================
               KPI DASHBOARD ROW
               Horizontal metrics strip for executive summary
               ============================================ */
            .ops-kpi-strip {
                width: 100%;
                border-collapse: separate;
                border-spacing: 12px 0;
                margin-bottom: 25px;
            }

            .ops-kpi-strip td {
                background-color: #ffffff;
                border: 1px solid #e5e7eb;
                padding: 16px 18px;
                vertical-align: top;
            }

            .ops-kpi-strip td.revenue { border-left: 4px solid #059669; }
            .ops-kpi-strip td.expense { border-left: 4px solid #DA291C; }
            .ops-kpi-strip td.asset { border-left: 4px solid #2563eb; }
            .ops-kpi-strip td.liability { border-left: 4px solid #d97706; }
            .ops-kpi-strip td.equity { border-left: 4px solid #059669; }
            .ops-kpi-strip td.neutral { border-left: 4px solid #1A1A1A; }
            .ops-kpi-strip td.gold { border-left: 4px solid #C9A962; }

            /* ============================================
               SPARKLINE / TREND INDICATOR
               ============================================ */
            .ops-trend-up {
                color: #059669;
            }

            .ops-trend-up:before {
                content: "\25B2 ";
                font-size: 8pt;
            }

            .ops-trend-down {
                color: #DA291C;
            }

            .ops-trend-down:before {
                content: "\25BC ";
                font-size: 8pt;
            }

            .ops-trend-flat {
                color: #6b7280;
            }

            .ops-trend-flat:before {
                content: "\25AC ";
                font-size: 8pt;
            }

            /* ============================================
               RATIO INDICATORS (Financial Metrics)
               ============================================ */
            .ops-ratio-table {
                width: 100%;
                border-collapse: collapse;
                margin: 20px 0;
            }

            .ops-ratio-table td {
                padding: 12px 16px;
                border-bottom: 1px solid #e5e7eb;
            }

            .ops-ratio-name {
                font-weight: 600;
                color: #1A1A1A;
            }

            .ops-ratio-formula {
                font-size: 9pt;
                color: #6b7280;
                font-style: italic;
            }

            .ops-ratio-value {
                font-family: Georgia, 'Times New Roman', serif;
                font-size: 18pt;
                font-weight: 700;
                text-align: right;
            }

            .ops-ratio-benchmark {
                font-size: 9pt;
                color: #6b7280;
                text-align: right;
            }

            /* ============================================
               WATERFALL CHART SIMULATION (Table-based)
               For Cash Flow visualization
               ============================================ */
            .ops-waterfall-row td {
                padding: 8px 12px;
                vertical-align: middle;
            }

            .ops-waterfall-bar {
                height: 24px;
                min-width: 4px;
                display: inline-block;
                vertical-align: middle;
            }

            .ops-waterfall-bar.positive {
                background-color: #059669;
            }

            .ops-waterfall-bar.negative {
                background-color: #DA291C;
            }

            .ops-waterfall-bar.neutral {
                background-color: #2563eb;
            }

            /* ============================================
               AGING BUCKET COLUMNS
               For Aged Receivables/Payables
               ============================================ */
            .ops-aging-current { background-color: #d1fae5 !important; }
            .ops-aging-30 { background-color: #dbeafe !important; }
            .ops-aging-60 { background-color: #fef3c7 !important; }
            .ops-aging-90 { background-color: #fed7aa !important; }
            .ops-aging-over { background-color: #fee2e2 !important; }

            /* ============================================
               EXECUTIVE DASHBOARD CARD
               For Cover Page / Summary sections
               ============================================ */
            .ops-exec-card {
                background-color: #ffffff;
                border: 1px solid #e5e7eb;
                padding: 20px 24px;
                margin-bottom: 15px;
            }

            .ops-exec-card.highlight {
                border-left: 4px solid #C9A962;
            }

            .ops-exec-card-title {
                font-size: 9pt;
                font-weight: 600;
                color: #6b7280;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                margin-bottom: 8px;
            }

            .ops-exec-card-value {
                font-family: Georgia, 'Times New Roman', serif;
                font-size: 28pt;
                font-weight: 700;
                color: #1A1A1A;
                line-height: 1.1;
            }

            .ops-exec-card-subtitle {
                font-size: 9pt;
                color: #6b7280;
                margin-top: 6px;
            }

            /* ============================================
               SIGNATURE BLOCK
               For approval signatures
               ============================================ */
            .ops-signature-block {
                margin-top: 50px;
                page-break-inside: avoid;
            }

            .ops-signature-table {
                width: 100%;
                border-collapse: collapse;
            }

            .ops-signature-table td {
                padding: 15px 20px;
                text-align: center;
                vertical-align: top;
            }

            .ops-signature-line {
                border-bottom: 1px solid #1A1A1A;
                margin-bottom: 8px;
                min-height: 50px;
            }

            .ops-signature-name {
                font-weight: 600;
                color: #1A1A1A;
                margin-top: 8px;
            }

            .ops-signature-title {
                font-size: 9pt;
                color: #6b7280;
            }

            .ops-signature-date {
                font-size: 9pt;
                color: #6b7280;
                margin-top: 4px;
            }

            /* Print optimization */
            @media print {
                body { background-color: #ffffff; }
                .ops-no-print { display: none !important; }
            }

            /* ============================================
               MERIDIAN STANDARD - TWO-COLUMN BALANCE SHEET
               Equation Layout: Assets = Liabilities + Equity
               wkhtmltopdf-compatible table-based layout
               ============================================ */
            .ops-bs-two-column {
                width: 100%;
                border-collapse: separate;
                border-spacing: 20px 0;
            }

            .ops-bs-two-column > tbody > tr > td {
                width: 48%;
                vertical-align: top;
            }

            .ops-bs-column {
                vertical-align: top;
            }

            /* ============================================
               MERIDIAN EQUATION BLOCK
               Visual equation: Assets = Equity + Liabilities
               ============================================ */
            .ops-equation-block {
                text-align: center;
                padding: 20px 0;
                margin: 20px 0;
                border-top: 1px solid #e5e7eb;
                border-bottom: 1px solid #e5e7eb;
            }

            .ops-equation-block table {
                margin: 0 auto;
                border-collapse: collapse;
            }

            .ops-equation-block td {
                padding: 0 20px;
                vertical-align: middle;
            }

            .ops-equation-item {
                text-align: center;
            }

            .ops-equation-label {
                font-size: 9pt;
                color: #6b7280;
                text-transform: uppercase;
                letter-spacing: 1px;
                margin-bottom: 4px;
            }

            .ops-equation-value {
                font-family: Georgia, 'Times New Roman', serif;
                font-size: 18pt;
                font-weight: 600;
                color: #1A1A1A;
            }

            .ops-equation-operator {
                font-size: 18pt;
                color: #cccccc;
                font-weight: 300;
            }

            .ops-equation-status {
                padding: 8px 16px;
                background-color: #f3f4f6;
                border-radius: 4px;
            }

            .ops-equation-status.balanced {
                background-color: #d1fae5;
            }

            .ops-equation-status.unbalanced {
                background-color: #fee2e2;
            }

            .ops-status-check {
                font-size: 10pt;
                font-weight: 600;
            }

            .ops-status-check.success {
                color: #059669;
            }

            .ops-status-check.error {
                color: #DA291C;
            }

            /* ============================================
               MERIDIAN KPI BAR
               Horizontal metrics strip for executive summary
               ============================================ */
            .ops-kpi-bar {
                width: 100%;
                background-color: #FAFAFA;
                border: 1px solid #e5e7eb;
                padding: 16px;
                margin-bottom: 25px;
            }

            .ops-kpi-bar table {
                width: 100%;
                border-collapse: collapse;
            }

            .ops-kpi-bar td {
                text-align: center;
                padding: 0 16px;
                border-right: 1px solid #e5e7eb;
            }

            .ops-kpi-bar td:last-child {
                border-right: none;
            }

            .ops-kpi-bar-label {
                font-size: 8pt;
                color: #6b7280;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                margin-bottom: 4px;
            }

            .ops-kpi-bar-value {
                font-family: Georgia, 'Times New Roman', serif;
                font-size: 16pt;
                font-weight: 600;
                color: #1A1A1A;
            }

            .ops-kpi-bar-value.revenue { color: #059669; }
            .ops-kpi-bar-value.expense { color: #DA291C; }
            .ops-kpi-bar-value.asset { color: #2563eb; }
            .ops-kpi-bar-value.liability { color: #d97706; }
            .ops-kpi-bar-value.equity { color: #059669; }

            /* ============================================
               MERIDIAN CASH FLOW SECTIONS
               Operating / Investing / Financing layout
               ============================================ */
            .ops-cf-section {
                margin-bottom: 25px;
            }

            .ops-cf-section-header {
                padding: 10px 14px;
                font-weight: 700;
                font-size: 11pt;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                color: #ffffff;
            }

            .ops-cf-section-header.operating {
                background-color: #2563eb !important;
            }

            .ops-cf-section-header.investing {
                background-color: #d97706 !important;
            }

            .ops-cf-section-header.financing {
                background-color: #059669 !important;
            }

            .ops-cf-summary-row td {
                font-weight: 600;
                background-color: #FAFAFA;
                border-top: 1px solid #1A1A1A;
                padding: 10px;
            }

            /* ============================================
               MERIDIAN COMPARISON COLUMNS
               Prior Year / Budget variance display
               ============================================ */
            .ops-col-comparison {
                background-color: #FAFAFA;
            }

            .ops-col-variance {
                font-size: 9pt;
                text-align: right;
                width: 70px;
            }

            .ops-variance-up {
                color: #059669;
            }

            .ops-variance-up:before {
                content: "\25B2 ";
                font-size: 8pt;
            }

            .ops-variance-down {
                color: #DA291C;
            }

            .ops-variance-down:before {
                content: "\25BC ";
                font-size: 8pt;
            }

            .ops-variance-flat {
                color: #6b7280;
            }

            /* ============================================
               MERIDIAN PL STRUCTURE
               Revenue -> COGS -> Gross Profit -> OpEx -> EBIT
               ============================================ */
            .ops-pnl-gross-row td {
                font-weight: 700;
                font-size: 11pt;
                background-color: #FAFAFA;
                border-top: 2px solid #1A1A1A;
                border-bottom: 2px solid #1A1A1A;
                padding: 12px 10px;
            }

            .ops-pnl-ebit-row td {
                font-weight: 700;
                font-size: 11pt;
                background-color: #FAFAFA;
                border-top: 2px solid #1A1A1A;
                border-bottom: 2px solid #1A1A1A;
                padding: 12px 10px;
            }

            .ops-pnl-margin-row td {
                font-size: 9pt;
                font-style: italic;
                color: #6b7280;
                padding-top: 4px;
                padding-bottom: 16px;
                border-bottom: none;
            }

            /* ============================================
               MERIDIAN SIGNATURE BLOCK (Enhanced)
               For Board/Management approval
               ============================================ */
            .ops-signature-grid {
                width: 100%;
                margin-top: 50px;
                page-break-inside: avoid;
            }

            .ops-signature-grid td {
                width: 33%;
                padding: 15px 20px;
                text-align: center;
                vertical-align: top;
            }

            .ops-signature-box {
                border-bottom: 1px solid #1A1A1A;
                min-height: 50px;
                margin-bottom: 8px;
            }

            .ops-signature-role {
                font-size: 9pt;
                font-weight: 600;
                color: #1A1A1A;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }

            .ops-signature-name {
                font-size: 9pt;
                color: #6b7280;
                margin-top: 4px;
            }

            /* ============================================
               MERIDIAN NOTES REFERENCE
               Standard disclosure footer
               ============================================ */
            .ops-notes-reference {
                font-size: 8pt;
                color: #6b7280;
                font-style: italic;
                margin-top: 30px;
                padding-top: 15px;
                border-top: 1px solid #e5e7eb;
            }

            /* ============================================
               MERIDIAN SUBSECTION HEADERS
               For Non-Current/Current Assets etc.
               ============================================ */
            .ops-subsection-title {
                font-size: 10pt;
                font-weight: 600;
                color: #374151;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                padding: 12px 10px 8px 10px;
                background: transparent;
                border-bottom: 1px solid #9ca3af;
            }

            /* ============================================
               MERIDIAN REPORT TITLE BLOCK
               Document type + Title + Meta info
               ============================================ */
            .ops-report-title-block {
                margin-bottom: 25px;
                padding-bottom: 20px;
                border-bottom: 1px solid #e5e7eb;
            }

            .ops-document-type {
                font-size: 9pt;
                color: #6b7280;
                text-transform: uppercase;
                letter-spacing: 2px;
                margin-bottom: 8px;
            }

            .ops-report-main-title {
                font-family: Georgia, 'Times New Roman', serif;
                font-size: 28pt;
                font-weight: 300;
                color: #1A1A1A;
                letter-spacing: -0.5px;
                margin: 0 0 12px 0;
                line-height: 1.1;
            }

            .ops-report-meta-row {
                width: 100%;
            }

            .ops-report-meta-row td {
                vertical-align: bottom;
            }

            .ops-report-period {
                font-size: 10pt;
                font-weight: 500;
                color: #374151;
            }

            .ops-report-currency {
                font-size: 10pt;
                color: #6b7280;
                font-style: italic;
                text-align: right;
            }

            /* Two-column header compatibility */
            .ops-header-split {
                width: 100%;
                padding-bottom: 15px;
                margin-bottom: 0;
            }

            .ops-header-split-table {
                width: 100%;
                border-collapse: collapse;
            }

            .ops-header-left {
                vertical-align: bottom;
                text-align: left;
                width: 50%;
            }

            .ops-header-right {
                vertical-align: bottom;
                text-align: right;
                width: 50%;
            }

            .ops-company-name {
                font-size: 18pt;
                font-weight: 700;
                color: #000000;
                margin: 0;
                line-height: 1.2;
            }

            .ops-department-name {
                font-size: 9pt;
                color: #666666;
                margin-top: 4px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }

            .ops-report-title {
                font-size: 28pt;
                font-weight: 300;
                font-family: Georgia, 'Times New Roman', serif;
                color: #DA291C;
                text-transform: uppercase;
                letter-spacing: 2px;
                margin: 0;
                line-height: 1.1;
            }

            .ops-report-subtitle {
                font-size: 9pt;
                color: #666666;
                margin-top: 4px;
            }
        </style>
    </template>

    <!-- ============================================
         LAYOUT WRAPPERS
         ============================================ -->

    <!-- OPS External Layout - Standard Wrapper -->
    <template id="ops_external_layout">
        <t t-call="ops_matrix_accounting.ops_report_styles"/>
        <t t-call="web.external_layout">
            <div class="ops-report ops-meridian-page">
                <t t-raw="0"/>
            </div>
        </t>
    </template>

    <!-- OPS Minimal Layout - No external header/footer -->
    <template id="ops_minimal_layout">
        <t t-call="ops_matrix_accounting.ops_report_styles"/>
        <div class="ops-report ops-meridian-page">
            <t t-raw="0"/>
        </div>
    </template>

    <!-- OPS Consulting Layout - Full standalone (Meridian) -->
    <template id="ops_consulting_layout">
        <t t-call="ops_matrix_accounting.ops_report_styles"/>
        <div class="ops-meridian-page">
            <t t-raw="0"/>
        </div>
    </template>

    <!-- ============================================
         HELPER TEMPLATES
         ============================================ -->

    <!-- ============================================
         MERIDIAN HEADER TEMPLATE (Table-Based)
         2-Column Layout: Company Left, Report Details Right
         COLORS: Gold #C9A962, Black #1A1A1A
         ============================================ -->
    <template id="ops_meridian_header_template">
        <!-- Gold accent bar - MERIDIAN GOLD #C9A962 -->
        <div style="height: 4px; background-color: #C9A962; margin-bottom: 20px;"></div>

        <!-- 2-Column Header Table -->
        <table width="100%" style="border-collapse: collapse;" class="ops-meridian-header">
            <tr>
                <td width="60%" style="vertical-align: top;" class="left-col">
                    <!-- Report Title - Georgia serif -->
                    <div style="font-size: 32px; font-weight: 300; font-family: Georgia, 'Times New Roman', serif; color: #1A1A1A; margin: 0;">
                        <t t-esc="report_title or 'Financial Statement'"/>
                    </div>
                    <!-- Company Name - Arial/Helvetica -->
                    <div style="font-size: 14px; font-weight: 600; color: #666666; text-transform: uppercase; letter-spacing: 2px; margin-top: 8px; font-family: Arial, Helvetica, sans-serif;">
                        <t t-esc="company_name or 'COMPANY'"/>
                    </div>
                </td>
                <td width="40%" style="text-align: right; vertical-align: top;" class="right-col">
                    <!-- Date Range -->
                    <div style="font-size: 10px; color: #999999; text-transform: uppercase; letter-spacing: 1px; font-family: Arial, Helvetica, sans-serif;">
                        <t t-if="date_from and date_to">
                            <t t-esc="date_from"/> TO <t t-esc="date_to"/>
                        </t>
                        <t t-elif="date_to">AS AT <t t-esc="date_to"/></t>
                        <t t-else="">AS AT CURRENT DATE</t>
                    </div>
                </td>
            </tr>
        </table>

        <!-- Black separator - PRIMARY BLACK #1A1A1A -->
        <div style="height: 2px; background-color: #1A1A1A; margin: 15px 0 20px 0;"></div>
    </template>

    <!-- Two-Column Header Template (Legacy Compatibility) -->
    <template id="ops_header_split_template">
        <div class="ops-header-split">
            <table class="ops-header-split-table">
                <tr>
                    <td class="ops-header-left">
                        <div class="ops-company-name"><t t-esc="company_name or 'Company'"/></div>
                        <div class="ops-department-name"><t t-esc="department or 'Finance Department'"/></div>
                    </td>
                    <td class="ops-header-right">
                        <div class="ops-report-title"><t t-esc="report_title or 'Report'"/></div>
                        <div class="ops-report-subtitle"><t t-esc="report_subtitle or ''"/></div>
                    </td>
                </tr>
            </table>
        </div>
        <hr class="ops-header-separator"/>
    </template>

    <!-- Accounting Equation Bar (Balance Sheet) -->
    <template id="ops_equation_bar_template">
        <div style="text-align: center; padding: 20px; border-bottom: 1px solid #eeeeee; margin-bottom: 25px;">
            <span style="font-size: 20px; font-family: Georgia, serif;">Total Assets</span>
            <span style="color: #cccccc; margin: 0 15px;">=</span>
            <span style="font-size: 20px; font-family: Georgia, serif;">Equity</span>
            <span style="color: #cccccc; margin: 0 15px;">+</span>
            <span style="font-size: 20px; font-family: Georgia, serif;">Liabilities</span>
        </div>
    </template>

    <!-- Meta Info Bar Template -->
    <template id="ops_meta_bar_template">
        <div class="ops-meta-bar">
            <table>
                <tr>
                    <td style="width: 25%;">
                        <span class="ops-meta-label">Period:</span><br/>
                        <span class="ops-meta-value">
                            <t t-if="date_from and date_to">
                                <t t-esc="date_from"/> to <t t-esc="date_to"/>
                            </t>
                            <t t-else="">
                                As of <t t-esc="date_to or 'Current'"/>
                            </t>
                        </span>
                    </td>
                    <td style="width: 25%;">
                        <span class="ops-meta-label">Company:</span><br/>
                        <span class="ops-meta-value"><t t-esc="company_name or 'N/A'"/></span>
                    </td>
                    <td style="width: 25%;">
                        <span class="ops-meta-label">Target Moves:</span><br/>
                        <span class="ops-meta-value"><t t-esc="target_move or 'Posted'"/></span>
                    </td>
                    <td style="width: 25%; text-align: right;">
                        <span class="ops-meta-label">Generated:</span><br/>
                        <span class="ops-meta-value"><t t-esc="generated_date or ''"/></span>
                    </td>
                </tr>
            </table>
        </div>
    </template>

    <!-- Number Formatting Helper -->
    <template id="ops_format_amount">
        <t t-if="value == 0">
            <span class="ops-value-zero">0.00</span>
        </t>
        <t t-elif="value &lt; 0">
            <span class="ops-value-negative">(<t t-esc="'{:,.2f}'.format(abs(value))"/>)</span>
        </t>
        <t t-else="">
            <span class="ops-value-positive"><t t-esc="'{:,.2f}'.format(value)"/></span>
        </t>
    </template>

    <!-- Report Footer Template -->
    <template id="ops_report_footer_template">
        <div class="ops-page-footer">
            <table style="width: 100%;">
                <tr>
                    <td class="ops-footer-text">
                        Prepared by: <t t-esc="prepared_by or 'System'"/> |
                        Generated: <t t-esc="generated_date or ''"/>
                    </td>
                    <td style="text-align: right;">
                        <span class="ops-footer-confidential">Confidential</span>
                    </td>
                </tr>
            </table>
        </div>
    </template>

    <!-- Notes Section Template -->
    <template id="ops_notes_template">
        <div class="ops-notes-section">
            <div class="ops-notes-title">Notes to Financial Statements</div>
            <ul class="ops-notes-list">
                <li>This report was generated by the OPS Matrix Financial Reporting System</li>
                <li>All figures are presented in the company's base currency<t t-if="currency"> (<t t-esc="currency"/>)</t></li>
                <li>Values of zero are displayed as "0.00" for transparency</li>
                <li>Negative values are shown in red with parentheses</li>
                <li>Target Moves: <t t-esc="target_move or 'Posted entries only'"/></li>
            </ul>
        </div>
    </template>

    <!-- Legacy header template (for backwards compatibility) -->
    <template id="ops_report_header_template">
        <div class="ops-header-split">
            <h2 style="margin: 0; font-size: 18pt;"><t t-esc="title"/></h2>
            <p style="margin: 5px 0 0 0; color: #666666;" t-if="subtitle"><t t-esc="subtitle"/></p>
        </div>
    </template>

    <template id="ops_info_box_template">
        <div class="ops-meta-bar">
            <table style="width: 100%;">
                <tr>
                    <td style="width: 50%; vertical-align: top;">
                        <span class="ops-meta-label">Period:</span>
                        <span class="ops-meta-value"><t t-esc="date_from"/> to <t t-esc="date_to"/></span><br/>
                        <span class="ops-meta-label">Company:</span>
                        <span class="ops-meta-value"><t t-esc="company.name if company else '-'"/></span>
                    </td>
                    <td style="width: 50%; vertical-align: top; text-align: right;">
                        <span class="ops-meta-label">Generated:</span>
                        <span class="ops-meta-value"><t t-esc="context_timestamp(datetime.datetime.now()).strftime('%Y-%m-%d %H:%M')"/></span><br/>
                        <t t-if="extra_info">
                            <span class="ops-meta-label" t-esc="extra_info_label"/>:
                            <span class="ops-meta-value" t-esc="extra_info"/>
                        </t>
                    </td>
                </tr>
            </table>
        </div>
    </template>

    <template id="ops_legacy_header" inherit_id="ops_matrix_accounting.ops_report_header_template" primary="True">
    </template>

</odoo>
