<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!--
        OPS Matrix Corporate Report Layout
        ==================================
        v19.3.4.0: PHASE 18 - Hybrid Executive Dashboard Style
        Mixes "Minimalist Data" with "Color-Coded Insights"

        CRITICAL PDF COMPATIBILITY RULES:
        - NO CSS Variables (use literal hex codes)
        - NO Remote Fonts (use system fonts)
        - FORCE Print Colors (-webkit-print-color-adjust: exact !important)
        - Float/inline-block layouts for wkhtmltopdf (no flexbox gaps)

        Phase 18 Color Palette (Hardcoded):
        - Primary Text: #1e293b
        - Secondary Text: #64748b
        - Green (Success/Income): #059669
        - Red (Danger/Expense): #dc2626
        - Blue (Accent/Neutral): #2563eb
        - Border Light: #e2e8f0
        - Background: #ffffff

        Legacy Colors (Preserved):
        - Primary Deep: #0a1628
        - Primary: #1a2744
        - Gold: #b8860b
    -->

    <!-- OPS Matrix Report Styles (PDF-Safe Embedded CSS) -->
    <template id="ops_report_styles">
        <style type="text/css">
            /* ============================================
               PHASE 18: HYBRID EXECUTIVE DASHBOARD v19.3.4.0
               Minimalist Data + Color-Coded Insights
               ============================================ */

            /* Force all colors to print */
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            /* Base Typography - System Fonts Only */
            body, .page {
                font-family: 'DejaVu Sans', Helvetica, Arial, sans-serif;
                font-size: 11px;
                line-height: 1.5;
                color: #1e293b;
                background-color: #ffffff !important;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-report,
            .ops-report-container {
                font-family: 'DejaVu Sans', Helvetica, Arial, sans-serif;
                font-size: 11px;
                line-height: 1.5;
                color: #1e293b;
                background-color: #ffffff !important;
                -webkit-print-color-adjust: exact !important;
            }

            /* ============================================
               PHASE 18: ACCENT CARDS (Float Layout)
               ============================================ */
            .ops-kpi-container {
                width: 100%;
                margin-bottom: 30px;
                overflow: hidden;
            }

            .ops-accent-card {
                width: 30%;
                float: left;
                margin-right: 3%;
                background: #ffffff !important;
                border: 1px solid #e2e8f0;
                border-left-width: 5px;
                padding: 20px;
                -webkit-print-color-adjust: exact !important;
                page-break-inside: avoid;
            }

            .ops-accent-card.success { border-left-color: #059669 !important; }
            .ops-accent-card.danger { border-left-color: #dc2626 !important; }
            .ops-accent-card.neutral { border-left-color: #2563eb !important; }

            .ops-accent-card-label {
                font-size: 10px;
                font-weight: 600;
                color: #64748b;
                text-transform: uppercase;
                letter-spacing: 1px;
            }

            .ops-accent-card-value {
                font-size: 24px;
                font-weight: bold;
                font-family: 'Courier New', monospace;
                margin-top: 5px;
            }

            .ops-text-green { color: #059669 !important; -webkit-print-color-adjust: exact !important; }
            .ops-text-red { color: #dc2626 !important; -webkit-print-color-adjust: exact !important; }
            .ops-text-dark { color: #1e293b !important; }
            .ops-text-muted { color: #64748b !important; }

            /* ============================================
               PHASE 18: ENTERPRISE CLEAN TABLES
               ============================================ */
            table.ops-clean-table {
                width: 100%;
                border-collapse: collapse;
                background: #ffffff;
            }

            table.ops-clean-table th {
                padding: 12px 8px;
                text-align: left;
                font-size: 11px;
                font-weight: 600;
                color: #64748b;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                border-bottom: 2px solid #1e293b !important;
                -webkit-print-color-adjust: exact !important;
            }

            table.ops-clean-table th:last-child { text-align: right; }

            table.ops-clean-table td {
                padding: 10px 8px;
                font-size: 12px;
                color: #1e293b;
                border-bottom: 1px solid #f1f5f9;
            }

            table.ops-clean-table td:last-child {
                text-align: right;
                font-family: 'Courier New', monospace;
            }

            tr.ops-subtotal td {
                border-top: 1px solid #64748b !important;
                font-weight: bold;
                -webkit-print-color-adjust: exact !important;
            }

            tr.ops-total td {
                border-top: 2px solid #1e293b !important;
                border-bottom: 4px double #1e293b !important;
                font-weight: 900;
                font-size: 14px;
                -webkit-print-color-adjust: exact !important;
            }

            /* Section Title Accent Borders */
            .ops-section-title-accent {
                padding: 8px 0;
                margin-bottom: 0;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-section-title-accent.income { border-bottom: 2px solid #059669 !important; }
            .ops-section-title-accent.expense { border-bottom: 2px solid #dc2626 !important; }
            .ops-section-title-accent.assets { border-bottom: 2px solid #2563eb !important; }
            .ops-section-title-accent.liabilities { border-bottom: 2px solid #dc2626 !important; }
            .ops-section-title-accent.equity { border-bottom: 2px solid #059669 !important; }

            /* Status Pills */
            .ops-status-pill {
                display: inline-block;
                padding: 8px 16px;
                border-radius: 4px;
                font-size: 12px;
                font-weight: bold;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-status-pill.healthy { background: #dcfce7 !important; color: #059669 !important; }
            .ops-status-pill.acceptable { background: #f1f5f9 !important; color: #64748b !important; }
            .ops-status-pill.loss { background: #fee2e2 !important; color: #dc2626 !important; }

            /* ============================================
               COVER PAGE - Premium Executive Design
               ============================================ */
            .ops-cover-page {
                min-height: 100%;
                background: #ffffff !important;
                page-break-after: always;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-cover-header-band {
                background: #0a1628 !important;
                padding: 40px 50px;
                position: relative;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-cover-accent-bar {
                height: 6px;
                background: linear-gradient(90deg, #b8860b 0%, #d4a017 30%, #3b82f6 70%, #60a5fa 100%);
                -webkit-print-color-adjust: exact !important;
            }

            .ops-cover-logo-box {
                display: inline-block;
                width: 52px;
                height: 52px;
                background: linear-gradient(135deg, #b8860b 0%, #d4a017 100%);
                border-radius: 10px;
                text-align: center;
                line-height: 52px;
                font-family: Georgia, 'Times New Roman', serif;
                font-size: 26px;
                font-weight: bold;
                color: #ffffff;
                vertical-align: middle;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-cover-company-name {
                display: inline-block;
                vertical-align: middle;
                margin-left: 14px;
            }

            .ops-cover-company-text {
                font-size: 20px;
                font-weight: bold;
                color: #ffffff;
                letter-spacing: -0.5px;
            }

            .ops-cover-tagline {
                font-size: 11px;
                color: rgba(255, 255, 255, 0.6);
                font-weight: 500;
                letter-spacing: 0.5px;
            }

            .ops-cover-fiscal-box {
                background: rgba(255, 255, 255, 0.1);
                border: 1px solid rgba(255, 255, 255, 0.2);
                padding: 10px 18px;
                border-radius: 8px;
                text-align: right;
            }

            .ops-cover-fiscal-label {
                font-size: 10px;
                font-weight: 600;
                color: rgba(255, 255, 255, 0.6);
                text-transform: uppercase;
                letter-spacing: 1px;
            }

            .ops-cover-fiscal-year {
                font-size: 18px;
                font-weight: bold;
                color: #ffffff;
                margin-top: 2px;
            }

            .ops-cover-title-area {
                padding: 60px 50px 40px 50px;
                background: #0a1628 !important;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-cover-doc-type {
                font-size: 11px;
                font-weight: 600;
                color: #d4a017;
                text-transform: uppercase;
                letter-spacing: 3px;
                margin-bottom: 12px;
            }

            .ops-cover-main-title {
                font-family: Georgia, 'Times New Roman', serif;
                font-size: 38px;
                font-weight: bold;
                color: #ffffff;
                line-height: 1.15;
                margin: 0;
            }

            .ops-cover-content {
                padding: 50px;
            }

            .ops-cover-kpi-grid {
                width: 100%;
                border-collapse: separate;
                border-spacing: 16px 0;
                margin-bottom: 30px;
            }

            .ops-cover-kpi-card {
                background: #f8fafc;
                border: 1px solid #e2e8f0;
                border-radius: 10px;
                padding: 24px;
                text-align: center;
                position: relative;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-cover-kpi-card.revenue {
                border-top: 4px solid #3b82f6 !important;
            }

            .ops-cover-kpi-card.profit {
                border-top: 4px solid #059669 !important;
            }

            .ops-cover-kpi-card.expense {
                border-top: 4px solid #dc2626 !important;
            }

            .ops-cover-kpi-card.assets {
                border-top: 4px solid #b8860b !important;
            }

            .ops-cover-kpi-label {
                font-size: 10px;
                font-weight: bold;
                color: #94a3b8;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                margin-bottom: 8px;
            }

            .ops-cover-kpi-value {
                font-size: 26px;
                font-weight: bold;
                color: #0a1628;
                font-family: 'DejaVu Sans Mono', 'Courier New', monospace;
            }

            .ops-cover-kpi-badge {
                font-size: 11px;
                font-weight: bold;
                margin-top: 8px;
            }

            .ops-cover-kpi-badge.positive {
                color: #059669;
            }

            .ops-cover-kpi-badge.negative {
                color: #dc2626;
            }

            .ops-cover-footer-area {
                padding: 30px 50px;
                border-top: 1px solid #e2e8f0;
            }

            .ops-cover-meta-label {
                font-size: 10px;
                font-weight: 600;
                color: #94a3b8;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }

            .ops-cover-meta-value {
                font-size: 13px;
                font-weight: 500;
                color: #1a2744;
            }

            .ops-cover-stamp {
                background: #0a1628 !important;
                color: #ffffff;
                padding: 6px 14px;
                border-radius: 4px;
                font-size: 10px;
                font-weight: 600;
                text-transform: uppercase;
                letter-spacing: 1px;
                -webkit-print-color-adjust: exact !important;
            }

            /* ============================================
               PAGE HEADER
               ============================================ */
            .ops-page-header {
                width: 100%;
                padding-bottom: 12px;
                border-bottom: 3px solid #1a2744;
                margin-bottom: 25px;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-page-header-left {
                vertical-align: middle;
                width: 70%;
            }

            .ops-page-number-box {
                vertical-align: middle;
                text-align: right;
                width: 30%;
            }

            .ops-header-logo {
                display: inline-block;
                width: 36px;
                height: 36px;
                background: linear-gradient(135deg, #b8860b 0%, #d4a017 100%);
                border-radius: 6px;
                text-align: center;
                line-height: 36px;
                font-size: 18px;
                font-weight: bold;
                color: #ffffff;
                vertical-align: middle;
                margin-right: 10px;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-header-info {
                display: inline-block;
                vertical-align: middle;
            }

            .ops-header-company {
                font-size: 14px;
                font-weight: bold;
                color: #1a2744;
            }

            .ops-header-subtitle {
                font-size: 10px;
                color: #94a3b8;
            }

            .ops-page-number {
                font-size: 11px;
                font-weight: 500;
                color: #94a3b8;
            }

            .ops-page-date {
                font-size: 10px;
                color: #94a3b8;
            }

            /* ============================================
               STATEMENT TITLE SECTION
               ============================================ */
            .ops-statement-title-section {
                margin-bottom: 25px;
                text-align: center;
            }

            .ops-statement-title {
                font-family: Georgia, 'Times New Roman', serif;
                font-size: 24px;
                font-weight: bold;
                color: #1a2744;
                margin: 0 0 5px 0;
            }

            .ops-statement-subtitle {
                font-size: 12px;
                color: #475569;
                margin: 0;
            }

            .ops-statement-period {
                display: inline-block;
                margin-top: 10px;
                padding: 5px 15px;
                background: #f8fafc;
                border: 1px solid #e2e8f0;
                border-radius: 15px;
                font-size: 11px;
                font-weight: 500;
                color: #475569;
                -webkit-print-color-adjust: exact !important;
            }

            /* ============================================
               INFO BOX
               ============================================ */
            .ops-info-box {
                background-color: #f8fafc !important;
                padding: 15px 18px;
                border-radius: 5px;
                border-left: 4px solid #b8860b !important;
                margin-bottom: 20px;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-info-label {
                font-weight: bold;
                color: #1a2744;
                display: inline-block;
                min-width: 100px;
            }

            /* ============================================
               KPI HIGHLIGHT CARDS
               ============================================ */
            .ops-highlights {
                width: 100%;
                margin-bottom: 25px;
            }

            .ops-highlight-card {
                background: #f8fafc !important;
                border: 1px solid #e2e8f0;
                border-radius: 8px;
                padding: 18px;
                text-align: center;
                border-top: 3px solid #3b82f6 !important;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-highlight-card.revenue {
                border-top-color: #3b82f6 !important;
            }

            .ops-highlight-card.profit {
                border-top-color: #059669 !important;
            }

            .ops-highlight-card.expense {
                border-top-color: #dc2626 !important;
            }

            .ops-highlight-card.assets {
                border-top-color: #b8860b !important;
            }

            .ops-highlight-card.margin {
                border-top-color: #7c3aed !important;
            }

            .ops-highlight-label {
                font-size: 10px;
                font-weight: bold;
                color: #94a3b8;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                margin-bottom: 6px;
            }

            .ops-highlight-value {
                font-size: 22px;
                font-weight: bold;
                color: #1a2744;
                font-family: 'DejaVu Sans Mono', 'Courier New', monospace;
            }

            .ops-highlight-change {
                font-size: 11px;
                font-weight: bold;
                margin-top: 5px;
            }

            .ops-highlight-change.positive {
                color: #059669 !important;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-highlight-change.negative {
                color: #dc2626 !important;
                -webkit-print-color-adjust: exact !important;
            }

            /* ============================================
               FINANCIAL SECTION WITH GRADIENT HEADER
               ============================================ */
            .ops-financial-section {
                margin-bottom: 20px;
            }

            .ops-section-header-row {
                background: #1a2744 !important;
                padding: 10px 15px;
                border-radius: 6px 6px 0 0;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-section-header-row.assets {
                background: #1e40af !important;
            }

            .ops-section-header-row.liabilities {
                background: #b45309 !important;
            }

            .ops-section-header-row.equity {
                background: #047857 !important;
            }

            .ops-section-header-row.revenue,
            .ops-section-header-row.income {
                background: #1e40af !important;
            }

            .ops-section-header-row.expenses,
            .ops-section-header-row.expense {
                background: #b91c1c !important;
            }

            .ops-section-header-row.operating {
                background: #7c3aed !important;
            }

            .ops-section-header-row.other {
                background: #475569 !important;
            }

            .ops-section-header-row.cost {
                background: #b91c1c !important;
            }

            .ops-section-title-text {
                font-size: 12px;
                font-weight: bold;
                color: #ffffff !important;
                text-transform: uppercase;
                letter-spacing: 1px;
            }

            .ops-section-amount {
                font-family: 'DejaVu Sans Mono', 'Courier New', monospace;
                font-size: 13px;
                font-weight: bold;
                color: #ffffff !important;
                text-align: right;
            }

            /* ============================================
               FINANCIAL TABLE - Premium Styling
               ============================================ */
            .ops-financial-table {
                width: 100%;
                border-collapse: collapse;
                background: #ffffff;
                border: 1px solid #e2e8f0;
                border-top: none;
            }

            .ops-financial-table thead th {
                padding: 10px 15px;
                text-align: left;
                font-size: 9px;
                font-weight: bold;
                color: #94a3b8;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                background: #f8fafc !important;
                border-bottom: 1px solid #e2e8f0;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-financial-table thead th:last-child,
            .ops-financial-table thead th.text-end {
                text-align: right;
            }

            .ops-financial-table tbody td {
                padding: 10px 15px;
                font-size: 11px;
                color: #1a2744;
                border-bottom: 1px dotted #cbd5e1;
            }

            .ops-financial-table tbody tr:last-child td {
                border-bottom: none;
            }

            .ops-financial-table tbody td:last-child,
            .ops-financial-table tbody td.text-end {
                text-align: right;
                font-family: 'DejaVu Sans Mono', 'Courier New', monospace;
                font-size: 10px;
            }

            /* Indentation */
            .ops-financial-table .indent-1,
            .ops-financial-table .ops-indent-1 {
                padding-left: 30px;
            }

            .ops-financial-table .indent-2,
            .ops-financial-table .ops-indent-2 {
                padding-left: 45px;
                font-size: 10px;
                color: #475569;
            }

            .ops-financial-table .indent-3,
            .ops-financial-table .ops-indent-3 {
                padding-left: 60px;
                font-size: 9px;
                color: #94a3b8;
            }

            /* Group Row */
            .ops-financial-table .group-row td {
                font-weight: bold;
                background: #f8fafc !important;
                border-bottom: 1px solid #e2e8f0;
                -webkit-print-color-adjust: exact !important;
            }

            /* Subtotal Row */
            .ops-financial-table .subtotal-row td {
                background: #f8fafc !important;
                font-weight: bold;
                border-bottom: 2px solid #cbd5e1;
                padding-top: 12px;
                padding-bottom: 12px;
                -webkit-print-color-adjust: exact !important;
            }

            /* Total Row */
            .ops-financial-table .total-row td {
                background: #1a2744 !important;
                color: #ffffff !important;
                font-weight: bold;
                padding-top: 12px;
                padding-bottom: 12px;
                border-bottom: none;
                -webkit-print-color-adjust: exact !important;
            }

            /* Grand Total Row - Dark Premium Style */
            .ops-financial-table .grand-total-row td {
                background: #0a1628 !important;
                color: #ffffff !important;
                font-weight: bold;
                font-size: 12px;
                padding-top: 14px;
                padding-bottom: 14px;
                border-bottom: none;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-financial-table .grand-total-row td:last-child {
                font-size: 13px;
            }

            /* Amount Colors */
            .amount-positive,
            .ops-amount-positive,
            .ops-number-positive {
                color: #059669 !important;
                -webkit-print-color-adjust: exact !important;
            }

            .amount-negative,
            .ops-amount-negative,
            .ops-number-negative {
                color: #dc2626 !important;
                -webkit-print-color-adjust: exact !important;
            }

            /* ============================================
               TOTALS SUMMARY BOX - Executive Dark Theme
               ============================================ */
            .ops-totals-summary {
                margin-top: 25px;
                background: #0a1628 !important;
                border-radius: 8px;
                padding: 20px 25px;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-totals-summary.success,
            .ops-totals-summary.profit {
                background: #047857 !important;
            }

            .ops-totals-summary.loss {
                background: #991b1b !important;
            }

            .ops-totals-left {
                vertical-align: middle;
            }

            .ops-totals-label {
                font-size: 10px;
                font-weight: bold;
                color: rgba(255, 255, 255, 0.6);
                text-transform: uppercase;
                letter-spacing: 1px;
            }

            .ops-totals-equation {
                font-size: 12px;
                color: rgba(255, 255, 255, 0.8);
                margin-top: 3px;
            }

            .ops-totals-value {
                font-family: 'DejaVu Sans Mono', 'Courier New', monospace;
                font-size: 26px;
                font-weight: bold;
                color: #ffffff !important;
                text-align: center;
                vertical-align: middle;
            }

            .ops-totals-badge {
                background: rgba(255, 255, 255, 0.1);
                border: 1px solid rgba(255, 255, 255, 0.2);
                padding: 8px 14px;
                border-radius: 6px;
                text-align: center;
                vertical-align: middle;
            }

            .ops-badge-icon {
                display: inline-block;
                width: 20px;
                height: 20px;
                background: #059669 !important;
                border-radius: 50%;
                text-align: center;
                line-height: 20px;
                color: #ffffff;
                font-size: 12px;
                font-weight: bold;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-badge-icon.warning {
                background: #b8860b !important;
            }

            .ops-badge-icon.danger {
                background: #dc2626 !important;
            }

            .ops-badge-text {
                font-size: 11px;
                font-weight: bold;
                color: #ffffff;
                margin-top: 4px;
            }

            /* ============================================
               ALERT BOXES
               ============================================ */
            .ops-alert {
                padding: 12px 15px;
                border-radius: 5px;
                margin: 15px 0;
                border-left: 4px solid;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-alert-success {
                background-color: rgba(5, 150, 105, 0.1) !important;
                border-color: #059669 !important;
                color: #065f46;
            }

            .ops-alert-warning {
                background-color: rgba(217, 119, 6, 0.1) !important;
                border-color: #b8860b !important;
                color: #92400e;
            }

            .ops-alert-danger {
                background-color: rgba(220, 38, 38, 0.1) !important;
                border-color: #dc2626 !important;
                color: #991b1b;
            }

            .ops-alert-info {
                background-color: rgba(59, 130, 246, 0.1) !important;
                border-color: #3b82f6 !important;
                color: #1e40af;
            }

            /* ============================================
               NOTES SECTION
               ============================================ */
            .ops-notes-section {
                margin-top: 25px;
                padding: 15px 20px;
                background: #f8fafc !important;
                border: 1px solid #e2e8f0;
                border-left: 4px solid #3b82f6 !important;
                border-radius: 0 6px 6px 0;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-notes-title {
                font-size: 10px;
                font-weight: bold;
                color: #94a3b8;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                margin-bottom: 8px;
            }

            .ops-notes-list {
                list-style: none;
                margin: 0;
                padding: 0;
            }

            .ops-notes-list li {
                font-size: 10px;
                color: #475569;
                padding: 3px 0 3px 15px;
                position: relative;
            }

            .ops-notes-list li:before {
                content: "\2022";
                position: absolute;
                left: 0;
                color: #3b82f6;
                font-weight: bold;
            }

            /* ============================================
               PAGE FOOTER
               ============================================ */
            .ops-page-footer {
                margin-top: 30px;
                padding-top: 12px;
                border-top: 1px solid #e2e8f0;
            }

            .ops-footer-text {
                font-size: 9px;
                color: #94a3b8;
            }

            .ops-footer-confidential {
                font-size: 8px;
                font-weight: bold;
                color: #94a3b8;
                text-transform: uppercase;
                letter-spacing: 1px;
                padding: 3px 8px;
                background: #f8fafc !important;
                border: 1px solid #e2e8f0;
                border-radius: 3px;
                text-align: right;
                -webkit-print-color-adjust: exact !important;
            }

            /* ============================================
               PERFORMANCE THRESHOLDS BOX
               ============================================ */
            .ops-performance-thresholds {
                margin-top: 20px;
                padding: 12px;
                background-color: #f8fafc !important;
                border-radius: 5px;
                border: 1px solid #e2e8f0;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-performance-thresholds p {
                margin: 0;
                font-size: 10px;
                color: #475569;
            }

            .threshold-excellent,
            .threshold-good {
                color: #059669 !important;
                font-weight: bold;
                -webkit-print-color-adjust: exact !important;
            }

            .threshold-acceptable {
                color: #b8860b !important;
                font-weight: bold;
                -webkit-print-color-adjust: exact !important;
            }

            .threshold-below {
                color: #dc2626 !important;
                font-weight: bold;
                -webkit-print-color-adjust: exact !important;
            }

            /* ============================================
               LEGACY STYLES (Backward Compatibility)
               ============================================ */
            .ops_table_matrix {
                width: 100%;
                border-collapse: collapse;
                margin-bottom: 15px;
                font-size: 10px;
            }

            .ops_table_matrix thead tr {
                background-color: #1a2744 !important;
                color: #ffffff;
                -webkit-print-color-adjust: exact !important;
            }

            .ops_table_matrix th {
                padding: 10px 8px;
                font-weight: bold;
                text-align: left;
                border: 1px solid #0a1628;
                background-color: #1a2744 !important;
                color: #ffffff !important;
                -webkit-print-color-adjust: exact !important;
            }

            .ops_table_matrix td {
                padding: 8px;
                border: 1px solid #e2e8f0;
            }

            .ops_table_matrix tbody tr:nth-child(even) {
                background-color: #f8fafc !important;
                -webkit-print-color-adjust: exact !important;
            }

            .ops_table_matrix .text-end {
                text-align: right !important;
            }

            .ops_table_matrix .text-center {
                text-align: center !important;
            }

            .ops-total-row {
                background-color: #f1f5f9 !important;
                font-weight: bold;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-grand-total {
                background: #0a1628 !important;
                color: #ffffff !important;
                font-weight: bold;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-grand-total td {
                color: #ffffff !important;
            }

            .ops-report-header {
                text-align: center;
                padding: 20px;
                background: #1a2744 !important;
                color: #ffffff;
                border-radius: 8px 8px 0 0;
                margin-bottom: 20px;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-report-header h2 {
                margin: 0;
                font-size: 18px;
                font-weight: bold;
                color: #ffffff;
            }

            .ops-subtitle {
                font-size: 12px;
                color: rgba(255, 255, 255, 0.8);
                margin-top: 5px;
            }

            .ops-report-footer {
                margin-top: 25px;
                padding: 12px;
                background-color: #f8fafc !important;
                border-radius: 5px;
                border-top: 2px solid #1a2744;
                font-size: 10px;
                color: #94a3b8;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-footer-note {
                margin: 0;
                line-height: 1.5;
            }

            /* Badges */
            .ops-badge {
                display: inline-block;
                padding: 2px 8px;
                border-radius: 3px;
                font-size: 9px;
                font-weight: bold;
                text-transform: uppercase;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-badge-success {
                background: #059669 !important;
                color: #ffffff;
            }

            .ops-badge-warning {
                background: #b8860b !important;
                color: #ffffff;
            }

            .ops-badge-danger {
                background: #dc2626 !important;
                color: #ffffff;
            }

            .ops-badge-info {
                background: #3b82f6 !important;
                color: #ffffff;
            }

            .ops-badge-muted {
                background: #94a3b8 !important;
                color: #ffffff;
            }

            .ops-badge-primary {
                background: #1a2744 !important;
                color: #ffffff;
            }

            /* Legend */
            .ops-legend {
                margin-bottom: 12px;
                font-size: 10px;
            }

            /* Numbers */
            .ops-number {
                font-family: 'DejaVu Sans Mono', 'Courier New', monospace;
                text-align: right;
            }

            .ops-debit {
                color: #059669 !important;
            }

            .ops-credit {
                color: #dc2626 !important;
            }

            /* Section Headers */
            .ops-section-header {
                background-color: #1a2744 !important;
                color: #ffffff;
                padding: 10px 12px;
                border-radius: 4px 4px 0 0;
                font-weight: bold;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-section-header-revenue {
                background-color: #1e40af !important;
            }

            .ops-section-header-expense {
                background-color: #b91c1c !important;
            }

            .ops-section-header-asset {
                background-color: #1e40af !important;
            }

            .ops-section-header-liability {
                background-color: #b45309 !important;
            }

            /* Signature Section */
            .ops-signature-section {
                margin-top: 30px;
                page-break-inside: avoid;
            }

            .ops-signature-box {
                border-top: 1px solid #1a2744;
                padding-top: 5px;
                margin-top: 40px;
                text-align: center;
                font-size: 10px;
            }

            /* Utility Classes */
            .text-end {
                text-align: right !important;
            }

            .text-center {
                text-align: center !important;
            }

            .font-weight-bold,
            strong {
                font-weight: bold;
            }

            /* Row/Column helpers using tables */
            .row {
                display: table;
                width: 100%;
            }

            .row:after {
                content: "";
                display: table;
                clear: both;
            }

            .col-6 {
                display: table-cell;
                width: 50%;
                vertical-align: top;
            }

            .col-3 {
                display: table-cell;
                width: 25%;
                vertical-align: top;
            }

            .col-4 {
                display: table-cell;
                width: 33.33%;
                vertical-align: top;
            }

            .col-12 {
                display: block;
                width: 100%;
            }

            /* Print Styles - Force Color Printing */
            @media print {
                .ops-no-print {
                    display: none !important;
                }

                body {
                    -webkit-print-color-adjust: exact !important;
                    print-color-adjust: exact !important;
                }

                * {
                    -webkit-print-color-adjust: exact !important;
                    print-color-adjust: exact !important;
                }
            }
        </style>
    </template>

    <!-- OPS External Layout - Wrapper for all Matrix Reports -->
    <template id="ops_external_layout">
        <t t-call="ops_matrix_accounting.ops_report_styles"/>
        <t t-call="web.external_layout">
            <div class="ops-report">
                <t t-raw="0"/>
            </div>
        </t>
    </template>

    <!-- OPS Minimal Layout - For reports that don't need full external layout -->
    <template id="ops_minimal_layout">
        <t t-call="ops_matrix_accounting.ops_report_styles"/>
        <div class="ops-report">
            <t t-raw="0"/>
        </div>
    </template>

    <!-- Helper template for standard report header -->
    <template id="ops_report_header_template">
        <div class="ops-report-header">
            <h2><t t-esc="title"/></h2>
            <p class="ops-subtitle" t-if="subtitle"><t t-esc="subtitle"/></p>
        </div>
    </template>

    <!-- Helper template for info box -->
    <template id="ops_info_box_template">
        <div class="ops-info-box">
            <table style="width: 100%;">
                <tr>
                    <td style="width: 50%; vertical-align: top;">
                        <span class="ops-info-label">Period:</span>
                        <span t-esc="date_from"/> to <span t-esc="date_to"/><br/>
                        <span class="ops-info-label">Company:</span>
                        <span t-esc="company.name if company else '-'"/>
                    </td>
                    <td style="width: 50%; vertical-align: top; text-align: right;">
                        <span class="ops-info-label">Generated:</span>
                        <span t-esc="context_timestamp(datetime.datetime.now()).strftime('%Y-%m-%d %H:%M')"/><br/>
                        <t t-if="extra_info">
                            <span class="ops-info-label" t-esc="extra_info_label"/>:
                            <span t-esc="extra_info"/>
                        </t>
                    </td>
                </tr>
            </table>
        </div>
    </template>

    <!-- Helper template for report footer -->
    <template id="ops_report_footer_template">
        <div class="ops-report-footer">
            <p class="ops-footer-note">
                <strong>Audit Trail:</strong>
                <t t-if="footer_text" t-esc="footer_text"/>
                <t t-else="">All data shown above is sourced from posted journal entries in the accounting system.</t>
            </p>
            <table style="width: 100%; margin-top: 8px;">
                <tr>
                    <td style="width: 50%; font-size: 9px; color: #94a3b8;">
                        Page <span class="page"/> of <span class="topage"/>
                    </td>
                    <td style="width: 50%; text-align: right; font-size: 9px; color: #94a3b8; font-style: italic;">
                        Generated by OPS Matrix
                    </td>
                </tr>
            </table>
        </div>
    </template>

    <!-- Number formatting helper -->
    <template id="ops_format_number">
        <t t-set="num_class" t-value="'ops-number-positive' if value > 0 else 'ops-number-negative' if value &lt; 0 else ''"/>
        <span t-attf-class="ops-number #{num_class}">
            <t t-esc="'{:,.2f}'.format(value)"/>
        </span>
    </template>

    <!-- Legacy header template -->
    <template id="ops_legacy_header" inherit_id="ops_matrix_accounting.ops_report_header_template" primary="True">
    </template>

</odoo>
