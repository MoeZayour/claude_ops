<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!--
        OPS Matrix Corporate Report Layout
        ==================================
        v19.4.0: PREMIUM EXECUTIVE SUITE with Dynamic Company Colors

        This layout creates professional financial reports that:
        - Derive colors from company's primary_color and secondary_color
        - Use smart color coding (green=good, red=bad, muted=zero)
        - Follow executive dashboard styling patterns
        - Are fully PDF-safe with wkhtmltopdf compatibility

        CRITICAL PDF COMPATIBILITY RULES:
        - NO CSS Variables (use literal hex codes passed from Python)
        - NO Remote Fonts (use system fonts only)
        - FORCE Print Colors (-webkit-print-color-adjust: exact !important)
        - Float/inline-block layouts (no flexbox gaps)

        COLOR STRATEGY:
        - Company Primary: Headers, titles, section accents
        - Company Secondary: Highlights, badges
        - Success (#059669): Positive values, profits, revenue
        - Danger (#dc2626): Negative values, losses, expenses
        - Muted (#94a3b8): Zero values, secondary text
    -->

    <!-- OPS Matrix Report Styles (PDF-Safe Embedded CSS) -->
    <template id="ops_report_styles">
        <style type="text/css">
            /* ============================================
               OPS PREMIUM EXECUTIVE SUITE v19.4.0
               Dynamic Company Colors + Smart Value Coloring
               ============================================ */

            /* Force all colors to print */
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            /* Base Typography - System Fonts Only */
            body, .page {
                font-family: 'DejaVu Sans', Helvetica, Arial, sans-serif;
                font-size: 10pt;
                line-height: 1.5;
                color: #1e293b;
                background-color: #ffffff !important;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-report,
            .ops-report-container {
                font-family: 'DejaVu Sans', Helvetica, Arial, sans-serif;
                font-size: 10pt;
                line-height: 1.5;
                color: #1e293b;
                background-color: #ffffff !important;
                -webkit-print-color-adjust: exact !important;
            }

            /* ============================================
               TYPOGRAPHY SYSTEM
               ============================================ */
            .ops-title-serif {
                font-family: Georgia, 'Times New Roman', serif;
            }

            .ops-mono {
                font-family: 'DejaVu Sans Mono', 'Courier New', monospace;
            }

            .ops-uppercase {
                text-transform: uppercase;
                letter-spacing: 1px;
            }

            .ops-small-caps {
                font-variant: small-caps;
                letter-spacing: 0.5px;
            }

            /* ============================================
               VALUE COLORING SYSTEM
               Smart colors for financial values
               ============================================ */
            .ops-value-positive {
                color: #059669 !important;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-value-negative {
                color: #dc2626 !important;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-value-zero {
                color: #94a3b8 !important;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-value-neutral {
                color: #1e293b !important;
            }

            /* Revenue/Income - Always positive context */
            .ops-value-revenue {
                color: #059669 !important;
                -webkit-print-color-adjust: exact !important;
            }

            /* Expense/Cost - Always negative context */
            .ops-value-expense {
                color: #dc2626 !important;
                -webkit-print-color-adjust: exact !important;
            }

            /* Asset context */
            .ops-value-asset {
                color: #2563eb !important;
                -webkit-print-color-adjust: exact !important;
            }

            /* ============================================
               PREMIUM COVER PAGE
               ============================================ */
            .ops-cover-page {
                min-height: 100%;
                background: #ffffff !important;
                page-break-after: always;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-cover-header-band {
                padding: 35px 45px;
                position: relative;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-cover-accent-bar {
                height: 5px;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-cover-logo-box {
                display: inline-block;
                width: 48px;
                height: 48px;
                border-radius: 8px;
                text-align: center;
                line-height: 48px;
                font-family: Georgia, serif;
                font-size: 24px;
                font-weight: bold;
                color: #ffffff;
                vertical-align: middle;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-cover-company-name {
                display: inline-block;
                vertical-align: middle;
                margin-left: 12px;
            }

            .ops-cover-company-text {
                font-size: 18px;
                font-weight: bold;
                color: #ffffff;
                letter-spacing: -0.3px;
            }

            .ops-cover-tagline {
                font-size: 10px;
                color: rgba(255, 255, 255, 0.6);
                font-weight: 500;
                letter-spacing: 0.5px;
            }

            .ops-cover-fiscal-box {
                background: rgba(255, 255, 255, 0.1);
                border: 1px solid rgba(255, 255, 255, 0.2);
                padding: 8px 16px;
                border-radius: 6px;
                text-align: right;
            }

            .ops-cover-fiscal-label {
                font-size: 9px;
                font-weight: 600;
                color: rgba(255, 255, 255, 0.6);
                text-transform: uppercase;
                letter-spacing: 1px;
            }

            .ops-cover-fiscal-year {
                font-size: 16px;
                font-weight: bold;
                color: #ffffff;
                margin-top: 2px;
            }

            .ops-cover-title-area {
                padding: 50px 45px 35px 45px;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-cover-doc-type {
                font-size: 10px;
                font-weight: 600;
                text-transform: uppercase;
                letter-spacing: 2px;
                margin-bottom: 10px;
            }

            .ops-cover-main-title {
                font-family: Georgia, 'Times New Roman', serif;
                font-size: 32px;
                font-weight: bold;
                color: #ffffff;
                line-height: 1.2;
                margin: 0;
            }

            .ops-cover-subtitle {
                font-size: 13px;
                color: rgba(255, 255, 255, 0.75);
                margin-top: 10px;
            }

            .ops-cover-content {
                padding: 40px 45px;
            }

            /* ============================================
               KPI ACCENT CARDS (Premium Executive Style)
               ============================================ */
            .ops-kpi-container {
                width: 100%;
                margin-bottom: 25px;
                overflow: hidden;
            }

            .ops-kpi-card {
                background: #ffffff !important;
                border: 1px solid #e2e8f0;
                border-left-width: 4px;
                padding: 18px;
                -webkit-print-color-adjust: exact !important;
                page-break-inside: avoid;
            }

            .ops-kpi-card.success { border-left-color: #059669 !important; }
            .ops-kpi-card.danger { border-left-color: #dc2626 !important; }
            .ops-kpi-card.neutral { border-left-color: #2563eb !important; }
            .ops-kpi-card.warning { border-left-color: #d97706 !important; }

            .ops-kpi-label {
                font-size: 9px;
                font-weight: 600;
                color: #64748b;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }

            .ops-kpi-value {
                font-size: 22px;
                font-weight: bold;
                font-family: 'DejaVu Sans Mono', 'Courier New', monospace;
                margin-top: 4px;
            }

            .ops-kpi-change {
                font-size: 10px;
                font-weight: 600;
                margin-top: 4px;
            }

            .ops-kpi-change.positive { color: #059669 !important; }
            .ops-kpi-change.negative { color: #dc2626 !important; }

            /* ============================================
               PAGE HEADER
               ============================================ */
            .ops-page-header {
                width: 100%;
                padding-bottom: 10px;
                border-bottom: 2px solid;
                margin-bottom: 20px;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-page-header-left {
                vertical-align: middle;
                width: 65%;
            }

            .ops-page-number-box {
                vertical-align: middle;
                text-align: right;
                width: 35%;
            }

            .ops-header-logo {
                display: inline-block;
                width: 32px;
                height: 32px;
                border-radius: 5px;
                text-align: center;
                line-height: 32px;
                font-size: 16px;
                font-weight: bold;
                color: #ffffff;
                vertical-align: middle;
                margin-right: 10px;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-header-info {
                display: inline-block;
                vertical-align: middle;
            }

            .ops-header-company {
                font-size: 13px;
                font-weight: bold;
            }

            .ops-header-subtitle {
                font-size: 9px;
                color: #94a3b8;
            }

            .ops-page-number {
                font-size: 10px;
                font-weight: 500;
                color: #94a3b8;
            }

            .ops-page-date {
                font-size: 9px;
                color: #94a3b8;
            }

            /* ============================================
               STATEMENT TITLE SECTION
               ============================================ */
            .ops-statement-title-section {
                margin-bottom: 20px;
                text-align: center;
            }

            .ops-statement-title {
                font-family: Georgia, 'Times New Roman', serif;
                font-size: 22px;
                font-weight: bold;
                margin: 0 0 4px 0;
            }

            .ops-statement-subtitle {
                font-size: 11px;
                color: #64748b;
                margin: 0;
            }

            .ops-statement-period {
                display: inline-block;
                margin-top: 8px;
                padding: 4px 14px;
                background: #f8fafc;
                border: 1px solid #e2e8f0;
                border-radius: 12px;
                font-size: 10px;
                font-weight: 500;
                color: #64748b;
                -webkit-print-color-adjust: exact !important;
            }

            /* ============================================
               PREMIUM DATA TABLES
               ============================================ */
            table.ops-data-table {
                width: 100%;
                border-collapse: collapse;
                background: #ffffff;
                font-size: 10pt;
            }

            table.ops-data-table thead th {
                padding: 10px 8px;
                text-align: left;
                font-size: 9pt;
                font-weight: 600;
                color: #64748b;
                text-transform: uppercase;
                letter-spacing: 0.3px;
                border-bottom: 2px solid #1e293b !important;
                -webkit-print-color-adjust: exact !important;
            }

            table.ops-data-table thead th.text-end {
                text-align: right;
            }

            table.ops-data-table tbody td {
                padding: 8px;
                font-size: 10pt;
                color: #1e293b;
                border-bottom: 1px solid #f1f5f9;
            }

            table.ops-data-table tbody td.text-end {
                text-align: right;
                font-family: 'DejaVu Sans Mono', 'Courier New', monospace;
                font-size: 9pt;
            }

            table.ops-data-table tbody td.label-col {
                font-weight: 500;
            }

            /* Indentation levels */
            table.ops-data-table .indent-1 { padding-left: 20px !important; }
            table.ops-data-table .indent-2 { padding-left: 35px !important; font-size: 9pt; color: #64748b; }
            table.ops-data-table .indent-3 { padding-left: 50px !important; font-size: 8pt; color: #94a3b8; }

            /* Subtotal row */
            table.ops-data-table tr.subtotal-row td {
                border-top: 1px solid #94a3b8 !important;
                font-weight: 600;
                background: #fafafa !important;
                -webkit-print-color-adjust: exact !important;
            }

            /* Total row */
            table.ops-data-table tr.total-row td {
                border-top: 2px solid #1e293b !important;
                border-bottom: 3px double #1e293b !important;
                font-weight: 700;
                font-size: 11pt;
                -webkit-print-color-adjust: exact !important;
            }

            /* Grand total row - dark background */
            table.ops-data-table tr.grand-total-row td {
                color: #ffffff !important;
                font-weight: 700;
                font-size: 11pt;
                padding: 12px 8px;
                border-bottom: none;
                -webkit-print-color-adjust: exact !important;
            }

            /* Section header row */
            table.ops-data-table tr.section-header td {
                font-weight: 700;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                font-size: 10pt;
                padding-top: 14px;
                border-bottom: 2px solid;
                -webkit-print-color-adjust: exact !important;
            }

            table.ops-data-table tr.section-header.revenue td { border-bottom-color: #059669 !important; color: #059669 !important; }
            table.ops-data-table tr.section-header.expense td { border-bottom-color: #dc2626 !important; color: #dc2626 !important; }
            table.ops-data-table tr.section-header.asset td { border-bottom-color: #2563eb !important; color: #2563eb !important; }
            table.ops-data-table tr.section-header.liability td { border-bottom-color: #d97706 !important; color: #d97706 !important; }
            table.ops-data-table tr.section-header.equity td { border-bottom-color: #059669 !important; color: #059669 !important; }

            /* ============================================
               SECTION BLOCKS WITH COLORED HEADERS
               ============================================ */
            .ops-section-block {
                margin-bottom: 20px;
            }

            .ops-section-header-bar {
                padding: 10px 14px;
                border-radius: 4px 4px 0 0;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-section-header-bar table {
                width: 100%;
            }

            .ops-section-title-text {
                font-size: 11pt;
                font-weight: 700;
                color: #ffffff !important;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }

            .ops-section-amount {
                font-family: 'DejaVu Sans Mono', 'Courier New', monospace;
                font-size: 12pt;
                font-weight: 700;
                color: #ffffff !important;
                text-align: right;
            }

            .ops-section-table {
                width: 100%;
                border-collapse: collapse;
                background: #ffffff;
                border: 1px solid #e2e8f0;
                border-top: none;
            }

            .ops-section-table th {
                padding: 8px 14px;
                text-align: left;
                font-size: 8pt;
                font-weight: 600;
                color: #94a3b8;
                text-transform: uppercase;
                letter-spacing: 0.3px;
                background: #f8fafc !important;
                border-bottom: 1px solid #e2e8f0;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-section-table th.text-end { text-align: right; }

            .ops-section-table td {
                padding: 8px 14px;
                font-size: 10pt;
                color: #1e293b;
                border-bottom: 1px dotted #e2e8f0;
            }

            .ops-section-table td.text-end {
                text-align: right;
                font-family: 'DejaVu Sans Mono', 'Courier New', monospace;
                font-size: 9pt;
            }

            .ops-section-table tr:last-child td {
                border-bottom: none;
            }

            .ops-section-table .subtotal td {
                background: #f8fafc !important;
                font-weight: 600;
                border-top: 1px solid #cbd5e1;
                padding-top: 10px;
                padding-bottom: 10px;
                -webkit-print-color-adjust: exact !important;
            }

            /* ============================================
               SUMMARY BOX (Total/Result)
               ============================================ */
            .ops-summary-box {
                margin-top: 20px;
                border-radius: 6px;
                padding: 18px 22px;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-summary-box.success { background: #047857 !important; }
            .ops-summary-box.loss { background: #991b1b !important; }
            .ops-summary-box.neutral { background: #0a1628 !important; }

            .ops-summary-label {
                font-size: 9pt;
                font-weight: 600;
                color: rgba(255, 255, 255, 0.65);
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }

            .ops-summary-equation {
                font-size: 10pt;
                color: rgba(255, 255, 255, 0.8);
                margin-top: 2px;
            }

            .ops-summary-value {
                font-family: 'DejaVu Sans Mono', 'Courier New', monospace;
                font-size: 24pt;
                font-weight: 700;
                color: #ffffff !important;
                text-align: center;
                vertical-align: middle;
            }

            .ops-summary-badge {
                background: rgba(255, 255, 255, 0.12);
                border: 1px solid rgba(255, 255, 255, 0.2);
                padding: 8px 14px;
                border-radius: 5px;
                text-align: center;
                vertical-align: middle;
            }

            .ops-summary-badge-icon {
                display: inline-block;
                width: 18px;
                height: 18px;
                border-radius: 50%;
                text-align: center;
                line-height: 18px;
                color: #ffffff;
                font-size: 11px;
                font-weight: bold;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-summary-badge-icon.success { background: #059669 !important; }
            .ops-summary-badge-icon.warning { background: #d97706 !important; }
            .ops-summary-badge-icon.danger { background: #dc2626 !important; }

            .ops-summary-badge-text {
                font-size: 10pt;
                font-weight: 600;
                color: #ffffff;
                margin-top: 3px;
            }

            /* ============================================
               STATUS PILLS AND BADGES
               ============================================ */
            .ops-status-pill {
                display: inline-block;
                padding: 6px 14px;
                border-radius: 4px;
                font-size: 10pt;
                font-weight: 600;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-status-pill.excellent { background: #dcfce7 !important; color: #059669 !important; }
            .ops-status-pill.healthy { background: #dbeafe !important; color: #2563eb !important; }
            .ops-status-pill.acceptable { background: #f1f5f9 !important; color: #64748b !important; }
            .ops-status-pill.warning { background: #fef3c7 !important; color: #d97706 !important; }
            .ops-status-pill.loss { background: #fee2e2 !important; color: #dc2626 !important; }

            .ops-badge {
                display: inline-block;
                padding: 2px 8px;
                border-radius: 3px;
                font-size: 8pt;
                font-weight: 600;
                text-transform: uppercase;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-badge.success { background: #059669 !important; color: #ffffff; }
            .ops-badge.warning { background: #d97706 !important; color: #ffffff; }
            .ops-badge.danger { background: #dc2626 !important; color: #ffffff; }
            .ops-badge.info { background: #2563eb !important; color: #ffffff; }
            .ops-badge.muted { background: #94a3b8 !important; color: #ffffff; }

            /* ============================================
               PERFORMANCE ALERT BANNERS
               ============================================ */
            .ops-alert {
                padding: 12px 14px;
                border-radius: 4px;
                margin: 14px 0;
                border-left: 4px solid;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-alert.success {
                background-color: rgba(5, 150, 105, 0.1) !important;
                border-color: #059669 !important;
                color: #065f46;
            }

            .ops-alert.warning {
                background-color: rgba(217, 119, 6, 0.1) !important;
                border-color: #d97706 !important;
                color: #92400e;
            }

            .ops-alert.danger {
                background-color: rgba(220, 38, 38, 0.1) !important;
                border-color: #dc2626 !important;
                color: #991b1b;
            }

            .ops-alert.info {
                background-color: rgba(37, 99, 235, 0.1) !important;
                border-color: #2563eb !important;
                color: #1e40af;
            }

            /* ============================================
               NOTES SECTION
               ============================================ */
            .ops-notes-section {
                margin-top: 20px;
                padding: 14px 18px;
                background: #f8fafc !important;
                border: 1px solid #e2e8f0;
                border-left: 4px solid #2563eb !important;
                border-radius: 0 5px 5px 0;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-notes-title {
                font-size: 9pt;
                font-weight: 600;
                color: #94a3b8;
                text-transform: uppercase;
                letter-spacing: 0.3px;
                margin-bottom: 6px;
            }

            .ops-notes-list {
                list-style: none;
                margin: 0;
                padding: 0;
            }

            .ops-notes-list li {
                font-size: 9pt;
                color: #64748b;
                padding: 2px 0 2px 14px;
                position: relative;
            }

            .ops-notes-list li:before {
                content: "\2022";
                position: absolute;
                left: 0;
                color: #2563eb;
                font-weight: bold;
            }

            /* ============================================
               PAGE FOOTER
               ============================================ */
            .ops-page-footer {
                margin-top: 25px;
                padding-top: 10px;
                border-top: 1px solid #e2e8f0;
            }

            .ops-footer-text {
                font-size: 8pt;
                color: #94a3b8;
            }

            .ops-footer-confidential {
                font-size: 7pt;
                font-weight: 600;
                color: #94a3b8;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                padding: 3px 8px;
                background: #f8fafc !important;
                border: 1px solid #e2e8f0;
                border-radius: 3px;
                text-align: right;
                -webkit-print-color-adjust: exact !important;
            }

            /* ============================================
               INFO BOX
               ============================================ */
            .ops-info-box {
                background-color: #f8fafc !important;
                padding: 14px 16px;
                border-radius: 4px;
                border-left: 4px solid;
                margin-bottom: 18px;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-info-label {
                font-weight: 600;
                color: #1e293b;
                display: inline-block;
                min-width: 90px;
                font-size: 9pt;
            }

            .ops-info-value {
                font-size: 9pt;
                color: #64748b;
            }

            /* ============================================
               MARGIN INDICATOR CARD
               ============================================ */
            .ops-margin-card {
                background: #ffffff !important;
                border: 1px solid #e2e8f0;
                border-left-width: 4px;
                padding: 16px 18px;
                -webkit-print-color-adjust: exact !important;
            }

            .ops-margin-label {
                font-size: 9pt;
                font-weight: 600;
                color: #64748b;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }

            .ops-margin-formula {
                font-size: 9pt;
                color: #94a3b8;
                margin-top: 3px;
            }

            .ops-margin-value {
                font-family: 'DejaVu Sans Mono', 'Courier New', monospace;
                font-size: 28pt;
                font-weight: 700;
            }

            /* ============================================
               UTILITY CLASSES
               ============================================ */
            .text-end { text-align: right !important; }
            .text-center { text-align: center !important; }
            .text-left { text-align: left !important; }
            .font-bold { font-weight: 700; }
            .font-semibold { font-weight: 600; }

            /* Float-based column system */
            .row { display: table; width: 100%; }
            .row:after { content: ""; display: table; clear: both; }
            .col-6 { display: table-cell; width: 50%; vertical-align: top; }
            .col-4 { display: table-cell; width: 33.33%; vertical-align: top; }
            .col-3 { display: table-cell; width: 25%; vertical-align: top; }
            .col-12 { display: block; width: 100%; }

            /* Legacy compatibility */
            .ops_table_matrix { width: 100%; border-collapse: collapse; font-size: 10pt; }
            .ops_table_matrix th { padding: 8px; font-weight: 600; text-align: left; border-bottom: 2px solid #1e293b; }
            .ops_table_matrix td { padding: 8px; border-bottom: 1px solid #f1f5f9; }
            .ops-total-row { background-color: #f1f5f9 !important; font-weight: 600; -webkit-print-color-adjust: exact !important; }
            .ops-grand-total { font-weight: 700; -webkit-print-color-adjust: exact !important; }
            .ops-grand-total td { color: #ffffff !important; }

            /* Print Styles */
            @media print {
                .ops-no-print { display: none !important; }
                body { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
                * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
            }
        </style>
    </template>

    <!-- OPS External Layout - Wrapper for all Matrix Reports -->
    <template id="ops_external_layout">
        <t t-call="ops_matrix_accounting.ops_report_styles"/>
        <t t-call="web.external_layout">
            <div class="ops-report">
                <t t-raw="0"/>
            </div>
        </t>
    </template>

    <!-- OPS Minimal Layout - For reports that don't need full external layout -->
    <template id="ops_minimal_layout">
        <t t-call="ops_matrix_accounting.ops_report_styles"/>
        <div class="ops-report">
            <t t-raw="0"/>
        </div>
    </template>

    <!-- Helper template for standard report header -->
    <template id="ops_report_header_template">
        <div class="ops-report-header">
            <h2><t t-esc="title"/></h2>
            <p class="ops-subtitle" t-if="subtitle"><t t-esc="subtitle"/></p>
        </div>
    </template>

    <!-- Helper template for info box -->
    <template id="ops_info_box_template">
        <div class="ops-info-box">
            <table style="width: 100%;">
                <tr>
                    <td style="width: 50%; vertical-align: top;">
                        <span class="ops-info-label">Period:</span>
                        <span class="ops-info-value"><t t-esc="date_from"/> to <t t-esc="date_to"/></span><br/>
                        <span class="ops-info-label">Company:</span>
                        <span class="ops-info-value"><t t-esc="company.name if company else '-'"/></span>
                    </td>
                    <td style="width: 50%; vertical-align: top; text-align: right;">
                        <span class="ops-info-label">Generated:</span>
                        <span class="ops-info-value"><t t-esc="context_timestamp(datetime.datetime.now()).strftime('%Y-%m-%d %H:%M')"/></span><br/>
                        <t t-if="extra_info">
                            <span class="ops-info-label" t-esc="extra_info_label"/>:
                            <span class="ops-info-value" t-esc="extra_info"/>
                        </t>
                    </td>
                </tr>
            </table>
        </div>
    </template>

    <!-- Helper template for report footer -->
    <template id="ops_report_footer_template">
        <div class="ops-report-footer">
            <p class="ops-footer-note">
                <strong>Audit Trail:</strong>
                <t t-if="footer_text" t-esc="footer_text"/>
                <t t-else="">All data shown above is sourced from posted journal entries in the accounting system.</t>
            </p>
            <table style="width: 100%; margin-top: 6px;">
                <tr>
                    <td style="width: 50%; font-size: 8pt; color: #94a3b8;">
                        Page <span class="page"/> of <span class="topage"/>
                    </td>
                    <td style="width: 50%; text-align: right; font-size: 8pt; color: #94a3b8; font-style: italic;">
                        Generated by OPS Matrix
                    </td>
                </tr>
            </table>
        </div>
    </template>

    <!-- Number formatting helper with smart coloring -->
    <template id="ops_format_number">
        <t t-set="num_class" t-value="'ops-value-positive' if value > 0 else 'ops-value-negative' if value &lt; 0 else 'ops-value-zero'"/>
        <span t-attf-class="ops-mono #{num_class}">
            <t t-esc="'{:,.2f}'.format(value)"/>
        </span>
    </template>

    <!-- Legacy header template -->
    <template id="ops_legacy_header" inherit_id="ops_matrix_accounting.ops_report_header_template" primary="True">
    </template>

</odoo>
