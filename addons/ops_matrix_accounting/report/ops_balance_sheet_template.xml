<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!--
        ================================================================
        OPS CORPORATE BALANCE SHEET TEMPLATE
        Phase 4: Corporate Report Template Redesign
        ================================================================

        IAS 1 Compliant Statement of Financial Position
        - Current and Non-Current Assets
        - Current and Non-Current Liabilities
        - Shareholders' Equity
        - Balance verification: Assets = Liabilities + Equity

        SHARED COMPONENTS USED:
        - report_corporate_header
        - report_corporate_title
        - report_filter_bar
        - report_corporate_footer
    -->

    <template id="report_balance_sheet_corporate_document">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-set="data" t-value="doc._prepare_report_data()"/>
                <t t-set="company" t-value="data['company']"/>

                <div class="page" style="font-family: Arial, Helvetica, sans-serif; color: #1e293b;">

                    <!-- Corporate Header -->
                    <t t-call="ops_matrix_accounting.report_corporate_header"/>

                    <!-- Report Title -->
                    <t t-call="ops_matrix_accounting.report_corporate_title">
                        <t t-set="report_title" t-value="'Statement of Financial Position'"/>
                        <t t-set="report_pillar" t-value="'Financial Intelligence'"/>
                        <t t-set="date_end" t-value="data['date_end'].strftime('%B %d, %Y')"/>
                    </t>

                    <!-- Filter Info Bar -->
                    <t t-call="ops_matrix_accounting.report_filter_bar">
                        <t t-set="doc" t-value="doc"/>
                    </t>

                    <!-- ==================== ASSETS SECTION ==================== -->

                    <!-- Assets Header -->
                    <div style="background-color: #dbeafe; border-left: 4px solid #2563eb; padding: 10px 15px; margin: 20px 0 10px 0;">
                        <table width="100%" style="border-collapse: collapse;">
                            <tr>
                                <td style="font-size: 14px; font-weight: 700; color: #1e293b; text-transform: uppercase; letter-spacing: 0.5px;">
                                    ASSETS
                                </td>
                                <td style="text-align: right; font-size: 13px; font-weight: 700; font-family: Consolas, Monaco, monospace; color: #2563eb;">
                                    <t t-esc="'{:,.2f}'.format(data['total_assets'])"/>
                                </td>
                            </tr>
                        </table>
                    </div>

                    <!-- Assets Table -->
                    <table width="100%" style="border-collapse: collapse; font-size: 9px; margin-bottom: 15px;">
                        <thead>
                            <tr style="border-bottom: 2px solid #1e293b; background-color: #f8fafc;">
                                <th style="text-align: left; padding: 6px 8px; font-weight: 600; color: #475569; width: 40%;">Account</th>
                                <th style="text-align: right; padding: 6px 8px; font-weight: 600; color: #475569; width: 15%;">
                                    <t t-esc="data['date_end'].strftime('%b %d, %Y')"/>
                                </th>
                                <t t-if="data['show_comparison']">
                                    <th style="text-align: right; padding: 6px 8px; font-weight: 600; color: #475569; width: 15%;">
                                        <t t-esc="data['date_comparison'].strftime('%b %d, %Y')"/>
                                    </th>
                                    <th style="text-align: right; padding: 6px 8px; font-weight: 600; color: #475569; width: 15%;">Variance</th>
                                    <th style="text-align: right; padding: 6px 8px; font-weight: 600; color: #475569; width: 15%;">%</th>
                                </t>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Current Assets -->
                            <tr>
                                <td colspan="5" style="background-color: #eff6ff; padding: 6px 8px; font-weight: 600; font-size: 10px; color: #1e3a8a;">
                                    Current Assets
                                </td>
                            </tr>
                            <t t-foreach="data['assets']['current']" t-as="line">
                                <tr style="border-bottom: 1px solid #f1f5f9;">
                                    <td style="padding: 5px 8px 5px 20px; color: #475569;">
                                        <t t-if="line['code']"><t t-esc="line['code']"/> - </t>
                                        <t t-esc="line['name']"/>
                                    </td>
                                    <td style="text-align: right; padding: 5px 8px; font-family: Consolas, Monaco, monospace;">
                                        <t t-if="line['balance'] == 0">
                                            <span style="color: #94a3b8;">0.00</span>
                                        </t>
                                        <t t-elif="line['balance'] &lt; 0">
                                            <span style="color: #dc2626;">(<t t-esc="'{:,.2f}'.format(abs(line['balance']))"/>)</span>
                                        </t>
                                        <t t-else="">
                                            <t t-esc="'{:,.2f}'.format(line['balance'])"/>
                                        </t>
                                    </td>
                                    <t t-if="data['show_comparison']">
                                        <td style="text-align: right; padding: 5px 8px; font-family: Consolas, Monaco, monospace; color: #64748b;">
                                            <t t-esc="'{:,.2f}'.format(line.get('balance_comparison', 0))"/>
                                        </td>
                                        <td style="text-align: right; padding: 5px 8px; font-family: Consolas, Monaco, monospace;">
                                            <t t-set="var" t-value="line.get('variance', 0)"/>
                                            <span t-att-style="'color: ' + (var >= 0 and '#16a34a' or '#dc2626')">
                                                <t t-if="var &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(var))"/>)</t>
                                                <t t-else=""><t t-esc="'{:,.2f}'.format(var)"/></t>
                                            </span>
                                        </td>
                                        <td style="text-align: right; padding: 5px 8px; font-family: Consolas, Monaco, monospace; color: #64748b;">
                                            <t t-esc="'{:.1f}%'.format(line.get('variance_pct', 0))"/>
                                        </td>
                                    </t>
                                </tr>
                            </t>
                            <!-- Current Assets Subtotal -->
                            <tr style="background-color: #f8fafc;">
                                <td style="padding: 6px 8px 6px 20px; font-weight: 600; font-size: 9px;">Total Current Assets</td>
                                <td style="text-align: right; padding: 6px 8px; font-weight: 600; font-family: Consolas, Monaco, monospace; font-size: 9px;">
                                    <t t-esc="'{:,.2f}'.format(data['current_assets_total'])"/>
                                </td>
                                <t t-if="data['show_comparison']">
                                    <td style="text-align: right; padding: 6px 8px; font-weight: 600; font-family: Consolas, Monaco, monospace; font-size: 9px; color: #64748b;">
                                        <t t-esc="'{:,.2f}'.format(data['current_assets_total_comparison'])"/>
                                    </td>
                                    <td style="text-align: right; padding: 6px 8px; font-family: Consolas, Monaco, monospace; font-size: 9px;">
                                        <t t-set="ca_var" t-value="data['current_assets_total'] - data['current_assets_total_comparison']"/>
                                        <t t-if="ca_var &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(ca_var))"/>)</t>
                                        <t t-else=""><t t-esc="'{:,.2f}'.format(ca_var)"/></t>
                                    </td>
                                    <td style="text-align: right; padding: 6px 8px; color: #64748b; font-size: 9px;">-</td>
                                </t>
                            </tr>

                            <!-- Non-Current Assets -->
                            <tr>
                                <td colspan="5" style="background-color: #eff6ff; padding: 6px 8px; font-weight: 600; font-size: 10px; color: #1e3a8a;">
                                    Non-Current Assets
                                </td>
                            </tr>
                            <t t-foreach="data['assets']['non_current']" t-as="line">
                                <tr style="border-bottom: 1px solid #f1f5f9;">
                                    <td style="padding: 5px 8px 5px 20px; color: #475569;">
                                        <t t-if="line['code']"><t t-esc="line['code']"/> - </t>
                                        <t t-esc="line['name']"/>
                                    </td>
                                    <td style="text-align: right; padding: 5px 8px; font-family: Consolas, Monaco, monospace;">
                                        <t t-if="line['balance'] == 0">
                                            <span style="color: #94a3b8;">0.00</span>
                                        </t>
                                        <t t-elif="line['balance'] &lt; 0">
                                            <span style="color: #dc2626;">(<t t-esc="'{:,.2f}'.format(abs(line['balance']))"/>)</span>
                                        </t>
                                        <t t-else="">
                                            <t t-esc="'{:,.2f}'.format(line['balance'])"/>
                                        </t>
                                    </td>
                                    <t t-if="data['show_comparison']">
                                        <td style="text-align: right; padding: 5px 8px; font-family: Consolas, Monaco, monospace; color: #64748b;">
                                            <t t-esc="'{:,.2f}'.format(line.get('balance_comparison', 0))"/>
                                        </td>
                                        <td style="text-align: right; padding: 5px 8px; font-family: Consolas, Monaco, monospace;">
                                            <t t-set="var" t-value="line.get('variance', 0)"/>
                                            <span t-att-style="'color: ' + (var >= 0 and '#16a34a' or '#dc2626')">
                                                <t t-if="var &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(var))"/>)</t>
                                                <t t-else=""><t t-esc="'{:,.2f}'.format(var)"/></t>
                                            </span>
                                        </td>
                                        <td style="text-align: right; padding: 5px 8px; font-family: Consolas, Monaco, monospace; color: #64748b;">
                                            <t t-esc="'{:.1f}%'.format(line.get('variance_pct', 0))"/>
                                        </td>
                                    </t>
                                </tr>
                            </t>
                            <!-- Non-Current Assets Subtotal -->
                            <tr style="background-color: #f8fafc;">
                                <td style="padding: 6px 8px 6px 20px; font-weight: 600; font-size: 9px;">Total Non-Current Assets</td>
                                <td style="text-align: right; padding: 6px 8px; font-weight: 600; font-family: Consolas, Monaco, monospace; font-size: 9px;">
                                    <t t-esc="'{:,.2f}'.format(data['non_current_assets_total'])"/>
                                </td>
                                <t t-if="data['show_comparison']">
                                    <td style="text-align: right; padding: 6px 8px; font-weight: 600; font-family: Consolas, Monaco, monospace; font-size: 9px; color: #64748b;">
                                        <t t-esc="'{:,.2f}'.format(data['non_current_assets_total_comparison'])"/>
                                    </td>
                                    <td style="text-align: right; padding: 6px 8px; font-family: Consolas, Monaco, monospace; font-size: 9px;">
                                        <t t-set="nca_var" t-value="data['non_current_assets_total'] - data['non_current_assets_total_comparison']"/>
                                        <t t-if="nca_var &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(nca_var))"/>)</t>
                                        <t t-else=""><t t-esc="'{:,.2f}'.format(nca_var)"/></t>
                                    </td>
                                    <td style="text-align: right; padding: 6px 8px; color: #64748b; font-size: 9px;">-</td>
                                </t>
                            </tr>

                            <!-- Total Assets -->
                            <tr style="border-top: 2px solid #1e293b; border-bottom: 3px double #1e293b; background-color: #f1f5f9;">
                                <td style="padding: 10px 8px; font-weight: 700; text-transform: uppercase; font-size: 10px;">TOTAL ASSETS</td>
                                <td style="text-align: right; padding: 10px 8px; font-weight: 700; font-family: Consolas, Monaco, monospace; font-size: 10px; color: #2563eb;">
                                    <t t-esc="'{:,.2f}'.format(data['total_assets'])"/>
                                </td>
                                <t t-if="data['show_comparison']">
                                    <td style="text-align: right; padding: 10px 8px; font-weight: 700; font-family: Consolas, Monaco, monospace; font-size: 10px; color: #64748b;">
                                        <t t-esc="'{:,.2f}'.format(data['total_assets_comparison'])"/>
                                    </td>
                                    <td style="text-align: right; padding: 10px 8px; font-family: Consolas, Monaco, monospace; font-size: 10px;">
                                        <t t-set="ta_var" t-value="data['total_assets'] - data['total_assets_comparison']"/>
                                        <t t-if="ta_var &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(ta_var))"/>)</t>
                                        <t t-else=""><t t-esc="'{:,.2f}'.format(ta_var)"/></t>
                                    </td>
                                    <td style="text-align: right; padding: 10px 8px; color: #64748b; font-size: 10px;">-</td>
                                </t>
                            </tr>
                        </tbody>
                    </table>

                    <!-- ==================== LIABILITIES SECTION ==================== -->

                    <!-- Liabilities Header -->
                    <div style="background-color: #fff7ed; border-left: 4px solid #d97706; padding: 10px 15px; margin: 20px 0 10px 0;">
                        <table width="100%" style="border-collapse: collapse;">
                            <tr>
                                <td style="font-size: 14px; font-weight: 700; color: #1e293b; text-transform: uppercase; letter-spacing: 0.5px;">
                                    LIABILITIES
                                </td>
                                <td style="text-align: right; font-size: 13px; font-weight: 700; font-family: Consolas, Monaco, monospace; color: #d97706;">
                                    <t t-esc="'{:,.2f}'.format(data['total_liabilities'])"/>
                                </td>
                            </tr>
                        </table>
                    </div>

                    <!-- Liabilities Table -->
                    <table width="100%" style="border-collapse: collapse; font-size: 9px; margin-bottom: 15px;">
                        <tbody>
                            <!-- Current Liabilities -->
                            <tr>
                                <td colspan="5" style="background-color: #fffbeb; padding: 6px 8px; font-weight: 600; font-size: 10px; color: #78350f;">
                                    Current Liabilities
                                </td>
                            </tr>
                            <t t-foreach="data['liabilities']['current']" t-as="line">
                                <tr style="border-bottom: 1px solid #f1f5f9;">
                                    <td style="padding: 5px 8px 5px 20px; color: #475569; width: 40%;">
                                        <t t-if="line['code']"><t t-esc="line['code']"/> - </t>
                                        <t t-esc="line['name']"/>
                                    </td>
                                    <td style="text-align: right; padding: 5px 8px; font-family: Consolas, Monaco, monospace; width: 15%;">
                                        <t t-esc="'{:,.2f}'.format(abs(line['balance']))"/>
                                    </td>
                                    <t t-if="data['show_comparison']">
                                        <td style="text-align: right; padding: 5px 8px; font-family: Consolas, Monaco, monospace; color: #64748b; width: 15%;">
                                            <t t-esc="'{:,.2f}'.format(abs(line.get('balance_comparison', 0)))"/>
                                        </td>
                                        <td style="text-align: right; padding: 5px 8px; font-family: Consolas, Monaco, monospace; width: 15%;">
                                            <t t-set="l_var" t-value="abs(line['balance']) - abs(line.get('balance_comparison', 0))"/>
                                            <span t-att-style="'color: ' + (l_var &lt;= 0 and '#16a34a' or '#dc2626')">
                                                <t t-if="l_var &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(l_var))"/>)</t>
                                                <t t-else=""><t t-esc="'{:,.2f}'.format(l_var)"/></t>
                                            </span>
                                        </td>
                                        <td style="text-align: right; padding: 5px 8px; font-family: Consolas, Monaco, monospace; color: #64748b; width: 15%;">
                                            <t t-esc="'{:.1f}%'.format(line.get('variance_pct', 0))"/>
                                        </td>
                                    </t>
                                </tr>
                            </t>
                            <!-- Current Liabilities Subtotal -->
                            <tr style="background-color: #f8fafc;">
                                <td style="padding: 6px 8px 6px 20px; font-weight: 600; font-size: 9px;">Total Current Liabilities</td>
                                <td style="text-align: right; padding: 6px 8px; font-weight: 600; font-family: Consolas, Monaco, monospace; font-size: 9px;">
                                    <t t-esc="'{:,.2f}'.format(data['current_liabilities_total'])"/>
                                </td>
                                <t t-if="data['show_comparison']">
                                    <td style="text-align: right; padding: 6px 8px; font-weight: 600; font-family: Consolas, Monaco, monospace; font-size: 9px; color: #64748b;">
                                        <t t-esc="'{:,.2f}'.format(data['current_liabilities_total_comparison'])"/>
                                    </td>
                                    <td style="text-align: right; padding: 6px 8px; font-family: Consolas, Monaco, monospace; font-size: 9px;">
                                        <t t-set="cl_var" t-value="data['current_liabilities_total'] - data['current_liabilities_total_comparison']"/>
                                        <t t-if="cl_var &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(cl_var))"/>)</t>
                                        <t t-else=""><t t-esc="'{:,.2f}'.format(cl_var)"/></t>
                                    </td>
                                    <td style="text-align: right; padding: 6px 8px; color: #64748b; font-size: 9px;">-</td>
                                </t>
                            </tr>

                            <!-- Non-Current Liabilities -->
                            <tr>
                                <td colspan="5" style="background-color: #fffbeb; padding: 6px 8px; font-weight: 600; font-size: 10px; color: #78350f;">
                                    Non-Current Liabilities
                                </td>
                            </tr>
                            <t t-foreach="data['liabilities']['non_current']" t-as="line">
                                <tr style="border-bottom: 1px solid #f1f5f9;">
                                    <td style="padding: 5px 8px 5px 20px; color: #475569;">
                                        <t t-if="line['code']"><t t-esc="line['code']"/> - </t>
                                        <t t-esc="line['name']"/>
                                    </td>
                                    <td style="text-align: right; padding: 5px 8px; font-family: Consolas, Monaco, monospace;">
                                        <t t-esc="'{:,.2f}'.format(abs(line['balance']))"/>
                                    </td>
                                    <t t-if="data['show_comparison']">
                                        <td style="text-align: right; padding: 5px 8px; font-family: Consolas, Monaco, monospace; color: #64748b;">
                                            <t t-esc="'{:,.2f}'.format(abs(line.get('balance_comparison', 0)))"/>
                                        </td>
                                        <td style="text-align: right; padding: 5px 8px; font-family: Consolas, Monaco, monospace;">
                                            <t t-set="l_var" t-value="abs(line['balance']) - abs(line.get('balance_comparison', 0))"/>
                                            <span t-att-style="'color: ' + (l_var &lt;= 0 and '#16a34a' or '#dc2626')">
                                                <t t-if="l_var &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(l_var))"/>)</t>
                                                <t t-else=""><t t-esc="'{:,.2f}'.format(l_var)"/></t>
                                            </span>
                                        </td>
                                        <td style="text-align: right; padding: 5px 8px; font-family: Consolas, Monaco, monospace; color: #64748b;">
                                            <t t-esc="'{:.1f}%'.format(line.get('variance_pct', 0))"/>
                                        </td>
                                    </t>
                                </tr>
                            </t>
                            <!-- Non-Current Liabilities Subtotal -->
                            <tr style="background-color: #f8fafc;">
                                <td style="padding: 6px 8px 6px 20px; font-weight: 600; font-size: 9px;">Total Non-Current Liabilities</td>
                                <td style="text-align: right; padding: 6px 8px; font-weight: 600; font-family: Consolas, Monaco, monospace; font-size: 9px;">
                                    <t t-esc="'{:,.2f}'.format(data['non_current_liabilities_total'])"/>
                                </td>
                                <t t-if="data['show_comparison']">
                                    <td style="text-align: right; padding: 6px 8px; font-weight: 600; font-family: Consolas, Monaco, monospace; font-size: 9px; color: #64748b;">
                                        <t t-esc="'{:,.2f}'.format(data['non_current_liabilities_total_comparison'])"/>
                                    </td>
                                    <td style="text-align: right; padding: 6px 8px; font-family: Consolas, Monaco, monospace; font-size: 9px;">
                                        <t t-set="ncl_var" t-value="data['non_current_liabilities_total'] - data['non_current_liabilities_total_comparison']"/>
                                        <t t-if="ncl_var &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(ncl_var))"/>)</t>
                                        <t t-else=""><t t-esc="'{:,.2f}'.format(ncl_var)"/></t>
                                    </td>
                                    <td style="text-align: right; padding: 6px 8px; color: #64748b; font-size: 9px;">-</td>
                                </t>
                            </tr>

                            <!-- Total Liabilities -->
                            <tr style="border-top: 2px solid #1e293b; border-bottom: 3px double #1e293b; background-color: #f1f5f9;">
                                <td style="padding: 10px 8px; font-weight: 700; text-transform: uppercase; font-size: 10px;">TOTAL LIABILITIES</td>
                                <td style="text-align: right; padding: 10px 8px; font-weight: 700; font-family: Consolas, Monaco, monospace; font-size: 10px; color: #d97706;">
                                    <t t-esc="'{:,.2f}'.format(data['total_liabilities'])"/>
                                </td>
                                <t t-if="data['show_comparison']">
                                    <td style="text-align: right; padding: 10px 8px; font-weight: 700; font-family: Consolas, Monaco, monospace; font-size: 10px; color: #64748b;">
                                        <t t-esc="'{:,.2f}'.format(data['total_liabilities_comparison'])"/>
                                    </td>
                                    <td style="text-align: right; padding: 10px 8px; font-family: Consolas, Monaco, monospace; font-size: 10px;">
                                        <t t-set="tl_var" t-value="data['total_liabilities'] - data['total_liabilities_comparison']"/>
                                        <t t-if="tl_var &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(tl_var))"/>)</t>
                                        <t t-else=""><t t-esc="'{:,.2f}'.format(tl_var)"/></t>
                                    </td>
                                    <td style="text-align: right; padding: 10px 8px; color: #64748b; font-size: 10px;">-</td>
                                </t>
                            </tr>
                        </tbody>
                    </table>

                    <!-- ==================== EQUITY SECTION ==================== -->

                    <!-- Equity Header -->
                    <div style="background-color: #f0fdf4; border-left: 4px solid #059669; padding: 10px 15px; margin: 20px 0 10px 0;">
                        <table width="100%" style="border-collapse: collapse;">
                            <tr>
                                <td style="font-size: 14px; font-weight: 700; color: #1e293b; text-transform: uppercase; letter-spacing: 0.5px;">
                                    SHAREHOLDERS' EQUITY
                                </td>
                                <td style="text-align: right; font-size: 13px; font-weight: 700; font-family: Consolas, Monaco, monospace; color: #059669;">
                                    <t t-esc="'{:,.2f}'.format(data['total_equity'])"/>
                                </td>
                            </tr>
                        </table>
                    </div>

                    <!-- Equity Table -->
                    <table width="100%" style="border-collapse: collapse; font-size: 9px; margin-bottom: 15px;">
                        <tbody>
                            <t t-foreach="data['equity']['lines']" t-as="line">
                                <tr style="border-bottom: 1px solid #f1f5f9;">
                                    <td style="padding: 5px 8px 5px 20px; color: #475569; width: 40%;">
                                        <t t-if="line['code']"><t t-esc="line['code']"/> - </t>
                                        <t t-esc="line['name']"/>
                                    </td>
                                    <td style="text-align: right; padding: 5px 8px; font-family: Consolas, Monaco, monospace; width: 15%;">
                                        <t t-esc="'{:,.2f}'.format(abs(line['balance']))"/>
                                    </td>
                                    <t t-if="data['show_comparison']">
                                        <td style="text-align: right; padding: 5px 8px; font-family: Consolas, Monaco, monospace; color: #64748b; width: 15%;">
                                            <t t-esc="'{:,.2f}'.format(abs(line.get('balance_comparison', 0)))"/>
                                        </td>
                                        <td style="text-align: right; padding: 5px 8px; font-family: Consolas, Monaco, monospace; width: 15%;">
                                            <t t-set="e_var" t-value="abs(line['balance']) - abs(line.get('balance_comparison', 0))"/>
                                            <span t-att-style="'color: ' + (e_var >= 0 and '#16a34a' or '#dc2626')">
                                                <t t-if="e_var &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(e_var))"/>)</t>
                                                <t t-else=""><t t-esc="'{:,.2f}'.format(e_var)"/></t>
                                            </span>
                                        </td>
                                        <td style="text-align: right; padding: 5px 8px; font-family: Consolas, Monaco, monospace; color: #64748b; width: 15%;">
                                            <t t-esc="'{:.1f}%'.format(line.get('variance_pct', 0))"/>
                                        </td>
                                    </t>
                                </tr>
                            </t>

                            <!-- Total Equity -->
                            <tr style="border-top: 2px solid #1e293b; border-bottom: 3px double #1e293b; background-color: #f1f5f9;">
                                <td style="padding: 10px 8px; font-weight: 700; text-transform: uppercase; font-size: 10px;">TOTAL SHAREHOLDERS' EQUITY</td>
                                <td style="text-align: right; padding: 10px 8px; font-weight: 700; font-family: Consolas, Monaco, monospace; font-size: 10px; color: #059669;">
                                    <t t-esc="'{:,.2f}'.format(data['total_equity'])"/>
                                </td>
                                <t t-if="data['show_comparison']">
                                    <td style="text-align: right; padding: 10px 8px; font-weight: 700; font-family: Consolas, Monaco, monospace; font-size: 10px; color: #64748b;">
                                        <t t-esc="'{:,.2f}'.format(data['total_equity_comparison'])"/>
                                    </td>
                                    <td style="text-align: right; padding: 10px 8px; font-family: Consolas, Monaco, monospace; font-size: 10px;">
                                        <t t-set="te_var" t-value="data['total_equity'] - data['total_equity_comparison']"/>
                                        <t t-if="te_var &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(te_var))"/>)</t>
                                        <t t-else=""><t t-esc="'{:,.2f}'.format(te_var)"/></t>
                                    </td>
                                    <td style="text-align: right; padding: 10px 8px; color: #64748b; font-size: 10px;">-</td>
                                </t>
                            </tr>
                        </tbody>
                    </table>

                    <!-- ==================== GRAND TOTAL (Liabilities + Equity) ==================== -->

                    <table width="100%" style="border-collapse: collapse; font-size: 9px; margin-bottom: 20px;">
                        <tbody>
                            <tr style="border-top: 2px solid #1e293b; border-bottom: 3px double #1e293b; background-color: #1e293b;">
                                <td style="padding: 12px 8px; font-weight: 700; text-transform: uppercase; font-size: 11px; color: #ffffff; width: 40%;">
                                    TOTAL LIABILITIES + EQUITY
                                </td>
                                <td style="text-align: right; padding: 12px 8px; font-weight: 700; font-family: Consolas, Monaco, monospace; font-size: 11px; color: #ffffff; width: 15%;">
                                    <t t-esc="'{:,.2f}'.format(data['total_liab_equity'])"/>
                                </td>
                                <t t-if="data['show_comparison']">
                                    <td style="text-align: right; padding: 12px 8px; font-weight: 700; font-family: Consolas, Monaco, monospace; font-size: 11px; color: #cbd5e1; width: 15%;">
                                        <t t-esc="'{:,.2f}'.format(data['total_liab_equity_comparison'])"/>
                                    </td>
                                    <td style="width: 15%;"></td>
                                    <td style="width: 15%;"></td>
                                </t>
                            </tr>
                        </tbody>
                    </table>

                    <!-- ==================== BALANCE VERIFICATION ==================== -->

                    <div style="background-color: #f8fafc; border: 1px solid #e2e8f0; border-radius: 4px; padding: 15px; margin-bottom: 20px;">
                        <table width="100%" style="border-collapse: collapse;">
                            <tr>
                                <td style="width: 70%; vertical-align: middle;">
                                    <span style="font-size: 11px; font-weight: 600; color: #1e293b;">
                                        Accounting Equation Verification:
                                    </span>
                                    <span style="font-size: 10px; color: #64748b; margin-left: 10px; font-family: Consolas, Monaco, monospace;">
                                        <t t-esc="'{:,.2f}'.format(data['total_assets'])"/> =
                                        <t t-esc="'{:,.2f}'.format(data['total_liab_equity'])"/>
                                    </span>
                                </td>
                                <td style="width: 30%; text-align: right; vertical-align: middle;">
                                    <t t-if="data['is_balanced']">
                                        <span style="display: inline-block; background-color: #dcfce7; color: #16a34a; padding: 6px 12px; border-radius: 3px; font-size: 10px; font-weight: 600; border: 1px solid #86efac;">
                                            ✓ BALANCED
                                        </span>
                                    </t>
                                    <t t-else="">
                                        <span style="display: inline-block; background-color: #fef2f2; color: #dc2626; padding: 6px 12px; border-radius: 3px; font-size: 10px; font-weight: 600; border: 1px solid #fecaca;">
                                            ⚠ UNBALANCED
                                        </span>
                                        <div style="font-size: 9px; color: #dc2626; margin-top: 4px;">
                                            Diff: <t t-esc="'{:,.2f}'.format(data['balance_difference'])"/>
                                        </div>
                                    </t>
                                </td>
                            </tr>
                        </table>
                    </div>

                    <!-- Notes Section -->
                    <div style="margin-top: 25px; background-color: #f8fafc; border-left: 3px solid #5B6BBB; padding: 12px 15px;">
                        <div style="font-size: 10px; font-weight: 600; color: #1e293b; margin-bottom: 8px;">
                            Notes to Statement of Financial Position
                        </div>
                        <ul style="margin: 0; padding-left: 20px; font-size: 9px; color: #475569; line-height: 1.6;">
                            <li>Prepared in accordance with IAS 1 - Presentation of Financial Statements</li>
                            <li>All amounts presented in <t t-esc="data['currency'].name"/> (<t t-esc="data['currency'].symbol"/>)</li>
                            <t t-if="data['show_comparison']">
                                <li>Comparative figures as at <t t-esc="data['date_comparison'].strftime('%B %d, %Y')"/></li>
                            </t>
                            <li>Current assets/liabilities are expected to be realized/settled within 12 months</li>
                            <t t-if="not data['is_consolidated']">
                                <li>Filtered by Branch: <t t-esc="', '.join(data['branches'].mapped('name'))"/></li>
                            </t>
                            <t t-if="data['business_units']">
                                <li>Filtered by Business Unit: <t t-esc="', '.join(data['business_units'].mapped('name'))"/></li>
                            </t>
                        </ul>
                    </div>

                    <!-- Corporate Footer -->
                    <t t-call="ops_matrix_accounting.report_corporate_footer"/>

                </div>
            </t>
        </t>
    </template>

    <record id="action_report_balance_sheet_corporate" model="ir.actions.report">
        <field name="name">Balance Sheet (Corporate)</field>
        <field name="model">ops.balance.sheet.wizard</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">ops_matrix_accounting.report_balance_sheet_corporate_document</field>
        <field name="report_file">ops_matrix_accounting.report_balance_sheet_corporate_document</field>
        <field name="binding_model_id" ref="model_ops_balance_sheet_wizard"/>
        <field name="binding_type">report</field>
        <field name="paperformat_id" ref="base.paperformat_euro"/>
    </record>

</odoo>
