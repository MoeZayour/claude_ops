<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!--
        ================================================================
        OPS CORPORATE TREASURY REPORTS - GL Gold Standard
        ================================================================
        wkhtmltopdf-compatible: NO flexbox, NO font-variant-numeric.
        All layouts use tables/inline-block for QtWebKit ~534.
        Colors: Dynamic from company.ops_report_primary_color
        Reports: PDC Registry, PDC Maturity Analysis, PDCs in Hand
    -->

    <!-- ================================================================
         REPORT ACTIONS
         ================================================================ -->

    <record id="report_treasury_registry_pdf" model="ir.actions.report">
        <field name="name">PDC Registry Report (Corporate)</field>
        <field name="model">ops.treasury.report.wizard</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">ops_matrix_accounting.report_treasury_registry_corporate</field>
        <field name="report_file">ops_matrix_accounting.report_treasury_registry_corporate</field>
        <field name="binding_model_id" ref="model_ops_treasury_report_wizard"/>
        <field name="binding_type">report</field>
        <field name="paperformat_id" ref="paperformat_ops_corporate_a4"/>
    </record>

    <record id="report_treasury_maturity_pdf" model="ir.actions.report">
        <field name="name">PDC Maturity Analysis (Corporate)</field>
        <field name="model">ops.treasury.report.wizard</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">ops_matrix_accounting.report_treasury_maturity_corporate</field>
        <field name="report_file">ops_matrix_accounting.report_treasury_maturity_corporate</field>
        <field name="binding_model_id" ref="model_ops_treasury_report_wizard"/>
        <field name="binding_type">report</field>
        <field name="paperformat_id" ref="paperformat_ops_corporate_a4"/>
    </record>

    <record id="report_treasury_on_hand_pdf" model="ir.actions.report">
        <field name="name">PDCs in Hand (Corporate)</field>
        <field name="model">ops.treasury.report.wizard</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">ops_matrix_accounting.report_treasury_on_hand_corporate</field>
        <field name="report_file">ops_matrix_accounting.report_treasury_on_hand_corporate</field>
        <field name="binding_model_id" ref="model_ops_treasury_report_wizard"/>
        <field name="binding_type">report</field>
        <field name="paperformat_id" ref="paperformat_ops_corporate_a4"/>
    </record>

    <!-- ================================================================
         PDC REGISTRY TEMPLATE
         ================================================================ -->

    <template id="report_treasury_registry_corporate">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-set="company" t-value="doc.company_id or env.company"/>
                <t t-set="pc" t-value="primary_color"/>
                <t t-set="tc" t-value="text_on_primary"/>
                <t t-set="pl" t-value="primary_light"/>
                <t t-set="pd" t-value="primary_dark"/>
                <t t-set="rd" t-value="report_data"/>
                <t t-set="totals" t-value="rd.get('totals', {})"/>

                <t t-call="ops_matrix_accounting.ops_corporate_pdf_layout">
                    <style>
                        * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
                        @page { size: A4; margin: 15mm 12mm 25mm 12mm; }
                        .num { text-align: right; font-family: Consolas, Monaco, 'Courier New', monospace; }
                        .val-zero { color: #bbbbbb; }
                        .page-footer-fixed { position: fixed; bottom: 0; left: 0; right: 0; padding: 6px 0 0 0; border-top: 1px solid #e2e8f0; }
                    </style>

                    <div class="page ops-report" t-attf-style="color: {{body_text_color}}; font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, Helvetica, sans-serif; font-size: 8.5pt; line-height: 1.45;">

                        <!-- HEADER -->
                        <table width="100%" style="border-collapse: collapse; margin-bottom: 15px;" t-attf-style="border-bottom: 2px solid {{pc}}; padding-bottom: 10px;">
                            <tr>
                                <td style="vertical-align: middle; width: 60%;">
                                    <table style="border-collapse: collapse;"><tr>
                                        <t t-if="company.logo">
                                            <td style="vertical-align: middle; padding-right: 12px;">
                                                <img t-att-src="image_data_uri(company.logo)" style="max-height: 45px; max-width: 100px; border-radius: 6px; object-fit: contain;" alt="Company Logo"/>
                                            </td>
                                        </t>
                                        <t t-else="">
                                            <td style="vertical-align: middle; padding-right: 12px;">
                                                <div t-attf-style="width: 45px; height: 45px; border-radius: 6px; background: {{pc}}; color: {{tc}}; font-weight: 700; font-size: 14pt; text-align: center; line-height: 45px;"><t t-esc="(company.name or 'CO')[:2].upper()"/></div>
                                            </td>
                                        </t>
                                        <td style="vertical-align: middle;">
                                            <div style="font-size: 14pt; font-weight: 700; color: #1e293b; line-height: 1.2;"><t t-esc="company.name"/></div>
                                            <div style="font-size: 8.5pt; color: #666666; margin-top: 1px;"><t t-if="company.city"><t t-esc="company.city"/></t><t t-if="company.city and company.country_id">, </t><t t-esc="company.country_id.name or ''"/></div>
                                        </td>
                                    </tr></table>
                                </td>
                                <td style="vertical-align: top; width: 40%; text-align: right;">
                                    <div style="font-size: 8pt; color: #666666; line-height: 1.6;">Printed: <t t-esc="context_timestamp(datetime.datetime.now()).strftime('%d %b %Y %H:%M')"/><br/>Generated by: <t t-esc="user.name"/></div>
                                    <div style="font-family: 'Courier New', monospace; font-size: 7pt; color: #94a3b8; letter-spacing: 0.3px; margin-top: 2px;">Report ID: <t t-esc="report_run_id"/></div>
                                </td>
                            </tr>
                        </table>

                        <!-- TITLE BLOCK -->
                        <div style="margin: 8px 0 4px 0;">
                            <div style="font-size: 16pt; font-weight: 700; color: #1e293b; margin-bottom: 4px;">PDC Registry</div>
                            <div style="font-size: 8.5pt; color: #666666;">
                                <t t-if="date_from and date_to"><t t-esc="date_from"/> &#x2014; <t t-esc="date_to"/></t>
                                <t t-else="">All Dates</t>
                                <span style="color: #94a3b8;"> | </span><t t-esc="currency_name"/>
                                <span style="color: #94a3b8;"> | </span><t t-esc="totals.get('total_count', 0)"/> checks
                            </div>
                        </div>

                        <!-- SUMMARY ROW -->
                        <table width="100%" style="border-collapse: collapse; margin: 12px 0 22px 0; border-radius: 4px;" t-attf-style="background: {{pl}};">
                            <tr>
                                <td style="padding: 12px 16px; vertical-align: top; width: 33%;">
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Receivable PDCs</div>
                                    <div style="font-size: 13pt; font-weight: 700; color: #0891b2; font-family: Consolas, Monaco, monospace;"><t t-esc="'{:,.2f}'.format(totals.get('inbound_total', 0))"/></div>
                                    <div style="font-size: 7pt; color: #94a3b8; margin-top: 2px;"><t t-esc="rd.get('inbound', {}).get('count', 0)"/> checks</div>
                                </td>
                                <td style="padding: 12px 16px; vertical-align: top; width: 33%;">
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Payable PDCs</div>
                                    <div style="font-size: 13pt; font-weight: 700; color: #f59e0b; font-family: Consolas, Monaco, monospace;"><t t-esc="'{:,.2f}'.format(totals.get('outbound_total', 0))"/></div>
                                    <div style="font-size: 7pt; color: #94a3b8; margin-top: 2px;"><t t-esc="rd.get('outbound', {}).get('count', 0)"/> checks</div>
                                </td>
                                <td style="padding: 12px 16px; vertical-align: top; width: 34%;">
                                    <t t-set="net_pos" t-value="totals.get('net_position', 0)"/>
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Net Position</div>
                                    <div t-att-style="'font-size: 13pt; font-weight: 700; font-family: Consolas, Monaco, monospace; color: ' + (net_pos >= 0 and '#16a34a' or '#dc2626') + ';'">
                                        <t t-if="net_pos &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(net_pos))"/>)</t>
                                        <t t-else=""><t t-esc="'{:,.2f}'.format(net_pos)"/></t>
                                    </div>
                                </td>
                            </tr>
                        </table>

                        <!-- INBOUND SECTION -->
                        <t t-if="rd.get('pdc_type') in ('inbound', 'both') and rd.get('inbound', {}).get('data')">
                            <table width="100%" style="border-collapse: collapse; margin-bottom: 0;" t-attf-style="margin-top: 8px; background: {{pl}}; border-left: 3px solid {{pc}};">
                                <tr>
                                    <td style="padding: 7px 12px;" t-attf-style="font-weight: 600; font-size: 9pt; color: {{pd}};">RECEIVABLE PDCs (From Customers)</td>
                                    <td class="num" style="padding: 7px 12px; font-size: 8pt; color: #94a3b8;"><t t-esc="rd.get('inbound', {}).get('count', 0)"/> items</td>
                                </tr>
                            </table>
                            <table width="100%" style="border-collapse: collapse; font-size: 8pt; margin-bottom: 12px;">
                                <thead><tr>
                                    <th style="width: 12%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Reference</th>
                                    <th style="width: 18%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Partner</th>
                                    <th style="width: 10%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Check #</th>
                                    <th style="width: 14%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Bank</th>
                                    <th style="width: 11%; padding: 7px 8px; text-align: center; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Maturity</th>
                                    <th class="num" style="width: 16%; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Amount (<t t-esc="currency_name"/>)</th>
                                    <th style="width: 9%; padding: 7px 8px; text-align: center; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Status</th>
                                </tr></thead>
                                <tbody>
                                    <t t-foreach="rd.get('inbound', {}).get('data', [])" t-as="pdc">
                                        <tr t-att-style="'border-bottom: 1px solid #f1f5f9;' + (' background: #f8fafc;' if pdc_even else '')">
                                            <td style="padding: 5px 8px; font-weight: 500;"><t t-esc="pdc.get('name', '-')"/></td>
                                            <td style="padding: 5px 8px;"><t t-esc="pdc.get('partner_name', '-')"/></td>
                                            <td style="padding: 5px 8px; color: #64748b;"><t t-esc="pdc.get('check_number', '-')"/></td>
                                            <td style="padding: 5px 8px; color: #64748b;"><t t-esc="pdc.get('bank_name', '-')"/></td>
                                            <td style="padding: 5px 8px; text-align: center; color: #64748b; white-space: nowrap;"><t t-esc="pdc.get('maturity_date', '-')"/></td>
                                            <td class="num" style="padding: 5px 8px; color: #0891b2; font-weight: 600;"><t t-esc="'{:,.2f}'.format(pdc.get('amount', 0))"/></td>
                                            <td style="padding: 5px 8px; text-align: center;">
                                                <t t-set="st" t-value="pdc.get('state', 'draft')"/>
                                                <span t-attf-style="display: inline-block; padding: 2px 6px; border-radius: 3px; font-size: 6.5pt; font-weight: 600; color: #fff; background: #{st == 'cleared' and '#16a34a' or st == 'deposited' and '#2563eb' or st == 'bounced' and '#dc2626' or '#d97706'};"><t t-esc="pdc.get('state_label', st)"/></span>
                                            </td>
                                        </tr>
                                    </t>
                                </tbody>
                                <tfoot><tr t-attf-style="font-weight: 600; background: {{pl}};">
                                    <td colspan="5" t-attf-style="padding: 7px 8px; font-size: 8pt; color: {{pd}};">Subtotal Receivable</td>
                                    <td class="num" t-attf-style="padding: 7px 8px; font-size: 8pt; color: {{pd}};"><t t-esc="'{:,.2f}'.format(rd.get('inbound', {}).get('total', 0))"/></td>
                                    <td></td>
                                </tr></tfoot>
                            </table>
                        </t>

                        <!-- OUTBOUND SECTION -->
                        <t t-if="rd.get('pdc_type') in ('outbound', 'both') and rd.get('outbound', {}).get('data')">
                            <table width="100%" style="border-collapse: collapse; margin-bottom: 0;" t-attf-style="margin-top: 8px; background: {{pl}}; border-left: 3px solid {{pc}};">
                                <tr>
                                    <td style="padding: 7px 12px;" t-attf-style="font-weight: 600; font-size: 9pt; color: {{pd}};">PAYABLE PDCs (To Vendors)</td>
                                    <td class="num" style="padding: 7px 12px; font-size: 8pt; color: #94a3b8;"><t t-esc="rd.get('outbound', {}).get('count', 0)"/> items</td>
                                </tr>
                            </table>
                            <table width="100%" style="border-collapse: collapse; font-size: 8pt; margin-bottom: 12px;">
                                <thead><tr>
                                    <th style="width: 12%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Reference</th>
                                    <th style="width: 18%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Partner</th>
                                    <th style="width: 10%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Check #</th>
                                    <th style="width: 14%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Bank</th>
                                    <th style="width: 11%; padding: 7px 8px; text-align: center; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Maturity</th>
                                    <th class="num" style="width: 16%; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Amount (<t t-esc="currency_name"/>)</th>
                                    <th style="width: 9%; padding: 7px 8px; text-align: center; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Status</th>
                                </tr></thead>
                                <tbody>
                                    <t t-foreach="rd.get('outbound', {}).get('data', [])" t-as="pdc">
                                        <tr t-att-style="'border-bottom: 1px solid #f1f5f9;' + (' background: #f8fafc;' if pdc_even else '')">
                                            <td style="padding: 5px 8px; font-weight: 500;"><t t-esc="pdc.get('name', '-')"/></td>
                                            <td style="padding: 5px 8px;"><t t-esc="pdc.get('partner_name', '-')"/></td>
                                            <td style="padding: 5px 8px; color: #64748b;"><t t-esc="pdc.get('check_number', '-')"/></td>
                                            <td style="padding: 5px 8px; color: #64748b;"><t t-esc="pdc.get('bank_name', '-')"/></td>
                                            <td style="padding: 5px 8px; text-align: center; color: #64748b; white-space: nowrap;"><t t-esc="pdc.get('maturity_date', '-')"/></td>
                                            <td class="num" style="padding: 5px 8px; color: #f59e0b; font-weight: 600;"><t t-esc="'{:,.2f}'.format(pdc.get('amount', 0))"/></td>
                                            <td style="padding: 5px 8px; text-align: center;">
                                                <t t-set="st" t-value="pdc.get('state', 'draft')"/>
                                                <span t-attf-style="display: inline-block; padding: 2px 6px; border-radius: 3px; font-size: 6.5pt; font-weight: 600; color: #fff; background: #{st == 'cleared' and '#16a34a' or st == 'presented' and '#2563eb' or st == 'issued' and '#d97706' or '#94a3b8'};"><t t-esc="pdc.get('state_label', st)"/></span>
                                            </td>
                                        </tr>
                                    </t>
                                </tbody>
                                <tfoot><tr t-attf-style="font-weight: 600; background: {{pl}};">
                                    <td colspan="5" t-attf-style="padding: 7px 8px; font-size: 8pt; color: {{pd}};">Subtotal Payable</td>
                                    <td class="num" t-attf-style="padding: 7px 8px; font-size: 8pt; color: {{pd}};"><t t-esc="'{:,.2f}'.format(rd.get('outbound', {}).get('total', 0))"/></td>
                                    <td></td>
                                </tr></tfoot>
                            </table>
                        </t>

                        <!-- EMPTY STATE -->
                        <t t-if="not rd.get('inbound', {}).get('data') and not rd.get('outbound', {}).get('data')">
                            <div style="padding: 30px; text-align: center; color: #94a3b8; font-style: italic; border: 1px dashed #e2e8f0; border-radius: 4px; margin: 12px 0;">No PDCs found matching the criteria</div>
                        </t>

                        <!-- GRAND TOTAL BAR -->
                        <t t-set="net_pos" t-value="totals.get('net_position', 0)"/>
                        <div t-attf-style="margin-top: 8px; border-radius: 4px; overflow: hidden; background: {{pc}}; color: {{tc}}; page-break-inside: avoid;">
                            <table width="100%" style="border-collapse: collapse;">
                                <tr>
                                    <td style="width: 40%; padding: 13px 14px; font-weight: 600; font-size: 9pt; text-transform: uppercase; letter-spacing: 0.3px; border: none;">NET POSITION</td>
                                    <td class="num" style="width: 20%; padding: 13px 8px; font-size: 8pt; border: none;">In: <t t-esc="'{:,.0f}'.format(totals.get('inbound_total', 0))"/></td>
                                    <td class="num" style="width: 20%; padding: 13px 8px; font-size: 8pt; border: none;">Out: <t t-esc="'{:,.0f}'.format(totals.get('outbound_total', 0))"/></td>
                                    <td class="num" style="width: 20%; padding: 13px 8px; font-weight: 700; font-size: 10pt; border: none;">
                                        <t t-if="net_pos &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(net_pos))"/>)</t>
                                        <t t-else=""><t t-esc="'{:,.2f}'.format(net_pos)"/></t>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <!-- SIGNATURE BLOCK -->
                        <div style="margin-top: 28px; page-break-inside: avoid;">
                            <table width="100%" style="border-collapse: collapse; border: none;"><tr style="border: none;">
                                <td style="border: none; width: 33%; padding: 0 16px 0 0;"><div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">Prepared by</div><div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">Name / Date</div></td>
                                <td style="border: none; width: 33%; padding: 0 16px; border-left: 1px solid #e2e8f0;"><div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">Reviewed by</div><div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">Name / Date</div></td>
                                <td style="border: none; width: 33%; padding: 0 0 0 16px; border-left: 1px solid #e2e8f0;"><div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">Approved by</div><div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">Name / Date</div></td>
                            </tr></table>
                        </div>

                        <!-- FIXED FOOTER -->
                        <div class="page-footer-fixed" style="position: fixed; bottom: 0; left: 0; right: 0; padding: 6px 0 0 0; border-top: 1px solid #e2e8f0;">
                            <table style="width: 100%; border-collapse: collapse;"><tr>
                                <td style="width: 50%; text-align: left; vertical-align: middle; padding: 4px 0;"><span style="font-size: 8pt; color: #666666;">Powered by</span><img src="/ops_matrix_accounting/static/src/img/ops_badge_footer.png" style="height: 16px; vertical-align: middle; margin-left: 4px;" alt="OPS Framework"/></td>
                                <td style="width: 50%; text-align: right; vertical-align: middle; padding: 4px 0;"><span style="font-size: 6.5pt; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.5px;">Confidential &#x2014; For authorized personnel only</span></td>
                            </tr></table>
                        </div>

                    </div>
                </t>
            </t>
        </t>
    </template>

    <!-- ================================================================
         PDC MATURITY ANALYSIS TEMPLATE
         ================================================================ -->

    <template id="report_treasury_maturity_corporate">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-set="company" t-value="doc.company_id or env.company"/>
                <t t-set="pc" t-value="primary_color"/>
                <t t-set="tc" t-value="text_on_primary"/>
                <t t-set="pl" t-value="primary_light"/>
                <t t-set="pd" t-value="primary_dark"/>
                <t t-set="rd" t-value="report_data"/>
                <t t-set="totals" t-value="rd.get('totals', {})"/>

                <t t-call="ops_matrix_accounting.ops_corporate_pdf_layout">
                    <style>
                        * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
                        @page { size: A4; margin: 15mm 12mm 25mm 12mm; }
                        .num { text-align: right; font-family: Consolas, Monaco, 'Courier New', monospace; }
                        .val-zero { color: #bbbbbb; }
                        .page-footer-fixed { position: fixed; bottom: 0; left: 0; right: 0; padding: 6px 0 0 0; border-top: 1px solid #e2e8f0; }
                    </style>

                    <div class="page ops-report" t-attf-style="color: {{body_text_color}}; font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, Helvetica, sans-serif; font-size: 8.5pt; line-height: 1.45;">

                        <!-- HEADER -->
                        <table width="100%" style="border-collapse: collapse; margin-bottom: 15px;" t-attf-style="border-bottom: 2px solid {{pc}}; padding-bottom: 10px;">
                            <tr>
                                <td style="vertical-align: middle; width: 60%;">
                                    <table style="border-collapse: collapse;"><tr>
                                        <t t-if="company.logo">
                                            <td style="vertical-align: middle; padding-right: 12px;"><img t-att-src="image_data_uri(company.logo)" style="max-height: 45px; max-width: 100px; border-radius: 6px; object-fit: contain;" alt="Company Logo"/></td>
                                        </t>
                                        <t t-else="">
                                            <td style="vertical-align: middle; padding-right: 12px;"><div t-attf-style="width: 45px; height: 45px; border-radius: 6px; background: {{pc}}; color: {{tc}}; font-weight: 700; font-size: 14pt; text-align: center; line-height: 45px;"><t t-esc="(company.name or 'CO')[:2].upper()"/></div></td>
                                        </t>
                                        <td style="vertical-align: middle;">
                                            <div style="font-size: 14pt; font-weight: 700; color: #1e293b; line-height: 1.2;"><t t-esc="company.name"/></div>
                                            <div style="font-size: 8.5pt; color: #666666; margin-top: 1px;"><t t-if="company.city"><t t-esc="company.city"/></t><t t-if="company.city and company.country_id">, </t><t t-esc="company.country_id.name or ''"/></div>
                                        </td>
                                    </tr></table>
                                </td>
                                <td style="vertical-align: top; width: 40%; text-align: right;">
                                    <div style="font-size: 8pt; color: #666666; line-height: 1.6;">Printed: <t t-esc="context_timestamp(datetime.datetime.now()).strftime('%d %b %Y %H:%M')"/><br/>Generated by: <t t-esc="user.name"/></div>
                                    <div style="font-family: 'Courier New', monospace; font-size: 7pt; color: #94a3b8; letter-spacing: 0.3px; margin-top: 2px;">Report ID: <t t-esc="report_run_id"/></div>
                                </td>
                            </tr>
                        </table>

                        <!-- TITLE BLOCK -->
                        <div style="margin: 8px 0 4px 0;">
                            <div style="font-size: 16pt; font-weight: 700; color: #1e293b; margin-bottom: 4px;">PDC Maturity Analysis</div>
                            <div style="font-size: 8.5pt; color: #666666;">
                                As of <t t-esc="as_of_date"/>
                                <span style="color: #94a3b8;"> | </span><t t-esc="currency_name"/>
                                <span style="color: #94a3b8;"> | </span>Period: <t t-esc="rd.get('period_length', 30)"/> days
                            </div>
                        </div>

                        <!-- SUMMARY ROW -->
                        <table width="100%" style="border-collapse: collapse; margin: 12px 0 22px 0; border-radius: 4px;" t-attf-style="background: {{pl}};">
                            <tr>
                                <td style="padding: 12px 16px; vertical-align: top; width: 33%;">
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Total Inbound</div>
                                    <div style="font-size: 13pt; font-weight: 700; color: #0891b2; font-family: Consolas, Monaco, monospace;"><t t-esc="'{:,.2f}'.format(totals.get('inbound_total', 0))"/></div>
                                </td>
                                <td style="padding: 12px 16px; vertical-align: top; width: 33%;">
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Total Outbound</div>
                                    <div style="font-size: 13pt; font-weight: 700; color: #f59e0b; font-family: Consolas, Monaco, monospace;"><t t-esc="'{:,.2f}'.format(totals.get('outbound_total', 0))"/></div>
                                </td>
                                <td style="padding: 12px 16px; vertical-align: top; width: 34%;">
                                    <t t-set="net_pos" t-value="totals.get('net_position', 0)"/>
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Net Cash Flow</div>
                                    <div t-att-style="'font-size: 13pt; font-weight: 700; font-family: Consolas, Monaco, monospace; color: ' + (net_pos >= 0 and '#16a34a' or '#dc2626') + ';'">
                                        <t t-if="net_pos &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(net_pos))"/>)</t>
                                        <t t-else=""><t t-esc="'{:,.2f}'.format(net_pos)"/></t>
                                    </div>
                                </td>
                            </tr>
                        </table>

                        <!-- AGING DATA TABLE -->
                        <table width="100%" style="border-collapse: collapse; font-size: 8pt; margin-bottom: 2px;">
                            <thead><tr>
                                <th style="width: 22%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Period</th>
                                <th class="num" style="width: 20%; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Inbound (<t t-esc="currency_name"/>)</th>
                                <th style="width: 6%; padding: 7px 8px; text-align: center; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">#</th>
                                <th class="num" style="width: 20%; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Outbound (<t t-esc="currency_name"/>)</th>
                                <th style="width: 6%; padding: 7px 8px; text-align: center; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">#</th>
                                <th class="num" style="width: 20%; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Net Flow</th>
                            </tr></thead>
                            <tbody>
                                <t t-foreach="rd.get('aging_buckets', [])" t-as="bucket">
                                    <t t-set="net_flow" t-value="bucket.get('inbound', 0) - bucket.get('outbound', 0)"/>
                                    <t t-set="is_overdue" t-value="bucket.get('label', '').lower() == 'overdue'"/>
                                    <tr t-att-style="'border-bottom: 1px solid #f1f5f9;' + (' background: #fef2f2;' if is_overdue and (bucket.get('inbound', 0) > 0 or bucket.get('outbound', 0) > 0) else (' background: #f8fafc;' if bucket_even else ''))">
                                        <td style="padding: 6px 8px; font-weight: 500;">
                                            <t t-if="is_overdue"><span style="color: #dc2626; font-weight: 600;"><t t-esc="bucket.get('label', '-')"/></span></t>
                                            <t t-else=""><t t-esc="bucket.get('label', '-')"/></t>
                                        </td>
                                        <td class="num" style="padding: 6px 8px; color: #0891b2;">
                                            <t t-if="bucket.get('inbound', 0) &gt; 0"><t t-esc="'{:,.0f}'.format(bucket.get('inbound', 0))"/></t>
                                            <t t-else=""><span class="val-zero">-</span></t>
                                        </td>
                                        <td style="padding: 6px 8px; text-align: center; color: #94a3b8; font-size: 7pt;"><t t-esc="bucket.get('inbound_count', 0)"/></td>
                                        <td class="num" style="padding: 6px 8px; color: #f59e0b;">
                                            <t t-if="bucket.get('outbound', 0) &gt; 0"><t t-esc="'{:,.0f}'.format(bucket.get('outbound', 0))"/></t>
                                            <t t-else=""><span class="val-zero">-</span></t>
                                        </td>
                                        <td style="padding: 6px 8px; text-align: center; color: #94a3b8; font-size: 7pt;"><t t-esc="bucket.get('outbound_count', 0)"/></td>
                                        <td class="num" style="padding: 6px 8px; font-weight: 600;" t-att-style="'color: ' + (net_flow >= 0 and '#16a34a' or '#dc2626') + ';'">
                                            <t t-if="net_flow == 0"><span class="val-zero">-</span></t>
                                            <t t-elif="net_flow &lt; 0">(<t t-esc="'{:,.0f}'.format(abs(net_flow))"/>)</t>
                                            <t t-else=""><t t-esc="'{:,.0f}'.format(net_flow)"/></t>
                                        </td>
                                    </tr>
                                </t>
                                <t t-if="not rd.get('aging_buckets')">
                                    <tr><td colspan="6" style="text-align: center; padding: 20px; color: #94a3b8; font-style: italic;">No maturity data available</td></tr>
                                </t>
                            </tbody>
                        </table>

                        <!-- GRAND TOTAL BAR -->
                        <t t-set="net_pos" t-value="totals.get('net_position', 0)"/>
                        <div t-attf-style="margin-top: 4px; border-radius: 4px; overflow: hidden; background: {{pc}}; color: {{tc}}; page-break-inside: avoid;">
                            <table width="100%" style="border-collapse: collapse;">
                                <tr>
                                    <td style="width: 28%; padding: 13px 14px; font-weight: 600; font-size: 9pt; text-transform: uppercase; letter-spacing: 0.3px; border: none;">TOTAL</td>
                                    <td class="num" style="width: 24%; padding: 13px 8px; font-weight: 700; font-size: 10pt; border: none;"><t t-esc="'{:,.0f}'.format(totals.get('inbound_total', 0))"/></td>
                                    <td class="num" style="width: 24%; padding: 13px 8px; font-weight: 700; font-size: 10pt; border: none;"><t t-esc="'{:,.0f}'.format(totals.get('outbound_total', 0))"/></td>
                                    <td class="num" style="width: 24%; padding: 13px 8px; font-weight: 700; font-size: 10pt; border: none;">
                                        <t t-if="net_pos &lt; 0">(<t t-esc="'{:,.0f}'.format(abs(net_pos))"/>)</t>
                                        <t t-else=""><t t-esc="'{:,.0f}'.format(net_pos)"/></t>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <!-- SIGNATURE BLOCK -->
                        <div style="margin-top: 28px; page-break-inside: avoid;">
                            <table width="100%" style="border-collapse: collapse; border: none;"><tr style="border: none;">
                                <td style="border: none; width: 33%; padding: 0 16px 0 0;"><div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">Prepared by</div><div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">Name / Date</div></td>
                                <td style="border: none; width: 33%; padding: 0 16px; border-left: 1px solid #e2e8f0;"><div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">Reviewed by</div><div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">Name / Date</div></td>
                                <td style="border: none; width: 33%; padding: 0 0 0 16px; border-left: 1px solid #e2e8f0;"><div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">Approved by</div><div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">Name / Date</div></td>
                            </tr></table>
                        </div>

                        <!-- FIXED FOOTER -->
                        <div class="page-footer-fixed" style="position: fixed; bottom: 0; left: 0; right: 0; padding: 6px 0 0 0; border-top: 1px solid #e2e8f0;">
                            <table style="width: 100%; border-collapse: collapse;"><tr>
                                <td style="width: 50%; text-align: left; vertical-align: middle; padding: 4px 0;"><span style="font-size: 8pt; color: #666666;">Powered by</span><img src="/ops_matrix_accounting/static/src/img/ops_badge_footer.png" style="height: 16px; vertical-align: middle; margin-left: 4px;" alt="OPS Framework"/></td>
                                <td style="width: 50%; text-align: right; vertical-align: middle; padding: 4px 0;"><span style="font-size: 6.5pt; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.5px;">Confidential &#x2014; For authorized personnel only</span></td>
                            </tr></table>
                        </div>

                    </div>
                </t>
            </t>
        </t>
    </template>

    <!-- ================================================================
         PDCs IN HAND TEMPLATE
         ================================================================ -->

    <template id="report_treasury_on_hand_corporate">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-set="company" t-value="doc.company_id or env.company"/>
                <t t-set="pc" t-value="primary_color"/>
                <t t-set="tc" t-value="text_on_primary"/>
                <t t-set="pl" t-value="primary_light"/>
                <t t-set="pd" t-value="primary_dark"/>
                <t t-set="rd" t-value="report_data"/>
                <t t-set="totals" t-value="rd.get('totals', {})"/>

                <t t-call="ops_matrix_accounting.ops_corporate_pdf_layout">
                    <style>
                        * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
                        @page { size: A4; margin: 15mm 12mm 25mm 12mm; }
                        .num { text-align: right; font-family: Consolas, Monaco, 'Courier New', monospace; }
                        .val-zero { color: #bbbbbb; }
                        .page-footer-fixed { position: fixed; bottom: 0; left: 0; right: 0; padding: 6px 0 0 0; border-top: 1px solid #e2e8f0; }
                    </style>

                    <div class="page ops-report" t-attf-style="color: {{body_text_color}}; font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, Helvetica, sans-serif; font-size: 8.5pt; line-height: 1.45;">

                        <!-- HEADER -->
                        <table width="100%" style="border-collapse: collapse; margin-bottom: 15px;" t-attf-style="border-bottom: 2px solid {{pc}}; padding-bottom: 10px;">
                            <tr>
                                <td style="vertical-align: middle; width: 60%;">
                                    <table style="border-collapse: collapse;"><tr>
                                        <t t-if="company.logo">
                                            <td style="vertical-align: middle; padding-right: 12px;"><img t-att-src="image_data_uri(company.logo)" style="max-height: 45px; max-width: 100px; border-radius: 6px; object-fit: contain;" alt="Company Logo"/></td>
                                        </t>
                                        <t t-else="">
                                            <td style="vertical-align: middle; padding-right: 12px;"><div t-attf-style="width: 45px; height: 45px; border-radius: 6px; background: {{pc}}; color: {{tc}}; font-weight: 700; font-size: 14pt; text-align: center; line-height: 45px;"><t t-esc="(company.name or 'CO')[:2].upper()"/></div></td>
                                        </t>
                                        <td style="vertical-align: middle;">
                                            <div style="font-size: 14pt; font-weight: 700; color: #1e293b; line-height: 1.2;"><t t-esc="company.name"/></div>
                                            <div style="font-size: 8.5pt; color: #666666; margin-top: 1px;"><t t-if="company.city"><t t-esc="company.city"/></t><t t-if="company.city and company.country_id">, </t><t t-esc="company.country_id.name or ''"/></div>
                                        </td>
                                    </tr></table>
                                </td>
                                <td style="vertical-align: top; width: 40%; text-align: right;">
                                    <div style="font-size: 8pt; color: #666666; line-height: 1.6;">Printed: <t t-esc="context_timestamp(datetime.datetime.now()).strftime('%d %b %Y %H:%M')"/><br/>Generated by: <t t-esc="user.name"/></div>
                                    <div style="font-family: 'Courier New', monospace; font-size: 7pt; color: #94a3b8; letter-spacing: 0.3px; margin-top: 2px;">Report ID: <t t-esc="report_run_id"/></div>
                                </td>
                            </tr>
                        </table>

                        <!-- TITLE BLOCK -->
                        <div style="margin: 8px 0 4px 0;">
                            <div style="font-size: 16pt; font-weight: 700; color: #1e293b; margin-bottom: 4px;">PDCs in Hand</div>
                            <div style="font-size: 8.5pt; color: #666666;">
                                As of <t t-esc="as_of_date"/>
                                <span style="color: #94a3b8;"> | </span><t t-esc="currency_name"/>
                                <span style="color: #94a3b8;"> | </span><t t-esc="totals.get('total_count', (rd.get('inbound', {}).get('count', 0) + rd.get('outbound', {}).get('count', 0)))"/> checks
                            </div>
                        </div>

                        <!-- SUMMARY ROW -->
                        <table width="100%" style="border-collapse: collapse; margin: 12px 0 22px 0; border-radius: 4px;" t-attf-style="background: {{pl}};">
                            <tr>
                                <td style="padding: 12px 16px; vertical-align: top; width: 33%;">
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Receivable in Hand</div>
                                    <div style="font-size: 13pt; font-weight: 700; color: #0891b2; font-family: Consolas, Monaco, monospace;"><t t-esc="'{:,.2f}'.format(rd.get('inbound', {}).get('total', totals.get('inbound_total', 0)))"/></div>
                                    <div style="font-size: 7pt; color: #94a3b8; margin-top: 2px;"><t t-esc="rd.get('inbound', {}).get('count', 0)"/> checks</div>
                                </td>
                                <td style="padding: 12px 16px; vertical-align: top; width: 33%;">
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Payable in Hand</div>
                                    <div style="font-size: 13pt; font-weight: 700; color: #f59e0b; font-family: Consolas, Monaco, monospace;"><t t-esc="'{:,.2f}'.format(rd.get('outbound', {}).get('total', totals.get('outbound_total', 0)))"/></div>
                                    <div style="font-size: 7pt; color: #94a3b8; margin-top: 2px;"><t t-esc="rd.get('outbound', {}).get('count', 0)"/> checks</div>
                                </td>
                                <td style="padding: 12px 16px; vertical-align: top; width: 34%;">
                                    <t t-set="net_pos" t-value="totals.get('net_position', 0)"/>
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Net Position</div>
                                    <div t-att-style="'font-size: 13pt; font-weight: 700; font-family: Consolas, Monaco, monospace; color: ' + (net_pos >= 0 and '#16a34a' or '#dc2626') + ';'">
                                        <t t-if="net_pos &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(net_pos))"/>)</t>
                                        <t t-else=""><t t-esc="'{:,.2f}'.format(net_pos)"/></t>
                                    </div>
                                </td>
                            </tr>
                        </table>

                        <!-- INBOUND IN HAND SECTION -->
                        <t t-if="rd.get('pdc_type') in ('inbound', 'both') and rd.get('inbound', {}).get('data')">
                            <table width="100%" style="border-collapse: collapse; margin-bottom: 0;" t-attf-style="margin-top: 8px; background: {{pl}}; border-left: 3px solid {{pc}};">
                                <tr>
                                    <td style="padding: 7px 12px;" t-attf-style="font-weight: 600; font-size: 9pt; color: {{pd}};">RECEIVABLE PDCs IN HAND</td>
                                    <td class="num" style="padding: 7px 12px; font-size: 8pt; color: #94a3b8;"><t t-esc="rd.get('inbound', {}).get('count', 0)"/> items</td>
                                </tr>
                            </table>
                            <table width="100%" style="border-collapse: collapse; font-size: 8pt; margin-bottom: 12px;">
                                <thead><tr>
                                    <th style="width: 12%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Reference</th>
                                    <th style="width: 18%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Customer</th>
                                    <th style="width: 10%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Check #</th>
                                    <th style="width: 14%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Bank</th>
                                    <th style="width: 11%; padding: 7px 8px; text-align: center; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Maturity</th>
                                    <th class="num" style="width: 16%; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Amount (<t t-esc="currency_name"/>)</th>
                                    <th style="width: 9%; padding: 7px 8px; text-align: center; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Status</th>
                                </tr></thead>
                                <tbody>
                                    <t t-foreach="rd.get('inbound', {}).get('data', [])" t-as="pdc">
                                        <tr t-att-style="'border-bottom: 1px solid #f1f5f9;' + (' background: #f8fafc;' if pdc_even else '')">
                                            <td style="padding: 5px 8px; font-weight: 500;"><t t-esc="pdc.get('name', '-')"/></td>
                                            <td style="padding: 5px 8px;"><t t-esc="pdc.get('partner_name', '-')"/></td>
                                            <td style="padding: 5px 8px; color: #64748b;"><t t-esc="pdc.get('check_number', '-')"/></td>
                                            <td style="padding: 5px 8px; color: #64748b;"><t t-esc="pdc.get('bank_name', '-')"/></td>
                                            <td style="padding: 5px 8px; text-align: center; color: #64748b; white-space: nowrap;"><t t-esc="pdc.get('maturity_date', '-')"/></td>
                                            <td class="num" style="padding: 5px 8px; color: #0891b2; font-weight: 600;"><t t-esc="'{:,.2f}'.format(pdc.get('amount', 0))"/></td>
                                            <td style="padding: 5px 8px; text-align: center;">
                                                <t t-set="st" t-value="pdc.get('state', 'draft')"/>
                                                <span t-attf-style="display: inline-block; padding: 2px 6px; border-radius: 3px; font-size: 6.5pt; font-weight: 600; color: #fff; background: #{st == 'deposited' and '#2563eb' or '#16a34a'};"><t t-esc="pdc.get('state_label', st)"/></span>
                                            </td>
                                        </tr>
                                    </t>
                                </tbody>
                                <tfoot><tr t-attf-style="font-weight: 600; background: {{pl}};">
                                    <td colspan="5" t-attf-style="padding: 7px 8px; font-size: 8pt; color: {{pd}};">Subtotal Receivable</td>
                                    <td class="num" t-attf-style="padding: 7px 8px; font-size: 8pt; color: {{pd}};"><t t-esc="'{:,.2f}'.format(rd.get('inbound', {}).get('total', 0))"/></td>
                                    <td></td>
                                </tr></tfoot>
                            </table>
                        </t>

                        <!-- OUTBOUND IN HAND SECTION -->
                        <t t-if="rd.get('pdc_type') in ('outbound', 'both') and rd.get('outbound', {}).get('data')">
                            <table width="100%" style="border-collapse: collapse; margin-bottom: 0;" t-attf-style="margin-top: 8px; background: {{pl}}; border-left: 3px solid {{pc}};">
                                <tr>
                                    <td style="padding: 7px 12px;" t-attf-style="font-weight: 600; font-size: 9pt; color: {{pd}};">PAYABLE PDCs IN HAND</td>
                                    <td class="num" style="padding: 7px 12px; font-size: 8pt; color: #94a3b8;"><t t-esc="rd.get('outbound', {}).get('count', 0)"/> items</td>
                                </tr>
                            </table>
                            <table width="100%" style="border-collapse: collapse; font-size: 8pt; margin-bottom: 12px;">
                                <thead><tr>
                                    <th style="width: 12%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Reference</th>
                                    <th style="width: 18%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Vendor</th>
                                    <th style="width: 10%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Check #</th>
                                    <th style="width: 14%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Bank</th>
                                    <th style="width: 11%; padding: 7px 8px; text-align: center; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Maturity</th>
                                    <th class="num" style="width: 16%; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Amount (<t t-esc="currency_name"/>)</th>
                                    <th style="width: 9%; padding: 7px 8px; text-align: center; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; border-bottom: 2px solid #1e293b; background: #f8fafc;">Status</th>
                                </tr></thead>
                                <tbody>
                                    <t t-foreach="rd.get('outbound', {}).get('data', [])" t-as="pdc">
                                        <tr t-att-style="'border-bottom: 1px solid #f1f5f9;' + (' background: #f8fafc;' if pdc_even else '')">
                                            <td style="padding: 5px 8px; font-weight: 500;"><t t-esc="pdc.get('name', '-')"/></td>
                                            <td style="padding: 5px 8px;"><t t-esc="pdc.get('partner_name', '-')"/></td>
                                            <td style="padding: 5px 8px; color: #64748b;"><t t-esc="pdc.get('check_number', '-')"/></td>
                                            <td style="padding: 5px 8px; color: #64748b;"><t t-esc="pdc.get('bank_name', '-')"/></td>
                                            <td style="padding: 5px 8px; text-align: center; color: #64748b; white-space: nowrap;"><t t-esc="pdc.get('maturity_date', '-')"/></td>
                                            <td class="num" style="padding: 5px 8px; color: #f59e0b; font-weight: 600;"><t t-esc="'{:,.2f}'.format(pdc.get('amount', 0))"/></td>
                                            <td style="padding: 5px 8px; text-align: center;">
                                                <t t-set="st" t-value="pdc.get('state', 'draft')"/>
                                                <span t-attf-style="display: inline-block; padding: 2px 6px; border-radius: 3px; font-size: 6.5pt; font-weight: 600; color: #fff; background: #{st == 'issued' and '#d97706' or '#94a3b8'};"><t t-esc="pdc.get('state_label', st)"/></span>
                                            </td>
                                        </tr>
                                    </t>
                                </tbody>
                                <tfoot><tr t-attf-style="font-weight: 600; background: {{pl}};">
                                    <td colspan="5" t-attf-style="padding: 7px 8px; font-size: 8pt; color: {{pd}};">Subtotal Payable</td>
                                    <td class="num" t-attf-style="padding: 7px 8px; font-size: 8pt; color: {{pd}};"><t t-esc="'{:,.2f}'.format(rd.get('outbound', {}).get('total', 0))"/></td>
                                    <td></td>
                                </tr></tfoot>
                            </table>
                        </t>

                        <!-- EMPTY STATE -->
                        <t t-if="not rd.get('inbound', {}).get('data') and not rd.get('outbound', {}).get('data')">
                            <div style="padding: 30px; text-align: center; color: #94a3b8; font-style: italic; border: 1px dashed #e2e8f0; border-radius: 4px; margin: 12px 0;">No open PDCs found matching the criteria</div>
                        </t>

                        <!-- GRAND TOTAL BAR -->
                        <t t-set="net_pos" t-value="totals.get('net_position', 0)"/>
                        <div t-attf-style="margin-top: 8px; border-radius: 4px; overflow: hidden; background: {{pc}}; color: {{tc}}; page-break-inside: avoid;">
                            <table width="100%" style="border-collapse: collapse;">
                                <tr>
                                    <td style="width: 40%; padding: 13px 14px; font-weight: 600; font-size: 9pt; text-transform: uppercase; letter-spacing: 0.3px; border: none;">NET POSITION</td>
                                    <td class="num" style="width: 20%; padding: 13px 8px; font-size: 8pt; border: none;">In: <t t-esc="'{:,.0f}'.format(totals.get('inbound_total', 0))"/></td>
                                    <td class="num" style="width: 20%; padding: 13px 8px; font-size: 8pt; border: none;">Out: <t t-esc="'{:,.0f}'.format(totals.get('outbound_total', 0))"/></td>
                                    <td class="num" style="width: 20%; padding: 13px 8px; font-weight: 700; font-size: 10pt; border: none;">
                                        <t t-if="net_pos &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(net_pos))"/>)</t>
                                        <t t-else=""><t t-esc="'{:,.2f}'.format(net_pos)"/></t>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <!-- SIGNATURE BLOCK -->
                        <div style="margin-top: 28px; page-break-inside: avoid;">
                            <table width="100%" style="border-collapse: collapse; border: none;"><tr style="border: none;">
                                <td style="border: none; width: 33%; padding: 0 16px 0 0;"><div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">Prepared by</div><div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">Name / Date</div></td>
                                <td style="border: none; width: 33%; padding: 0 16px; border-left: 1px solid #e2e8f0;"><div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">Reviewed by</div><div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">Name / Date</div></td>
                                <td style="border: none; width: 33%; padding: 0 0 0 16px; border-left: 1px solid #e2e8f0;"><div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">Approved by</div><div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">Name / Date</div></td>
                            </tr></table>
                        </div>

                        <!-- FIXED FOOTER -->
                        <div class="page-footer-fixed" style="position: fixed; bottom: 0; left: 0; right: 0; padding: 6px 0 0 0; border-top: 1px solid #e2e8f0;">
                            <table style="width: 100%; border-collapse: collapse;"><tr>
                                <td style="width: 50%; text-align: left; vertical-align: middle; padding: 4px 0;"><span style="font-size: 8pt; color: #666666;">Powered by</span><img src="/ops_matrix_accounting/static/src/img/ops_badge_footer.png" style="height: 16px; vertical-align: middle; margin-left: 4px;" alt="OPS Framework"/></td>
                                <td style="width: 50%; text-align: right; vertical-align: middle; padding: 4px 0;"><span style="font-size: 6.5pt; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.5px;">Confidential &#x2014; For authorized personnel only</span></td>
                            </tr></table>
                        </div>

                    </div>
                </t>
            </t>
        </t>
    </template>

</odoo>
