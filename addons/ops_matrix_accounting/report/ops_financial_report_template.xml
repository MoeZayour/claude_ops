<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!--
        ================================================================
        OPS CORPORATE FINANCIAL REPORT TEMPLATES
        ================================================================
        GL Gold Standard Pattern - wkhtmltopdf-compatible:
        NO flexbox, NO font-variant-numeric, NO external CSS dependency.
        All layouts use tables/inline-block for QtWebKit ~534.

        Templates: Trial Balance, Profit &amp; Loss, Cash Flow,
                   Aged Partner Balance, Balance Sheet
        Colors: Dynamic from company.ops_report_primary_color
        Parser: ops_financial_report_parser.py (injects corporate vars)
    -->

    <!-- ================================================================
         REPORT ACTIONS
         ================================================================ -->

    <record id="action_report_trial_balance_corporate" model="ir.actions.report">
        <field name="name">OPS Trial Balance Report</field>
        <field name="model">ops.general.ledger.wizard.enhanced</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">ops_matrix_accounting.report_trial_balance_corporate</field>
        <field name="report_file">ops_matrix_accounting.report_trial_balance_corporate</field>
        <field name="binding_model_id" ref="model_ops_general_ledger_wizard_enhanced"/>
        <field name="print_report_name">'Trial_Balance_%s_%s' % (object.date_from, object.date_to)</field>
        <field name="binding_type">report</field>
        <field name="paperformat_id" ref="ops_matrix_accounting.paperformat_ops_corporate_a4"/>
    </record>

    <record id="action_report_profit_loss_corporate" model="ir.actions.report">
        <field name="name">OPS Profit &amp; Loss Statement</field>
        <field name="model">ops.general.ledger.wizard.enhanced</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">ops_matrix_accounting.report_profit_loss_corporate</field>
        <field name="report_file">ops_matrix_accounting.report_profit_loss_corporate</field>
        <field name="binding_model_id" ref="model_ops_general_ledger_wizard_enhanced"/>
        <field name="print_report_name">'Profit_Loss_%s_%s' % (object.date_from, object.date_to)</field>
        <field name="binding_type">report</field>
        <field name="paperformat_id" ref="ops_matrix_accounting.paperformat_ops_corporate_a4"/>
    </record>

    <record id="action_report_cash_flow_corporate" model="ir.actions.report">
        <field name="name">OPS Cash Flow Statement</field>
        <field name="model">ops.general.ledger.wizard.enhanced</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">ops_matrix_accounting.report_cash_flow_corporate</field>
        <field name="report_file">ops_matrix_accounting.report_cash_flow_corporate</field>
        <field name="binding_model_id" ref="model_ops_general_ledger_wizard_enhanced"/>
        <field name="print_report_name">'Cash_Flow_%s_%s' % (object.date_from, object.date_to)</field>
        <field name="binding_type">report</field>
        <field name="paperformat_id" ref="ops_matrix_accounting.paperformat_ops_corporate_a4"/>
    </record>

    <record id="action_report_aged_partner_corporate" model="ir.actions.report">
        <field name="name">OPS Aged Partner Balance</field>
        <field name="model">ops.general.ledger.wizard.enhanced</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">ops_matrix_accounting.report_aged_partner_corporate</field>
        <field name="report_file">ops_matrix_accounting.report_aged_partner_corporate</field>
        <field name="binding_model_id" ref="model_ops_general_ledger_wizard_enhanced"/>
        <field name="print_report_name">'Aged_Partner_%s_%s' % (object.date_from, object.date_to)</field>
        <field name="binding_type">report</field>
        <field name="paperformat_id" ref="ops_matrix_accounting.paperformat_ops_corporate_landscape"/>
    </record>

    <record id="action_report_balance_sheet_corporate" model="ir.actions.report">
        <field name="name">OPS Balance Sheet</field>
        <field name="model">ops.general.ledger.wizard.enhanced</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">ops_matrix_accounting.report_balance_sheet_corporate</field>
        <field name="report_file">ops_matrix_accounting.report_balance_sheet_corporate</field>
        <field name="binding_model_id" ref="model_ops_general_ledger_wizard_enhanced"/>
        <field name="print_report_name">'Balance_Sheet_%s' % (object.as_of_date or object.date_to)</field>
        <field name="binding_type">report</field>
        <field name="paperformat_id" ref="ops_matrix_accounting.paperformat_ops_corporate_a4"/>
    </record>

    <!-- ================================================================
         TRIAL BALANCE CORPORATE TEMPLATE
         ================================================================ -->

    <template id="report_trial_balance_corporate">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-set="company" t-value="doc.company_id or env.company"/>
                <t t-set="pc" t-value="primary_color"/>
                <t t-set="tc" t-value="text_on_primary"/>
                <t t-set="pl" t-value="primary_light"/>
                <t t-set="pd" t-value="primary_dark"/>

                <t t-call="ops_matrix_accounting.ops_corporate_pdf_layout">
                    <style>
                        * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
                        @page { size: A4; margin: 15mm 12mm 25mm 12mm; }
                        .num { text-align: right; font-family: Consolas, Monaco, 'Courier New', monospace; }
                        .val-negative { color: #dc2626; }
                        .val-zero { color: #bbbbbb; }
                        .page-footer-fixed { position: fixed; bottom: 0; left: 0; right: 0; padding: 6px 0 0 0; border-top: 1px solid #e2e8f0; }
                    </style>

                    <div class="page ops-report" t-attf-style="color: {{body_text_color}}; font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, Helvetica, sans-serif; font-size: 8.5pt; line-height: 1.45;">

                        <!-- HEADER -->
                        <table width="100%" style="border-collapse: collapse; margin-bottom: 15px;" t-attf-style="border-bottom: 2px solid {{pc}}; padding-bottom: 10px;">
                            <tr>
                                <td style="vertical-align: middle; width: 60%;">
                                    <table style="border-collapse: collapse;">
                                        <tr>
                                            <t t-if="company.logo">
                                                <td style="vertical-align: middle; padding-right: 12px;">
                                                    <img t-att-src="image_data_uri(company.logo)" style="max-height: 45px; max-width: 100px; border-radius: 6px; object-fit: contain;" alt="Logo"/>
                                                </td>
                                            </t>
                                            <t t-else="">
                                                <td style="vertical-align: middle; padding-right: 12px;">
                                                    <div t-attf-style="width: 45px; height: 45px; border-radius: 6px; background: {{pc}}; color: {{tc}}; font-weight: 700; font-size: 14pt; text-align: center; line-height: 45px;">
                                                        <t t-esc="(company.name or 'CO')[:2].upper()"/>
                                                    </div>
                                                </td>
                                            </t>
                                            <td style="vertical-align: middle;">
                                                <div style="font-size: 14pt; font-weight: 700; color: #1e293b; line-height: 1.2;"><t t-esc="company.name"/></div>
                                                <div style="font-size: 8.5pt; color: #666666; margin-top: 1px;">
                                                    <t t-if="company.city"><t t-esc="company.city"/></t>
                                                    <t t-if="company.city and company.country_id">, </t>
                                                    <t t-esc="company.country_id.name or ''"/>
                                                </div>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                                <td style="vertical-align: top; width: 40%; text-align: right;">
                                    <div style="font-size: 8pt; color: #666666; line-height: 1.6;">
                                        Printed: <t t-esc="context_timestamp(datetime.datetime.now()).strftime('%d %b %Y %H:%M')"/><br/>
                                        Generated by: <t t-esc="user.name"/>
                                    </div>
                                    <div style="font-family: 'Courier New', monospace; font-size: 7pt; color: #94a3b8; letter-spacing: 0.3px; margin-top: 2px;">
                                        Report ID: <t t-esc="report_run_id"/>
                                    </div>
                                </td>
                            </tr>
                        </table>

                        <!-- TITLE -->
                        <div style="margin: 8px 0 4px 0;">
                            <div style="font-size: 16pt; font-weight: 700; color: #1e293b; margin-bottom: 4px;">Trial Balance</div>
                            <div style="font-size: 8.5pt; color: #666666;">
                                <t t-if="doc.date_from" t-esc="doc.date_from.strftime('%d %b %Y')"/> -
                                <t t-if="doc.date_to" t-esc="doc.date_to.strftime('%d %b %Y')"/>
                                <span style="color: #94a3b8;"> | </span><t t-esc="currency_name"/>
                                <span style="color: #94a3b8;"> | </span>
                                <t t-if="doc.target_move == 'posted'">Posted Entries</t><t t-else="">All Entries</t>
                                <t t-if="doc.branch_ids">
                                    <span style="color: #94a3b8;"> | </span>
                                    <t t-esc="', '.join(doc.branch_ids.mapped('name')[:3])"/>
                                    <t t-if="len(doc.branch_ids) &gt; 3"> (+<t t-esc="len(doc.branch_ids) - 3"/>)</t>
                                </t>
                            </div>
                        </div>

                        <!-- SUMMARY ROW -->
                        <t t-set="total_debit" t-value="report_data.get('total_debit', 0)"/>
                        <t t-set="total_credit" t-value="report_data.get('total_credit', 0)"/>
                        <t t-set="tb_net" t-value="total_debit - total_credit"/>
                        <t t-set="tb_balanced" t-value="abs(tb_net) &lt; 0.01"/>
                        <t t-set="tb_lines" t-value="report_data.get('lines', [])"/>

                        <table width="100%" style="border-collapse: collapse; margin: 12px 0 18px 0;" t-attf-style="background: {{pl}};">
                            <tr>
                                <td style="padding: 12px 16px; width: 25%;">
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Total Debit</div>
                                    <div style="font-size: 13pt; font-weight: 700; color: #1e293b; font-family: Consolas, Monaco, monospace;"><t t-esc="'{:,.2f}'.format(total_debit)"/></div>
                                </td>
                                <td style="padding: 12px 16px; width: 25%;">
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Total Credit</div>
                                    <div style="font-size: 13pt; font-weight: 700; color: #1e293b; font-family: Consolas, Monaco, monospace;"><t t-esc="'{:,.2f}'.format(total_credit)"/></div>
                                </td>
                                <td style="padding: 12px 16px; width: 25%;">
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Net Balance</div>
                                    <div t-att-style="'font-size: 13pt; font-weight: 700; font-family: Consolas, Monaco, monospace;' + (' color: #16a34a;' if tb_balanced else ' color: #1e293b;')">
                                        <t t-if="tb_net &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(tb_net))"/>)</t>
                                        <t t-else=""><t t-esc="'{:,.2f}'.format(tb_net)"/></t>
                                    </div>
                                </td>
                                <td style="padding: 12px 16px; width: 25%;">
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Accounts</div>
                                    <div style="font-size: 13pt; font-weight: 700; color: #1e293b;"><t t-esc="len(tb_lines)"/></div>
                                </td>
                            </tr>
                        </table>

                        <!-- BALANCE CHECK -->
                        <div t-att-style="'border-left: 4px solid; padding: 8px 15px; margin: 0 0 18px 0; font-size: 8.5pt;' + (tb_balanced and ' background: #dcfce7; border-color: #16a34a; color: #166534;' or ' background: #fee2e2; border-color: #dc2626; color: #991b1b;')">
                            <t t-if="tb_balanced">[ok] Trial Balance is Balanced</t>
                            <t t-else="">[!] Out of Balance - Difference: <span style="font-weight: 700; font-family: Consolas, Monaco, monospace;"><t t-esc="'{:,.2f}'.format(abs(tb_net))"/></span></t>
                        </div>

                        <!-- DATA TABLE -->
                        <table width="100%" style="border-collapse: collapse; font-size: 8.5pt; margin-bottom: 18px;">
                            <thead>
                                <tr style="border-bottom: 2px solid #1e293b; background: #f8fafc;">
                                    <th style="text-align: left; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; width: 12%;">Code</th>
                                    <th style="text-align: left; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; width: 43%;">Account Name</th>
                                    <th class="num" style="padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; width: 15%;">Debit (<t t-esc="currency_name"/>)</th>
                                    <th class="num" style="padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; width: 15%;">Credit (<t t-esc="currency_name"/>)</th>
                                    <th class="num" style="padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; width: 15%;">Balance (<t t-esc="currency_name"/>)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="tb_lines" t-as="line">
                                    <t t-set="debit" t-value="line.get('debit', 0)"/>
                                    <t t-set="credit" t-value="line.get('credit', 0)"/>
                                    <t t-set="balance" t-value="line.get('balance', 0)"/>
                                    <tr t-att-style="'border-bottom: 1px solid #f1f5f9;' + (' background: #f8fafc;' if line_even else '')">
                                        <td style="padding: 5px 8px; font-family: Consolas, Monaco, monospace; font-size: 7.5pt; color: #64748b;"><t t-esc="line.get('code', '')"/></td>
                                        <td style="padding: 5px 8px;"><t t-esc="line.get('account', line.get('name', ''))"/></td>
                                        <td class="num" style="padding: 5px 8px;">
                                            <t t-if="debit &gt; 0"><t t-esc="'{:,.2f}'.format(debit)"/></t>
                                            <t t-else=""><span class="val-zero">-</span></t>
                                        </td>
                                        <td class="num" style="padding: 5px 8px;">
                                            <t t-if="credit &gt; 0"><t t-esc="'{:,.2f}'.format(credit)"/></t>
                                            <t t-else=""><span class="val-zero">-</span></t>
                                        </td>
                                        <td class="num" style="padding: 5px 8px; font-weight: 600;">
                                            <t t-if="balance == 0"><span class="val-zero">-</span></t>
                                            <t t-elif="balance &lt; 0"><span class="val-negative">(<t t-esc="'{:,.2f}'.format(abs(balance))"/>)</span></t>
                                            <t t-else=""><t t-esc="'{:,.2f}'.format(balance)"/></t>
                                        </td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>

                        <!-- GRAND TOTAL BAR -->
                        <div style="page-break-inside: avoid;">
                            <table width="100%" t-attf-style="border-collapse: collapse; background: {{pc}};">
                                <tr>
                                    <td t-attf-style="padding: 13px 8px; font-weight: 700; font-size: 10pt; color: {{tc}}; text-transform: uppercase; width: 55%;">Grand Total</td>
                                    <td class="num" t-attf-style="width: 15%; padding: 13px 8px; font-weight: 700; font-size: 10pt; color: {{tc}};"><t t-esc="'{:,.2f}'.format(total_debit)"/></td>
                                    <td class="num" t-attf-style="width: 15%; padding: 13px 8px; font-weight: 700; font-size: 10pt; color: {{tc}};"><t t-esc="'{:,.2f}'.format(total_credit)"/></td>
                                    <td class="num" t-attf-style="width: 15%; padding: 13px 8px; font-weight: 700; font-size: 10pt; color: {{tc}};">
                                        <t t-if="tb_net &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(tb_net))"/>)</t>
                                        <t t-else=""><t t-esc="'{:,.2f}'.format(tb_net)"/></t>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <!-- SIGNATURE BLOCK -->
                        <div style="margin-top: 28px; page-break-inside: avoid;">
                            <table width="100%" style="border-collapse: collapse; border: none;">
                                <tr style="border: none;">
                                    <td style="border: none; width: 33%; padding: 0 16px 0 0;">
                                        <div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">Prepared by</div>
                                        <div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">Name / Date</div>
                                    </td>
                                    <td style="border: none; width: 33%; padding: 0 16px; border-left: 1px solid #e2e8f0;">
                                        <div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">Reviewed by</div>
                                        <div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">Name / Date</div>
                                    </td>
                                    <td style="border: none; width: 33%; padding: 0 0 0 16px; border-left: 1px solid #e2e8f0;">
                                        <div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">Approved by</div>
                                        <div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">Name / Date</div>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <!-- FIXED FOOTER -->
                        <div class="page-footer-fixed">
                            <table style="width: 100%; border-collapse: collapse;">
                                <tr>
                                    <td style="width: 50%; text-align: left; vertical-align: middle; padding: 4px 0;">
                                        <span style="font-size: 8pt; color: #666666;">Powered by</span>
                                        <span style="display: inline-block; background: linear-gradient(135deg, #3b82f6, #1e40af); color: #ffffff; padding: 3px 8px; border-radius: 4px; font-size: 7pt; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; font-family: Arial, Helvetica, sans-serif; vertical-align: middle; margin-left: 4px; -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important;">OPS Framework</span>
                                    </td>
                                    <td style="width: 50%; text-align: right; vertical-align: middle; padding: 4px 0;">
                                        <span style="font-size: 6.5pt; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.5px;">Confidential - For authorized personnel only</span>
                                    </td>
                                </tr>
                            </table>
                        </div>

                    </div>
                </t>
            </t>
        </t>
    </template>

    <!-- ================================================================
         PROFIT &amp; LOSS STATEMENT CORPORATE TEMPLATE
         ================================================================ -->

    <template id="report_profit_loss_corporate">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-set="company" t-value="doc.company_id or env.company"/>
                <t t-set="pc" t-value="primary_color"/>
                <t t-set="tc" t-value="text_on_primary"/>
                <t t-set="pl" t-value="primary_light"/>
                <t t-set="pd" t-value="primary_dark"/>

                <t t-call="ops_matrix_accounting.ops_corporate_pdf_layout">
                    <style>
                        * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
                        @page { size: A4; margin: 15mm 12mm 25mm 12mm; }
                        .num { text-align: right; font-family: Consolas, Monaco, 'Courier New', monospace; }
                        .val-negative { color: #dc2626; }
                        .val-zero { color: #bbbbbb; }
                        .page-footer-fixed { position: fixed; bottom: 0; left: 0; right: 0; padding: 6px 0 0 0; border-top: 1px solid #e2e8f0; }
                    </style>

                    <div class="page ops-report" t-attf-style="color: {{body_text_color}}; font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, Helvetica, sans-serif; font-size: 8.5pt; line-height: 1.45;">

                        <!-- HEADER -->
                        <table width="100%" style="border-collapse: collapse; margin-bottom: 15px;" t-attf-style="border-bottom: 2px solid {{pc}}; padding-bottom: 10px;">
                            <tr>
                                <td style="vertical-align: middle; width: 60%;">
                                    <table style="border-collapse: collapse;">
                                        <tr>
                                            <t t-if="company.logo">
                                                <td style="vertical-align: middle; padding-right: 12px;">
                                                    <img t-att-src="image_data_uri(company.logo)" style="max-height: 45px; max-width: 100px; border-radius: 6px; object-fit: contain;" alt="Logo"/>
                                                </td>
                                            </t>
                                            <t t-else="">
                                                <td style="vertical-align: middle; padding-right: 12px;">
                                                    <div t-attf-style="width: 45px; height: 45px; border-radius: 6px; background: {{pc}}; color: {{tc}}; font-weight: 700; font-size: 14pt; text-align: center; line-height: 45px;">
                                                        <t t-esc="(company.name or 'CO')[:2].upper()"/>
                                                    </div>
                                                </td>
                                            </t>
                                            <td style="vertical-align: middle;">
                                                <div style="font-size: 14pt; font-weight: 700; color: #1e293b; line-height: 1.2;"><t t-esc="company.name"/></div>
                                                <div style="font-size: 8.5pt; color: #666666; margin-top: 1px;">
                                                    <t t-if="company.city"><t t-esc="company.city"/></t>
                                                    <t t-if="company.city and company.country_id">, </t>
                                                    <t t-esc="company.country_id.name or ''"/>
                                                </div>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                                <td style="vertical-align: top; width: 40%; text-align: right;">
                                    <div style="font-size: 8pt; color: #666666; line-height: 1.6;">
                                        Printed: <t t-esc="context_timestamp(datetime.datetime.now()).strftime('%d %b %Y %H:%M')"/><br/>
                                        Generated by: <t t-esc="user.name"/>
                                    </div>
                                    <div style="font-family: 'Courier New', monospace; font-size: 7pt; color: #94a3b8; letter-spacing: 0.3px; margin-top: 2px;">
                                        Report ID: <t t-esc="report_run_id"/>
                                    </div>
                                </td>
                            </tr>
                        </table>

                        <!-- TITLE -->
                        <div style="margin: 8px 0 4px 0;">
                            <div style="font-size: 16pt; font-weight: 700; color: #1e293b; margin-bottom: 4px;">Profit &amp; Loss Statement</div>
                            <div style="font-size: 8.5pt; color: #666666;">
                                <t t-if="doc.date_from" t-esc="doc.date_from.strftime('%d %b %Y')"/> -
                                <t t-if="doc.date_to" t-esc="doc.date_to.strftime('%d %b %Y')"/>
                                <span style="color: #94a3b8;"> | </span><t t-esc="currency_name"/>
                                <span style="color: #94a3b8;"> | </span>
                                <t t-if="doc.target_move == 'posted'">Posted Entries</t><t t-else="">All Entries</t>
                            </div>
                        </div>

                        <!-- CALCULATE TOTALS -->
                        <t t-set="income" t-value="report_data.get('income_total', 0)"/>
                        <t t-set="expense" t-value="report_data.get('expense_total', 0)"/>
                        <t t-set="net" t-value="report_data.get('net_profit', income - expense)"/>
                        <t t-set="margin" t-value="(net / income * 100) if income else 0"/>

                        <!-- SUMMARY ROW -->
                        <table width="100%" style="border-collapse: collapse; margin: 12px 0 18px 0;" t-attf-style="background: {{pl}};">
                            <tr>
                                <td style="padding: 12px 16px; width: 25%;">
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Revenue</div>
                                    <div style="font-size: 13pt; font-weight: 700; color: #16a34a; font-family: Consolas, Monaco, monospace;"><t t-esc="'{:,.2f}'.format(income)"/></div>
                                </td>
                                <td style="padding: 12px 16px; width: 25%;">
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Expenses</div>
                                    <div style="font-size: 13pt; font-weight: 700; color: #dc2626; font-family: Consolas, Monaco, monospace;"><t t-esc="'{:,.2f}'.format(expense)"/></div>
                                </td>
                                <td style="padding: 12px 16px; width: 25%;">
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Net Profit</div>
                                    <div t-att-style="'font-size: 13pt; font-weight: 700; font-family: Consolas, Monaco, monospace; color: ' + (net >= 0 and '#16a34a' or '#dc2626') + ';'">
                                        <t t-if="net &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(net))"/>)</t>
                                        <t t-else=""><t t-esc="'{:,.2f}'.format(net)"/></t>
                                    </div>
                                </td>
                                <td style="padding: 12px 16px; width: 25%;">
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Margin</div>
                                    <div t-att-style="'font-size: 13pt; font-weight: 700; color: ' + (margin >= 10 and '#16a34a' or margin >= 0 and '#f59e0b' or '#dc2626') + ';'">
                                        <t t-esc="'{:.1f}'.format(margin)"/>%
                                    </div>
                                </td>
                            </tr>
                        </table>

                        <!-- REVENUE SECTION -->
                        <div t-attf-style="background: {{pc}}; color: {{tc}}; padding: 8px 15px; margin: 12px 0 0 0; font-size: 10pt; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px;">
                            <table width="100%" style="border-collapse: collapse;">
                                <tr>
                                    <td t-attf-style="color: {{tc}};">REVENUE</td>
                                    <td class="num" t-attf-style="color: {{tc}}; font-family: Consolas, Monaco, monospace;"><t t-esc="'{:,.2f}'.format(income)"/></td>
                                </tr>
                            </table>
                        </div>
                        <table width="100%" style="border-collapse: collapse; font-size: 8.5pt; margin-bottom: 8px;">
                            <thead>
                                <tr style="border-bottom: 2px solid #1e293b; background: #f8fafc;">
                                    <th style="text-align: left; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666;">Account</th>
                                    <th class="num" style="padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 20%;">Amount (<t t-esc="currency_name"/>)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="report_data.get('income_lines', [])" t-as="line">
                                    <t t-set="amt" t-value="line.get('amount', line.get('balance', 0))"/>
                                    <t t-set="level" t-value="line.get('level', 0)"/>
                                    <tr style="border-bottom: 1px solid #f1f5f9;">
                                        <td t-att-style="'padding: 5px 8px; padding-left: ' + str(8 + level * 12) + 'px;'"><t t-esc="line.get('account', line.get('name', ''))"/></td>
                                        <td class="num" style="padding: 5px 8px;">
                                            <t t-if="amt == 0"><span class="val-zero">-</span></t>
                                            <t t-elif="amt &lt; 0"><span class="val-negative">(<t t-esc="'{:,.2f}'.format(abs(amt))"/>)</span></t>
                                            <t t-else=""><t t-esc="'{:,.2f}'.format(amt)"/></t>
                                        </td>
                                    </tr>
                                </t>
                                <tr t-attf-style="border-top: 2px solid #1e293b; background: {{pl}};">
                                    <td style="padding: 8px; font-weight: 700; text-transform: uppercase; font-size: 9pt;">Total Revenue</td>
                                    <td class="num" style="padding: 8px; font-weight: 700; font-size: 9pt; color: #16a34a;"><t t-esc="'{:,.2f}'.format(income)"/></td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- EXPENSES SECTION -->
                        <div t-attf-style="background: {{pc}}; color: {{tc}}; padding: 8px 15px; margin: 12px 0 0 0; font-size: 10pt; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px;">
                            <table width="100%" style="border-collapse: collapse;">
                                <tr>
                                    <td t-attf-style="color: {{tc}};">EXPENSES</td>
                                    <td class="num" t-attf-style="color: {{tc}}; font-family: Consolas, Monaco, monospace;"><t t-esc="'{:,.2f}'.format(expense)"/></td>
                                </tr>
                            </table>
                        </div>
                        <table width="100%" style="border-collapse: collapse; font-size: 8.5pt; margin-bottom: 8px;">
                            <thead>
                                <tr style="border-bottom: 2px solid #1e293b; background: #f8fafc;">
                                    <th style="text-align: left; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666;">Account</th>
                                    <th class="num" style="padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 20%;">Amount (<t t-esc="currency_name"/>)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="report_data.get('expense_lines', [])" t-as="line">
                                    <t t-set="amt" t-value="line.get('amount', line.get('balance', 0))"/>
                                    <t t-set="level" t-value="line.get('level', 0)"/>
                                    <tr style="border-bottom: 1px solid #f1f5f9;">
                                        <td t-att-style="'padding: 5px 8px; padding-left: ' + str(8 + level * 12) + 'px;'"><t t-esc="line.get('account', line.get('name', ''))"/></td>
                                        <td class="num" style="padding: 5px 8px;">
                                            <t t-if="amt == 0"><span class="val-zero">-</span></t>
                                            <t t-elif="amt &lt; 0"><span class="val-negative">(<t t-esc="'{:,.2f}'.format(abs(amt))"/>)</span></t>
                                            <t t-else=""><t t-esc="'{:,.2f}'.format(amt)"/></t>
                                        </td>
                                    </tr>
                                </t>
                                <tr t-attf-style="border-top: 2px solid #1e293b; background: {{pl}};">
                                    <td style="padding: 8px; font-weight: 700; text-transform: uppercase; font-size: 9pt;">Total Expenses</td>
                                    <td class="num" style="padding: 8px; font-weight: 700; font-size: 9pt; color: #dc2626;"><t t-esc="'{:,.2f}'.format(expense)"/></td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- NET PROFIT GRAND TOTAL -->
                        <div style="page-break-inside: avoid; margin-top: 18px;">
                            <table width="100%" t-attf-style="border-collapse: collapse; background: {{pc}};">
                                <tr>
                                    <td style="padding: 15px; width: 60%;">
                                        <div t-attf-style="font-size: 11pt; font-weight: 700; color: {{tc}}; text-transform: uppercase;">Net Profit / (Loss)</div>
                                        <div t-attf-style="font-size: 7.5pt; color: {{tc}}; opacity: 0.8; margin-top: 2px;">Revenue - Expenses</div>
                                    </td>
                                    <td class="num" style="padding: 15px; width: 40%;">
                                        <div t-attf-style="font-family: Consolas, Monaco, monospace; font-size: 16pt; font-weight: 700; color: {{tc}};">
                                            <t t-if="net &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(net))"/>)</t>
                                            <t t-else=""><t t-esc="'{:,.2f}'.format(net)"/></t>
                                        </div>
                                        <div t-attf-style="font-size: 9pt; font-weight: 600; color: {{tc}}; opacity: 0.8; margin-top: 2px;">
                                            Margin: <t t-esc="'{:.1f}'.format(margin)"/>%
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <!-- SIGNATURE BLOCK -->
                        <div style="margin-top: 28px; page-break-inside: avoid;">
                            <table width="100%" style="border-collapse: collapse; border: none;">
                                <tr style="border: none;">
                                    <td style="border: none; width: 33%; padding: 0 16px 0 0;">
                                        <div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">Prepared by</div>
                                        <div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">Name / Date</div>
                                    </td>
                                    <td style="border: none; width: 33%; padding: 0 16px; border-left: 1px solid #e2e8f0;">
                                        <div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">Reviewed by</div>
                                        <div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">Name / Date</div>
                                    </td>
                                    <td style="border: none; width: 33%; padding: 0 0 0 16px; border-left: 1px solid #e2e8f0;">
                                        <div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">Approved by</div>
                                        <div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">Name / Date</div>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <!-- FIXED FOOTER -->
                        <div class="page-footer-fixed">
                            <table style="width: 100%; border-collapse: collapse;">
                                <tr>
                                    <td style="width: 50%; text-align: left; vertical-align: middle; padding: 4px 0;">
                                        <span style="font-size: 8pt; color: #666666;">Powered by</span>
                                        <span style="display: inline-block; background: linear-gradient(135deg, #3b82f6, #1e40af); color: #ffffff; padding: 3px 8px; border-radius: 4px; font-size: 7pt; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; font-family: Arial, Helvetica, sans-serif; vertical-align: middle; margin-left: 4px; -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important;">OPS Framework</span>
                                    </td>
                                    <td style="width: 50%; text-align: right; vertical-align: middle; padding: 4px 0;">
                                        <span style="font-size: 6.5pt; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.5px;">Confidential - For authorized personnel only</span>
                                    </td>
                                </tr>
                            </table>
                        </div>

                    </div>
                </t>
            </t>
        </t>
    </template>

    <!-- ================================================================
         CASH FLOW STATEMENT CORPORATE TEMPLATE
         ================================================================ -->

    <template id="report_cash_flow_corporate">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-set="company" t-value="doc.company_id or env.company"/>
                <t t-set="pc" t-value="primary_color"/>
                <t t-set="tc" t-value="text_on_primary"/>
                <t t-set="pl" t-value="primary_light"/>
                <t t-set="pd" t-value="primary_dark"/>

                <t t-call="ops_matrix_accounting.ops_corporate_pdf_layout">
                    <style>
                        * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
                        @page { size: A4; margin: 15mm 12mm 25mm 12mm; }
                        .num { text-align: right; font-family: Consolas, Monaco, 'Courier New', monospace; }
                        .val-negative { color: #dc2626; }
                        .val-zero { color: #bbbbbb; }
                        .page-footer-fixed { position: fixed; bottom: 0; left: 0; right: 0; padding: 6px 0 0 0; border-top: 1px solid #e2e8f0; }
                    </style>

                    <div class="page ops-report" t-attf-style="color: {{body_text_color}}; font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, Helvetica, sans-serif; font-size: 8.5pt; line-height: 1.45;">

                        <!-- HEADER -->
                        <table width="100%" style="border-collapse: collapse; margin-bottom: 15px;" t-attf-style="border-bottom: 2px solid {{pc}}; padding-bottom: 10px;">
                            <tr>
                                <td style="vertical-align: middle; width: 60%;">
                                    <table style="border-collapse: collapse;">
                                        <tr>
                                            <t t-if="company.logo">
                                                <td style="vertical-align: middle; padding-right: 12px;">
                                                    <img t-att-src="image_data_uri(company.logo)" style="max-height: 45px; max-width: 100px; border-radius: 6px; object-fit: contain;" alt="Logo"/>
                                                </td>
                                            </t>
                                            <t t-else="">
                                                <td style="vertical-align: middle; padding-right: 12px;">
                                                    <div t-attf-style="width: 45px; height: 45px; border-radius: 6px; background: {{pc}}; color: {{tc}}; font-weight: 700; font-size: 14pt; text-align: center; line-height: 45px;">
                                                        <t t-esc="(company.name or 'CO')[:2].upper()"/>
                                                    </div>
                                                </td>
                                            </t>
                                            <td style="vertical-align: middle;">
                                                <div style="font-size: 14pt; font-weight: 700; color: #1e293b; line-height: 1.2;"><t t-esc="company.name"/></div>
                                                <div style="font-size: 8.5pt; color: #666666; margin-top: 1px;">
                                                    <t t-if="company.city"><t t-esc="company.city"/></t>
                                                    <t t-if="company.city and company.country_id">, </t>
                                                    <t t-esc="company.country_id.name or ''"/>
                                                </div>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                                <td style="vertical-align: top; width: 40%; text-align: right;">
                                    <div style="font-size: 8pt; color: #666666; line-height: 1.6;">
                                        Printed: <t t-esc="context_timestamp(datetime.datetime.now()).strftime('%d %b %Y %H:%M')"/><br/>
                                        Generated by: <t t-esc="user.name"/>
                                    </div>
                                    <div style="font-family: 'Courier New', monospace; font-size: 7pt; color: #94a3b8; letter-spacing: 0.3px; margin-top: 2px;">
                                        Report ID: <t t-esc="report_run_id"/>
                                    </div>
                                </td>
                            </tr>
                        </table>

                        <!-- TITLE -->
                        <div style="margin: 8px 0 4px 0;">
                            <div style="font-size: 16pt; font-weight: 700; color: #1e293b; margin-bottom: 4px;">Cash Flow Statement</div>
                            <div style="font-size: 8.5pt; color: #666666;">
                                <t t-if="doc.date_from" t-esc="doc.date_from.strftime('%d %b %Y')"/> -
                                <t t-if="doc.date_to" t-esc="doc.date_to.strftime('%d %b %Y')"/>
                                <span style="color: #94a3b8;"> | </span><t t-esc="currency_name"/>
                                <span style="color: #94a3b8;"> | </span>
                                <t t-if="doc.target_move == 'posted'">Posted Entries</t><t t-else="">All Entries</t>
                            </div>
                        </div>

                        <!-- CALCULATE TOTALS -->
                        <t t-set="operating_net" t-value="report_data.get('operating_net', 0)"/>
                        <t t-set="investing_net" t-value="report_data.get('investing_net', 0)"/>
                        <t t-set="financing_net" t-value="report_data.get('financing_net', 0)"/>
                        <t t-set="net_cf" t-value="report_data.get('net_cash_flow', operating_net + investing_net + financing_net)"/>
                        <t t-set="opening_cash" t-value="report_data.get('opening_cash', 0)"/>
                        <t t-set="closing_cash" t-value="report_data.get('closing_cash', opening_cash + net_cf)"/>

                        <!-- SUMMARY KPIs -->
                        <table width="100%" style="border-collapse: collapse; margin: 12px 0 18px 0;">
                            <tr>
                                <td style="padding: 4px; width: 25%;">
                                    <div style="background: #dbeafe; border-left: 4px solid #0891b2; padding: 10px 12px;">
                                        <div style="font-size: 7pt; font-weight: 600; color: #475569; text-transform: uppercase;">Operating</div>
                                        <div t-att-style="'font-family: Consolas, Monaco, monospace; font-size: 12pt; font-weight: 700; margin-top: 3px; color: ' + (operating_net >= 0 and '#0891b2' or '#dc2626') + ';'">
                                            <t t-if="operating_net &lt; 0">(<t t-esc="'{:,.0f}'.format(abs(operating_net))"/>)</t>
                                            <t t-else=""><t t-esc="'{:,.0f}'.format(operating_net)"/></t>
                                        </div>
                                    </div>
                                </td>
                                <td style="padding: 4px; width: 25%;">
                                    <div style="background: #fef3c7; border-left: 4px solid #f59e0b; padding: 10px 12px;">
                                        <div style="font-size: 7pt; font-weight: 600; color: #475569; text-transform: uppercase;">Investing</div>
                                        <div t-att-style="'font-family: Consolas, Monaco, monospace; font-size: 12pt; font-weight: 700; margin-top: 3px; color: ' + (investing_net >= 0 and '#f59e0b' or '#dc2626') + ';'">
                                            <t t-if="investing_net &lt; 0">(<t t-esc="'{:,.0f}'.format(abs(investing_net))"/>)</t>
                                            <t t-else=""><t t-esc="'{:,.0f}'.format(investing_net)"/></t>
                                        </div>
                                    </div>
                                </td>
                                <td style="padding: 4px; width: 25%;">
                                    <div style="background: #e9d5ff; border-left: 4px solid #9333ea; padding: 10px 12px;">
                                        <div style="font-size: 7pt; font-weight: 600; color: #475569; text-transform: uppercase;">Financing</div>
                                        <div t-att-style="'font-family: Consolas, Monaco, monospace; font-size: 12pt; font-weight: 700; margin-top: 3px; color: ' + (financing_net >= 0 and '#9333ea' or '#dc2626') + ';'">
                                            <t t-if="financing_net &lt; 0">(<t t-esc="'{:,.0f}'.format(abs(financing_net))"/>)</t>
                                            <t t-else=""><t t-esc="'{:,.0f}'.format(financing_net)"/></t>
                                        </div>
                                    </div>
                                </td>
                                <td style="padding: 4px; width: 25%;">
                                    <div t-att-style="'border-left: 4px solid; padding: 10px 12px;' + (net_cf >= 0 and ' background: #d1fae5; border-color: #16a34a;' or ' background: #fee2e2; border-color: #dc2626;')">
                                        <div style="font-size: 7pt; font-weight: 600; color: #475569; text-transform: uppercase;">Net Change</div>
                                        <div t-att-style="'font-family: Consolas, Monaco, monospace; font-size: 12pt; font-weight: 700; margin-top: 3px; color: ' + (net_cf >= 0 and '#16a34a' or '#dc2626') + ';'">
                                            <t t-if="net_cf &lt; 0">(<t t-esc="'{:,.0f}'.format(abs(net_cf))"/>)</t>
                                            <t t-else=""><t t-esc="'{:,.0f}'.format(net_cf)"/></t>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </table>

                        <!-- OPERATING ACTIVITIES -->
                        <div t-attf-style="background: {{pc}}; color: {{tc}}; padding: 8px 15px; margin: 12px 0 0 0; font-size: 10pt; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px;">
                            <table width="100%" style="border-collapse: collapse;"><tr>
                                <td t-attf-style="color: {{tc}};">Cash Flow from Operating Activities</td>
                                <td class="num" t-attf-style="color: {{tc}}; font-family: Consolas, Monaco, monospace;">
                                    <t t-if="operating_net &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(operating_net))"/>)</t>
                                    <t t-else=""><t t-esc="'{:,.2f}'.format(operating_net)"/></t>
                                </td>
                            </tr></table>
                        </div>
                        <table width="100%" style="border-collapse: collapse; font-size: 8.5pt; margin-bottom: 8px;">
                            <thead><tr style="border-bottom: 2px solid #1e293b; background: #f8fafc;">
                                <th style="text-align: left; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666;">Description</th>
                                <th class="num" style="padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 18%;">Inflow</th>
                                <th class="num" style="padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 18%;">Outflow</th>
                                <th class="num" style="padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 18%;">Net</th>
                            </tr></thead>
                            <tbody>
                                <t t-foreach="report_data.get('operating_lines', report_data.get('lines', []))" t-as="line">
                                    <t t-set="inflow" t-value="line.get('inflow', 0)"/>
                                    <t t-set="outflow" t-value="line.get('outflow', 0)"/>
                                    <t t-set="net_flow" t-value="line.get('net', inflow - outflow)"/>
                                    <tr style="border-bottom: 1px solid #f1f5f9;">
                                        <td style="padding: 5px 8px;"><t t-esc="line.get('account', line.get('name', ''))"/></td>
                                        <td class="num" style="padding: 5px 8px;">
                                            <t t-if="inflow == 0"><span class="val-zero">-</span></t>
                                            <t t-else=""><span style="color: #16a34a;"><t t-esc="'{:,.2f}'.format(inflow)"/></span></t>
                                        </td>
                                        <td class="num" style="padding: 5px 8px;">
                                            <t t-if="outflow == 0"><span class="val-zero">-</span></t>
                                            <t t-else=""><span class="val-negative">(<t t-esc="'{:,.2f}'.format(outflow)"/>)</span></t>
                                        </td>
                                        <td class="num" style="padding: 5px 8px; font-weight: 600;">
                                            <t t-if="net_flow == 0"><span class="val-zero">-</span></t>
                                            <t t-elif="net_flow &lt; 0"><span class="val-negative">(<t t-esc="'{:,.2f}'.format(abs(net_flow))"/>)</span></t>
                                            <t t-else=""><span style="color: #16a34a;"><t t-esc="'{:,.2f}'.format(net_flow)"/></span></t>
                                        </td>
                                    </tr>
                                </t>
                                <tr t-attf-style="border-top: 2px solid #1e293b; background: {{pl}};">
                                    <td style="padding: 8px; font-weight: 700; text-transform: uppercase; font-size: 9pt;">Net Cash from Operating</td>
                                    <td colspan="2"></td>
                                    <td class="num" style="padding: 8px; font-weight: 700; font-size: 9pt; color: #0891b2;">
                                        <t t-if="operating_net &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(operating_net))"/>)</t>
                                        <t t-else=""><t t-esc="'{:,.2f}'.format(operating_net)"/></t>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- INVESTING ACTIVITIES -->
                        <div t-attf-style="background: {{pc}}; color: {{tc}}; padding: 8px 15px; margin: 12px 0 0 0; font-size: 10pt; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px;">
                            <table width="100%" style="border-collapse: collapse;"><tr>
                                <td t-attf-style="color: {{tc}};">Cash Flow from Investing Activities</td>
                                <td class="num" t-attf-style="color: {{tc}}; font-family: Consolas, Monaco, monospace;">
                                    <t t-if="investing_net &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(investing_net))"/>)</t>
                                    <t t-else=""><t t-esc="'{:,.2f}'.format(investing_net)"/></t>
                                </td>
                            </tr></table>
                        </div>
                        <table width="100%" style="border-collapse: collapse; font-size: 8.5pt; margin-bottom: 8px;">
                            <thead><tr style="border-bottom: 2px solid #1e293b; background: #f8fafc;">
                                <th style="text-align: left; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666;">Description</th>
                                <th class="num" style="padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 18%;">Inflow</th>
                                <th class="num" style="padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 18%;">Outflow</th>
                                <th class="num" style="padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 18%;">Net</th>
                            </tr></thead>
                            <tbody>
                                <t t-foreach="report_data.get('investing_lines', [])" t-as="line">
                                    <t t-set="inflow" t-value="line.get('inflow', 0)"/>
                                    <t t-set="outflow" t-value="line.get('outflow', 0)"/>
                                    <t t-set="net_flow" t-value="line.get('net', inflow - outflow)"/>
                                    <tr style="border-bottom: 1px solid #f1f5f9;">
                                        <td style="padding: 5px 8px;"><t t-esc="line.get('account', line.get('name', ''))"/></td>
                                        <td class="num" style="padding: 5px 8px;">
                                            <t t-if="inflow == 0"><span class="val-zero">-</span></t>
                                            <t t-else=""><span style="color: #16a34a;"><t t-esc="'{:,.2f}'.format(inflow)"/></span></t>
                                        </td>
                                        <td class="num" style="padding: 5px 8px;">
                                            <t t-if="outflow == 0"><span class="val-zero">-</span></t>
                                            <t t-else=""><span class="val-negative">(<t t-esc="'{:,.2f}'.format(outflow)"/>)</span></t>
                                        </td>
                                        <td class="num" style="padding: 5px 8px; font-weight: 600;">
                                            <t t-if="net_flow == 0"><span class="val-zero">-</span></t>
                                            <t t-elif="net_flow &lt; 0"><span class="val-negative">(<t t-esc="'{:,.2f}'.format(abs(net_flow))"/>)</span></t>
                                            <t t-else=""><span style="color: #16a34a;"><t t-esc="'{:,.2f}'.format(net_flow)"/></span></t>
                                        </td>
                                    </tr>
                                </t>
                                <tr t-attf-style="border-top: 2px solid #1e293b; background: {{pl}};">
                                    <td style="padding: 8px; font-weight: 700; text-transform: uppercase; font-size: 9pt;">Net Cash from Investing</td>
                                    <td colspan="2"></td>
                                    <td class="num" style="padding: 8px; font-weight: 700; font-size: 9pt; color: #f59e0b;">
                                        <t t-if="investing_net &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(investing_net))"/>)</t>
                                        <t t-else=""><t t-esc="'{:,.2f}'.format(investing_net)"/></t>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- FINANCING ACTIVITIES -->
                        <div t-attf-style="background: {{pc}}; color: {{tc}}; padding: 8px 15px; margin: 12px 0 0 0; font-size: 10pt; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px;">
                            <table width="100%" style="border-collapse: collapse;"><tr>
                                <td t-attf-style="color: {{tc}};">Cash Flow from Financing Activities</td>
                                <td class="num" t-attf-style="color: {{tc}}; font-family: Consolas, Monaco, monospace;">
                                    <t t-if="financing_net &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(financing_net))"/>)</t>
                                    <t t-else=""><t t-esc="'{:,.2f}'.format(financing_net)"/></t>
                                </td>
                            </tr></table>
                        </div>
                        <table width="100%" style="border-collapse: collapse; font-size: 8.5pt; margin-bottom: 8px;">
                            <thead><tr style="border-bottom: 2px solid #1e293b; background: #f8fafc;">
                                <th style="text-align: left; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666;">Description</th>
                                <th class="num" style="padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 18%;">Inflow</th>
                                <th class="num" style="padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 18%;">Outflow</th>
                                <th class="num" style="padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 18%;">Net</th>
                            </tr></thead>
                            <tbody>
                                <t t-foreach="report_data.get('financing_lines', [])" t-as="line">
                                    <t t-set="inflow" t-value="line.get('inflow', 0)"/>
                                    <t t-set="outflow" t-value="line.get('outflow', 0)"/>
                                    <t t-set="net_flow" t-value="line.get('net', inflow - outflow)"/>
                                    <tr style="border-bottom: 1px solid #f1f5f9;">
                                        <td style="padding: 5px 8px;"><t t-esc="line.get('account', line.get('name', ''))"/></td>
                                        <td class="num" style="padding: 5px 8px;">
                                            <t t-if="inflow == 0"><span class="val-zero">-</span></t>
                                            <t t-else=""><span style="color: #16a34a;"><t t-esc="'{:,.2f}'.format(inflow)"/></span></t>
                                        </td>
                                        <td class="num" style="padding: 5px 8px;">
                                            <t t-if="outflow == 0"><span class="val-zero">-</span></t>
                                            <t t-else=""><span class="val-negative">(<t t-esc="'{:,.2f}'.format(outflow)"/>)</span></t>
                                        </td>
                                        <td class="num" style="padding: 5px 8px; font-weight: 600;">
                                            <t t-if="net_flow == 0"><span class="val-zero">-</span></t>
                                            <t t-elif="net_flow &lt; 0"><span class="val-negative">(<t t-esc="'{:,.2f}'.format(abs(net_flow))"/>)</span></t>
                                            <t t-else=""><span style="color: #16a34a;"><t t-esc="'{:,.2f}'.format(net_flow)"/></span></t>
                                        </td>
                                    </tr>
                                </t>
                                <tr t-attf-style="border-top: 2px solid #1e293b; background: {{pl}};">
                                    <td style="padding: 8px; font-weight: 700; text-transform: uppercase; font-size: 9pt;">Net Cash from Financing</td>
                                    <td colspan="2"></td>
                                    <td class="num" style="padding: 8px; font-weight: 700; font-size: 9pt; color: #9333ea;">
                                        <t t-if="financing_net &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(financing_net))"/>)</t>
                                        <t t-else=""><t t-esc="'{:,.2f}'.format(financing_net)"/></t>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- CASH RECONCILIATION -->
                        <div style="page-break-inside: avoid; margin-top: 18px;">
                            <div t-attf-style="background: {{pc}}; color: {{tc}}; padding: 8px 15px; font-size: 10pt; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px;">
                                Cash Reconciliation
                            </div>
                            <table width="100%" style="border-collapse: collapse; font-size: 9pt; margin-bottom: 12px;">
                                <tbody>
                                    <tr style="border-bottom: 1px solid #e2e8f0;">
                                        <td style="padding: 8px;">Cash at Beginning of Period</td>
                                        <td class="num" style="padding: 8px; width: 25%;"><t t-esc="'{:,.2f}'.format(opening_cash)"/></td>
                                    </tr>
                                    <tr style="border-bottom: 1px solid #e2e8f0;">
                                        <td style="padding: 8px 8px 8px 20px; color: #475569;">Net Cash from Operating</td>
                                        <td class="num" style="padding: 8px;">
                                            <t t-if="operating_net &lt; 0"><span class="val-negative">(<t t-esc="'{:,.2f}'.format(abs(operating_net))"/>)</span></t>
                                            <t t-else=""><span style="color: #16a34a;"><t t-esc="'{:,.2f}'.format(operating_net)"/></span></t>
                                        </td>
                                    </tr>
                                    <tr style="border-bottom: 1px solid #e2e8f0;">
                                        <td style="padding: 8px 8px 8px 20px; color: #475569;">Net Cash from Investing</td>
                                        <td class="num" style="padding: 8px;">
                                            <t t-if="investing_net &lt; 0"><span class="val-negative">(<t t-esc="'{:,.2f}'.format(abs(investing_net))"/>)</span></t>
                                            <t t-else=""><span style="color: #16a34a;"><t t-esc="'{:,.2f}'.format(investing_net)"/></span></t>
                                        </td>
                                    </tr>
                                    <tr style="border-bottom: 1px solid #e2e8f0;">
                                        <td style="padding: 8px 8px 8px 20px; color: #475569;">Net Cash from Financing</td>
                                        <td class="num" style="padding: 8px;">
                                            <t t-if="financing_net &lt; 0"><span class="val-negative">(<t t-esc="'{:,.2f}'.format(abs(financing_net))"/>)</span></t>
                                            <t t-else=""><span style="color: #16a34a;"><t t-esc="'{:,.2f}'.format(financing_net)"/></span></t>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <!-- Grand Total: Closing Cash -->
                            <table width="100%" t-attf-style="border-collapse: collapse; background: {{pc}};">
                                <tr>
                                    <td t-attf-style="padding: 13px 8px; font-weight: 700; font-size: 10pt; color: {{tc}}; text-transform: uppercase; width: 75%;">Cash at End of Period</td>
                                    <td class="num" t-attf-style="width: 25%; padding: 13px 8px; font-weight: 700; font-size: 10pt; color: {{tc}};"><t t-esc="'{:,.2f}'.format(closing_cash)"/></td>
                                </tr>
                            </table>
                        </div>

                        <!-- SIGNATURE BLOCK -->
                        <div style="margin-top: 28px; page-break-inside: avoid;">
                            <table width="100%" style="border-collapse: collapse; border: none;">
                                <tr style="border: none;">
                                    <td style="border: none; width: 33%; padding: 0 16px 0 0;">
                                        <div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">Prepared by</div>
                                        <div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">Name / Date</div>
                                    </td>
                                    <td style="border: none; width: 33%; padding: 0 16px; border-left: 1px solid #e2e8f0;">
                                        <div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">Reviewed by</div>
                                        <div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">Name / Date</div>
                                    </td>
                                    <td style="border: none; width: 33%; padding: 0 0 0 16px; border-left: 1px solid #e2e8f0;">
                                        <div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">Approved by</div>
                                        <div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">Name / Date</div>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <!-- FIXED FOOTER -->
                        <div class="page-footer-fixed">
                            <table style="width: 100%; border-collapse: collapse;">
                                <tr>
                                    <td style="width: 50%; text-align: left; vertical-align: middle; padding: 4px 0;">
                                        <span style="font-size: 8pt; color: #666666;">Powered by</span>
                                        <span style="display: inline-block; background: linear-gradient(135deg, #3b82f6, #1e40af); color: #ffffff; padding: 3px 8px; border-radius: 4px; font-size: 7pt; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; font-family: Arial, Helvetica, sans-serif; vertical-align: middle; margin-left: 4px; -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important;">OPS Framework</span>
                                    </td>
                                    <td style="width: 50%; text-align: right; vertical-align: middle; padding: 4px 0;">
                                        <span style="font-size: 6.5pt; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.5px;">Confidential - For authorized personnel only</span>
                                    </td>
                                </tr>
                            </table>
                        </div>

                    </div>
                </t>
            </t>
        </t>
    </template>

    <!-- ================================================================
         AGED PARTNER BALANCE CORPORATE TEMPLATE (Landscape)
         ================================================================ -->

    <template id="report_aged_partner_corporate">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-set="company" t-value="doc.company_id or env.company"/>
                <t t-set="pc" t-value="primary_color"/>
                <t t-set="tc" t-value="text_on_primary"/>
                <t t-set="pl" t-value="primary_light"/>
                <t t-set="pd" t-value="primary_dark"/>

                <t t-call="ops_matrix_accounting.ops_corporate_pdf_layout">
                    <style>
                        * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
                        @page { size: A4 landscape; margin: 15mm 12mm 25mm 12mm; }
                        .num { text-align: right; font-family: Consolas, Monaco, 'Courier New', monospace; }
                        .val-negative { color: #dc2626; }
                        .val-zero { color: #bbbbbb; }
                        .page-footer-fixed { position: fixed; bottom: 0; left: 0; right: 0; padding: 6px 0 0 0; border-top: 1px solid #e2e8f0; }
                    </style>

                    <div class="page ops-report" t-attf-style="color: {{body_text_color}}; font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, Helvetica, sans-serif; font-size: 8.5pt; line-height: 1.45;">

                        <!-- HEADER -->
                        <table width="100%" style="border-collapse: collapse; margin-bottom: 15px;" t-attf-style="border-bottom: 2px solid {{pc}}; padding-bottom: 10px;">
                            <tr>
                                <td style="vertical-align: middle; width: 60%;">
                                    <table style="border-collapse: collapse;">
                                        <tr>
                                            <t t-if="company.logo">
                                                <td style="vertical-align: middle; padding-right: 12px;">
                                                    <img t-att-src="image_data_uri(company.logo)" style="max-height: 45px; max-width: 100px; border-radius: 6px; object-fit: contain;" alt="Logo"/>
                                                </td>
                                            </t>
                                            <t t-else="">
                                                <td style="vertical-align: middle; padding-right: 12px;">
                                                    <div t-attf-style="width: 45px; height: 45px; border-radius: 6px; background: {{pc}}; color: {{tc}}; font-weight: 700; font-size: 14pt; text-align: center; line-height: 45px;">
                                                        <t t-esc="(company.name or 'CO')[:2].upper()"/>
                                                    </div>
                                                </td>
                                            </t>
                                            <td style="vertical-align: middle;">
                                                <div style="font-size: 14pt; font-weight: 700; color: #1e293b; line-height: 1.2;"><t t-esc="company.name"/></div>
                                                <div style="font-size: 8.5pt; color: #666666; margin-top: 1px;">
                                                    <t t-if="company.city"><t t-esc="company.city"/></t>
                                                    <t t-if="company.city and company.country_id">, </t>
                                                    <t t-esc="company.country_id.name or ''"/>
                                                </div>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                                <td style="vertical-align: top; width: 40%; text-align: right;">
                                    <div style="font-size: 8pt; color: #666666; line-height: 1.6;">
                                        Printed: <t t-esc="context_timestamp(datetime.datetime.now()).strftime('%d %b %Y %H:%M')"/><br/>
                                        Generated by: <t t-esc="user.name"/>
                                    </div>
                                    <div style="font-family: 'Courier New', monospace; font-size: 7pt; color: #94a3b8; letter-spacing: 0.3px; margin-top: 2px;">
                                        Report ID: <t t-esc="report_run_id"/>
                                    </div>
                                </td>
                            </tr>
                        </table>

                        <!-- TITLE -->
                        <div style="margin: 8px 0 4px 0;">
                            <div style="font-size: 16pt; font-weight: 700; color: #1e293b; margin-bottom: 4px;">Aged Partner Balance</div>
                            <div style="font-size: 8.5pt; color: #666666;">
                                <t t-if="doc.date_from" t-esc="doc.date_from.strftime('%d %b %Y')"/> -
                                <t t-if="doc.date_to" t-esc="doc.date_to.strftime('%d %b %Y')"/>
                                <span style="color: #94a3b8;"> | </span><t t-esc="currency_name"/>
                                <span style="color: #94a3b8;"> | </span>
                                <t t-if="doc.target_move == 'posted'">Posted Entries</t><t t-else="">All Entries</t>
                            </div>
                        </div>

                        <!-- AGING SUMMARY KPIs -->
                        <t t-set="total_current" t-value="report_data.get('total_current', 0)"/>
                        <t t-set="total_30" t-value="report_data.get('total_30', 0)"/>
                        <t t-set="total_60" t-value="report_data.get('total_60', 0)"/>
                        <t t-set="total_90" t-value="report_data.get('total_90', 0)"/>
                        <t t-set="total_older" t-value="report_data.get('total_older', 0)"/>
                        <t t-set="total_balance" t-value="total_current + total_30 + total_60 + total_90 + total_older"/>

                        <table width="100%" style="border-collapse: collapse; margin: 12px 0 18px 0;">
                            <tr>
                                <td style="padding: 4px; width: 20%;">
                                    <div style="background: #dcfce7; border-left: 4px solid #16a34a; padding: 10px 12px;">
                                        <div style="font-size: 7pt; font-weight: 600; color: #475569; text-transform: uppercase;">Current</div>
                                        <div style="font-family: Consolas, Monaco, monospace; font-size: 12pt; font-weight: 700; color: #16a34a; margin-top: 3px;"><t t-esc="'{:,.0f}'.format(total_current)"/></div>
                                    </div>
                                </td>
                                <td style="padding: 4px; width: 20%;">
                                    <div style="background: #fef3c7; border-left: 4px solid #eab308; padding: 10px 12px;">
                                        <div style="font-size: 7pt; font-weight: 600; color: #475569; text-transform: uppercase;">1&#x2013;30 Days</div>
                                        <div style="font-family: Consolas, Monaco, monospace; font-size: 12pt; font-weight: 700; color: #ca8a04; margin-top: 3px;"><t t-esc="'{:,.0f}'.format(total_30)"/></div>
                                    </div>
                                </td>
                                <td style="padding: 4px; width: 20%;">
                                    <div style="background: #fed7aa; border-left: 4px solid #f59e0b; padding: 10px 12px;">
                                        <div style="font-size: 7pt; font-weight: 600; color: #475569; text-transform: uppercase;">31&#x2013;60 Days</div>
                                        <div style="font-family: Consolas, Monaco, monospace; font-size: 12pt; font-weight: 700; color: #d97706; margin-top: 3px;"><t t-esc="'{:,.0f}'.format(total_60)"/></div>
                                    </div>
                                </td>
                                <td style="padding: 4px; width: 20%;">
                                    <div style="background: #fecaca; border-left: 4px solid #ef4444; padding: 10px 12px;">
                                        <div style="font-size: 7pt; font-weight: 600; color: #475569; text-transform: uppercase;">61&#x2013;90 Days</div>
                                        <div style="font-family: Consolas, Monaco, monospace; font-size: 12pt; font-weight: 700; color: #dc2626; margin-top: 3px;"><t t-esc="'{:,.0f}'.format(total_90)"/></div>
                                    </div>
                                </td>
                                <td style="padding: 4px; width: 20%;">
                                    <div style="background: #fee2e2; border-left: 4px solid #dc2626; padding: 10px 12px;">
                                        <div style="font-size: 7pt; font-weight: 600; color: #475569; text-transform: uppercase;">90+ Days</div>
                                        <div style="font-family: Consolas, Monaco, monospace; font-size: 12pt; font-weight: 700; color: #991b1b; margin-top: 3px;"><t t-esc="'{:,.0f}'.format(total_older)"/></div>
                                    </div>
                                </td>
                            </tr>
                        </table>

                        <!-- DATA TABLE -->
                        <table width="100%" style="border-collapse: collapse; font-size: 8.5pt; margin-bottom: 18px;">
                            <thead>
                                <tr style="border-bottom: 2px solid #1e293b; background: #f8fafc;">
                                    <th style="text-align: left; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 22%;">Partner</th>
                                    <th class="num" style="padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 13%;">Current</th>
                                    <th class="num" style="padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 13%;">1&#x2013;30</th>
                                    <th class="num" style="padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 13%;">31&#x2013;60</th>
                                    <th class="num" style="padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 13%;">61&#x2013;90</th>
                                    <th class="num" style="padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 13%;">90+</th>
                                    <th class="num" style="padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 13%;">Total Due</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="report_data.get('lines', [])" t-as="line">
                                    <t t-set="current" t-value="line.get('current', 0)"/>
                                    <t t-set="age_30" t-value="line.get('30', line.get('age_30', 0))"/>
                                    <t t-set="age_60" t-value="line.get('60', line.get('age_60', 0))"/>
                                    <t t-set="age_90" t-value="line.get('90', line.get('age_90', 0))"/>
                                    <t t-set="older" t-value="line.get('older', line.get('age_older', 0))"/>
                                    <t t-set="total" t-value="line.get('total', line.get('balance', current + age_30 + age_60 + age_90 + older))"/>
                                    <tr t-att-style="'border-bottom: 1px solid #f1f5f9;' + (' background: #f8fafc;' if line_even else '')">
                                        <td style="padding: 5px 8px;"><t t-esc="line.get('partner', line.get('name', ''))"/></td>
                                        <td class="num" style="padding: 5px 8px;">
                                            <t t-if="current == 0"><span class="val-zero">-</span></t>
                                            <t t-else=""><t t-esc="'{:,.2f}'.format(current)"/></t>
                                        </td>
                                        <td class="num" style="padding: 5px 8px;">
                                            <t t-if="age_30 == 0"><span class="val-zero">-</span></t>
                                            <t t-else=""><span style="color: #ca8a04;"><t t-esc="'{:,.2f}'.format(age_30)"/></span></t>
                                        </td>
                                        <td class="num" style="padding: 5px 8px;">
                                            <t t-if="age_60 == 0"><span class="val-zero">-</span></t>
                                            <t t-else=""><span style="color: #d97706;"><t t-esc="'{:,.2f}'.format(age_60)"/></span></t>
                                        </td>
                                        <td class="num" style="padding: 5px 8px;">
                                            <t t-if="age_90 == 0"><span class="val-zero">-</span></t>
                                            <t t-else=""><span style="color: #ef4444;"><t t-esc="'{:,.2f}'.format(age_90)"/></span></t>
                                        </td>
                                        <td class="num" style="padding: 5px 8px;">
                                            <t t-if="older == 0"><span class="val-zero">-</span></t>
                                            <t t-else=""><span style="color: #dc2626; font-weight: 700;"><t t-esc="'{:,.2f}'.format(older)"/></span></t>
                                        </td>
                                        <td class="num" style="padding: 5px 8px; font-weight: 600;"><t t-esc="'{:,.2f}'.format(total)"/></td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>

                        <!-- GRAND TOTAL BAR -->
                        <div style="page-break-inside: avoid;">
                            <table width="100%" t-attf-style="border-collapse: collapse; background: {{pc}};">
                                <tr>
                                    <td t-attf-style="padding: 13px 8px; font-weight: 700; font-size: 10pt; color: {{tc}}; text-transform: uppercase; width: 22%;">Grand Total</td>
                                    <td class="num" t-attf-style="width: 13%; padding: 13px 8px; font-weight: 700; font-size: 9pt; color: {{tc}};"><t t-esc="'{:,.2f}'.format(total_current)"/></td>
                                    <td class="num" t-attf-style="width: 13%; padding: 13px 8px; font-weight: 700; font-size: 9pt; color: {{tc}};"><t t-esc="'{:,.2f}'.format(total_30)"/></td>
                                    <td class="num" t-attf-style="width: 13%; padding: 13px 8px; font-weight: 700; font-size: 9pt; color: {{tc}};"><t t-esc="'{:,.2f}'.format(total_60)"/></td>
                                    <td class="num" t-attf-style="width: 13%; padding: 13px 8px; font-weight: 700; font-size: 9pt; color: {{tc}};"><t t-esc="'{:,.2f}'.format(total_90)"/></td>
                                    <td class="num" t-attf-style="width: 13%; padding: 13px 8px; font-weight: 700; font-size: 9pt; color: {{tc}};"><t t-esc="'{:,.2f}'.format(total_older)"/></td>
                                    <td class="num" t-attf-style="width: 13%; padding: 13px 8px; font-weight: 700; font-size: 10pt; color: {{tc}};"><t t-esc="'{:,.2f}'.format(total_balance)"/></td>
                                </tr>
                            </table>
                        </div>

                        <!-- SIGNATURE BLOCK -->
                        <div style="margin-top: 28px; page-break-inside: avoid;">
                            <table width="100%" style="border-collapse: collapse; border: none;">
                                <tr style="border: none;">
                                    <td style="border: none; width: 33%; padding: 0 16px 0 0;">
                                        <div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">Prepared by</div>
                                        <div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">Name / Date</div>
                                    </td>
                                    <td style="border: none; width: 33%; padding: 0 16px; border-left: 1px solid #e2e8f0;">
                                        <div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">Reviewed by</div>
                                        <div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">Name / Date</div>
                                    </td>
                                    <td style="border: none; width: 33%; padding: 0 0 0 16px; border-left: 1px solid #e2e8f0;">
                                        <div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">Approved by</div>
                                        <div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">Name / Date</div>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <!-- FIXED FOOTER -->
                        <div class="page-footer-fixed">
                            <table style="width: 100%; border-collapse: collapse;">
                                <tr>
                                    <td style="width: 50%; text-align: left; vertical-align: middle; padding: 4px 0;">
                                        <span style="font-size: 8pt; color: #666666;">Powered by</span>
                                        <span style="display: inline-block; background: linear-gradient(135deg, #3b82f6, #1e40af); color: #ffffff; padding: 3px 8px; border-radius: 4px; font-size: 7pt; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; font-family: Arial, Helvetica, sans-serif; vertical-align: middle; margin-left: 4px; -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important;">OPS Framework</span>
                                    </td>
                                    <td style="width: 50%; text-align: right; vertical-align: middle; padding: 4px 0;">
                                        <span style="font-size: 6.5pt; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.5px;">Confidential - For authorized personnel only</span>
                                    </td>
                                </tr>
                            </table>
                        </div>

                    </div>
                </t>
            </t>
        </t>
    </template>

    <!-- ================================================================
         BALANCE SHEET CORPORATE TEMPLATE
         ================================================================ -->

    <template id="report_balance_sheet_corporate">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-set="company" t-value="doc.company_id or env.company"/>
                <t t-set="pc" t-value="primary_color"/>
                <t t-set="tc" t-value="text_on_primary"/>
                <t t-set="pl" t-value="primary_light"/>
                <t t-set="pd" t-value="primary_dark"/>

                <t t-call="ops_matrix_accounting.ops_corporate_pdf_layout">
                    <style>
                        * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
                        @page { size: A4; margin: 15mm 12mm 25mm 12mm; }
                        .num { text-align: right; font-family: Consolas, Monaco, 'Courier New', monospace; }
                        .val-negative { color: #dc2626; }
                        .val-zero { color: #bbbbbb; }
                        .page-footer-fixed { position: fixed; bottom: 0; left: 0; right: 0; padding: 6px 0 0 0; border-top: 1px solid #e2e8f0; }
                    </style>

                    <div class="page ops-report" t-attf-style="color: {{body_text_color}}; font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, Helvetica, sans-serif; font-size: 8.5pt; line-height: 1.45;">

                        <!-- HEADER -->
                        <table width="100%" style="border-collapse: collapse; margin-bottom: 15px;" t-attf-style="border-bottom: 2px solid {{pc}}; padding-bottom: 10px;">
                            <tr>
                                <td style="vertical-align: middle; width: 60%;">
                                    <table style="border-collapse: collapse;">
                                        <tr>
                                            <t t-if="company.logo">
                                                <td style="vertical-align: middle; padding-right: 12px;">
                                                    <img t-att-src="image_data_uri(company.logo)" style="max-height: 45px; max-width: 100px; border-radius: 6px; object-fit: contain;" alt="Logo"/>
                                                </td>
                                            </t>
                                            <t t-else="">
                                                <td style="vertical-align: middle; padding-right: 12px;">
                                                    <div t-attf-style="width: 45px; height: 45px; border-radius: 6px; background: {{pc}}; color: {{tc}}; font-weight: 700; font-size: 14pt; text-align: center; line-height: 45px;">
                                                        <t t-esc="(company.name or 'CO')[:2].upper()"/>
                                                    </div>
                                                </td>
                                            </t>
                                            <td style="vertical-align: middle;">
                                                <div style="font-size: 14pt; font-weight: 700; color: #1e293b; line-height: 1.2;"><t t-esc="company.name"/></div>
                                                <div style="font-size: 8.5pt; color: #666666; margin-top: 1px;">
                                                    <t t-if="company.city"><t t-esc="company.city"/></t>
                                                    <t t-if="company.city and company.country_id">, </t>
                                                    <t t-esc="company.country_id.name or ''"/>
                                                </div>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                                <td style="vertical-align: top; width: 40%; text-align: right;">
                                    <div style="font-size: 8pt; color: #666666; line-height: 1.6;">
                                        Printed: <t t-esc="context_timestamp(datetime.datetime.now()).strftime('%d %b %Y %H:%M')"/><br/>
                                        Generated by: <t t-esc="user.name"/>
                                    </div>
                                    <div style="font-family: 'Courier New', monospace; font-size: 7pt; color: #94a3b8; letter-spacing: 0.3px; margin-top: 2px;">
                                        Report ID: <t t-esc="report_run_id"/>
                                    </div>
                                </td>
                            </tr>
                        </table>

                        <!-- TITLE -->
                        <div style="margin: 8px 0 4px 0;">
                            <div style="font-size: 16pt; font-weight: 700; color: #1e293b; margin-bottom: 4px;">Balance Sheet</div>
                            <div style="font-size: 8.5pt; color: #666666;">
                                As of <t t-if="doc.as_of_date" t-esc="doc.as_of_date.strftime('%d %b %Y')"/>
                                <t t-if="not doc.as_of_date and doc.date_to" t-esc="doc.date_to.strftime('%d %b %Y')"/>
                                <span style="color: #94a3b8;"> | </span><t t-esc="currency_name"/>
                                <span style="color: #94a3b8;"> | </span>
                                <t t-if="doc.target_move == 'posted'">Posted Entries</t><t t-else="">All Entries</t>
                            </div>
                        </div>

                        <!-- EXTRACT TOTALS -->
                        <t t-set="summary" t-value="report_data.get('summary', {})"/>
                        <t t-set="hierarchy" t-value="report_data.get('hierarchy', {})"/>
                        <t t-set="total_assets" t-value="summary.get('total_assets', hierarchy.get('asset_total', report_data.get('asset_total', 0)))"/>
                        <t t-set="total_liabilities" t-value="summary.get('total_liabilities', hierarchy.get('liability_total', report_data.get('liability_total', 0)))"/>
                        <t t-set="total_equity" t-value="summary.get('total_equity', hierarchy.get('equity_total', report_data.get('equity_total', 0)))"/>
                        <t t-set="check_diff" t-value="abs(total_assets - (total_liabilities + total_equity))"/>

                        <!-- SUMMARY KPIs -->
                        <table width="100%" style="border-collapse: collapse; margin: 12px 0 12px 0;">
                            <tr>
                                <td style="padding: 4px; width: 33%;">
                                    <div style="background: #f0fdf4; border-left: 4px solid #16a34a; padding: 10px 12px;">
                                        <div style="font-size: 7pt; font-weight: 600; color: #475569; text-transform: uppercase;">Total Assets</div>
                                        <div style="font-family: Consolas, Monaco, monospace; font-size: 13pt; font-weight: 700; color: #16a34a; margin-top: 3px;"><t t-esc="'{:,.2f}'.format(total_assets)"/></div>
                                    </div>
                                </td>
                                <td style="padding: 4px; width: 33%;">
                                    <div style="background: #fff7ed; border-left: 4px solid #f59e0b; padding: 10px 12px;">
                                        <div style="font-size: 7pt; font-weight: 600; color: #475569; text-transform: uppercase;">Total Liabilities</div>
                                        <div style="font-family: Consolas, Monaco, monospace; font-size: 13pt; font-weight: 700; color: #f59e0b; margin-top: 3px;"><t t-esc="'{:,.2f}'.format(total_liabilities)"/></div>
                                    </div>
                                </td>
                                <td style="padding: 4px; width: 33%;">
                                    <div style="background: #faf5ff; border-left: 4px solid #9333ea; padding: 10px 12px;">
                                        <div style="font-size: 7pt; font-weight: 600; color: #475569; text-transform: uppercase;">Shareholders' Equity</div>
                                        <div style="font-family: Consolas, Monaco, monospace; font-size: 13pt; font-weight: 700; color: #9333ea; margin-top: 3px;"><t t-esc="'{:,.2f}'.format(total_equity)"/></div>
                                    </div>
                                </td>
                            </tr>
                        </table>

                        <!-- BALANCE CHECK -->
                        <div t-att-style="'border-left: 4px solid; padding: 8px 15px; margin: 0 0 18px 0; font-size: 8.5pt;' + (check_diff &lt; 0.01 and ' background: #dcfce7; border-color: #16a34a; color: #166534;' or ' background: #fee2e2; border-color: #dc2626; color: #991b1b;')">
                            <t t-if="check_diff &lt; 0.01">[ok] Balance Sheet is Balanced (A = L + E)</t>
                            <t t-else="">[!] Out of Balance - Difference: <span style="font-weight: 700; font-family: Consolas, Monaco, monospace;"><t t-esc="'{:,.2f}'.format(check_diff)"/></span></t>
                        </div>

                        <!-- ASSETS SECTION -->
                        <div t-attf-style="background: {{pc}}; color: {{tc}}; padding: 8px 15px; font-size: 10pt; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px;">ASSETS</div>
                        <table width="100%" style="border-collapse: collapse; font-size: 8.5pt; margin-bottom: 8px;">
                            <thead><tr style="border-bottom: 2px solid #1e293b; background: #f8fafc;">
                                <th style="text-align: left; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 15%;">Code</th>
                                <th style="text-align: left; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 55%;">Account</th>
                                <th class="num" style="padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 30%;">Balance (<t t-esc="currency_name"/>)</th>
                            </tr></thead>
                            <tbody>
                                <t t-foreach="hierarchy.get('asset_hierarchy', report_data.get('asset_lines', []))" t-as="line">
                                    <t t-set="bal" t-value="line.get('balance', 0)"/>
                                    <tr t-att-style="'border-bottom: 1px solid #f1f5f9;' + (line.get('is_subtotal') and ' border-top: 1px solid #e2e8f0; background: #f8fafc;' or '') + (line.get('type') == 'group' and ' background: #fafafa;' or '')">
                                        <td t-att-style="'padding: 5px 8px; padding-left: ' + str(8 + line.get('indent', line.get('level', 0)) * 12) + 'px; font-family: Consolas, Monaco, monospace; font-size: 7.5pt; color: #64748b;'"><t t-esc="line.get('code', line.get('account_code', ''))"/></td>
                                        <td t-att-style="'padding: 5px 8px; padding-left: ' + str(8 + line.get('indent', line.get('level', 0)) * 12) + 'px;' + (line.get('type') in ('group', 'subtotal') and ' font-weight: 600;' or '')"><t t-esc="line.get('name', line.get('account_name', line.get('account', '')))"/></td>
                                        <td class="num" t-att-style="'padding: 5px 8px;' + (line.get('type') in ('group', 'subtotal') and ' font-weight: 600;' or '')">
                                            <t t-if="bal == 0"><span class="val-zero">-</span></t>
                                            <t t-elif="bal &lt; 0"><span class="val-negative">(<t t-esc="'{:,.2f}'.format(abs(bal))"/>)</span></t>
                                            <t t-else=""><t t-esc="'{:,.2f}'.format(bal)"/></t>
                                        </td>
                                    </tr>
                                </t>
                                <tr t-attf-style="border-top: 2px solid #1e293b; background: {{pl}};">
                                    <td colspan="2" style="padding: 8px; font-weight: 700; text-transform: uppercase; font-size: 9pt;">Total Assets</td>
                                    <td class="num" style="padding: 8px; font-weight: 700; font-size: 9pt; color: #16a34a;"><t t-esc="'{:,.2f}'.format(total_assets)"/></td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- LIABILITIES SECTION -->
                        <div t-attf-style="background: {{pc}}; color: {{tc}}; padding: 8px 15px; margin: 12px 0 0 0; font-size: 10pt; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px;">LIABILITIES</div>
                        <table width="100%" style="border-collapse: collapse; font-size: 8.5pt; margin-bottom: 8px;">
                            <thead><tr style="border-bottom: 2px solid #1e293b; background: #f8fafc;">
                                <th style="text-align: left; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 15%;">Code</th>
                                <th style="text-align: left; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 55%;">Account</th>
                                <th class="num" style="padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 30%;">Balance (<t t-esc="currency_name"/>)</th>
                            </tr></thead>
                            <tbody>
                                <t t-foreach="hierarchy.get('liability_hierarchy', report_data.get('liability_lines', []))" t-as="line">
                                    <t t-set="bal" t-value="abs(line.get('balance', 0))"/>
                                    <tr t-att-style="'border-bottom: 1px solid #f1f5f9;' + (line.get('is_subtotal') and ' border-top: 1px solid #e2e8f0; background: #f8fafc;' or '') + (line.get('type') == 'group' and ' background: #fafafa;' or '')">
                                        <td t-att-style="'padding: 5px 8px; padding-left: ' + str(8 + line.get('indent', line.get('level', 0)) * 12) + 'px; font-family: Consolas, Monaco, monospace; font-size: 7.5pt; color: #64748b;'"><t t-esc="line.get('code', line.get('account_code', ''))"/></td>
                                        <td t-att-style="'padding: 5px 8px; padding-left: ' + str(8 + line.get('indent', line.get('level', 0)) * 12) + 'px;' + (line.get('type') in ('group', 'subtotal') and ' font-weight: 600;' or '')"><t t-esc="line.get('name', line.get('account_name', line.get('account', '')))"/></td>
                                        <td class="num" t-att-style="'padding: 5px 8px;' + (line.get('type') in ('group', 'subtotal') and ' font-weight: 600;' or '')">
                                            <t t-if="bal == 0"><span class="val-zero">-</span></t>
                                            <t t-else=""><t t-esc="'{:,.2f}'.format(bal)"/></t>
                                        </td>
                                    </tr>
                                </t>
                                <tr t-attf-style="border-top: 2px solid #1e293b; background: {{pl}};">
                                    <td colspan="2" style="padding: 8px; font-weight: 700; text-transform: uppercase; font-size: 9pt;">Total Liabilities</td>
                                    <td class="num" style="padding: 8px; font-weight: 700; font-size: 9pt; color: #f59e0b;"><t t-esc="'{:,.2f}'.format(total_liabilities)"/></td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- EQUITY SECTION -->
                        <div t-attf-style="background: {{pc}}; color: {{tc}}; padding: 8px 15px; margin: 12px 0 0 0; font-size: 10pt; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px;">SHAREHOLDERS' EQUITY</div>
                        <table width="100%" style="border-collapse: collapse; font-size: 8.5pt; margin-bottom: 8px;">
                            <thead><tr style="border-bottom: 2px solid #1e293b; background: #f8fafc;">
                                <th style="text-align: left; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 15%;">Code</th>
                                <th style="text-align: left; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 55%;">Account</th>
                                <th class="num" style="padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; color: #666666; width: 30%;">Balance (<t t-esc="currency_name"/>)</th>
                            </tr></thead>
                            <tbody>
                                <t t-foreach="hierarchy.get('equity_hierarchy', report_data.get('equity_lines', []))" t-as="line">
                                    <t t-set="bal" t-value="abs(line.get('balance', 0))"/>
                                    <tr t-att-style="'border-bottom: 1px solid #f1f5f9;' + (line.get('is_subtotal') and ' border-top: 1px solid #e2e8f0; background: #f8fafc;' or '') + (line.get('type') == 'group' and ' background: #fafafa;' or '')">
                                        <td t-att-style="'padding: 5px 8px; padding-left: ' + str(8 + line.get('indent', line.get('level', 0)) * 12) + 'px; font-family: Consolas, Monaco, monospace; font-size: 7.5pt; color: #64748b;'"><t t-esc="line.get('code', line.get('account_code', ''))"/></td>
                                        <td t-att-style="'padding: 5px 8px; padding-left: ' + str(8 + line.get('indent', line.get('level', 0)) * 12) + 'px;' + (line.get('type') in ('group', 'subtotal') and ' font-weight: 600;' or '')"><t t-esc="line.get('name', line.get('account_name', line.get('account', '')))"/></td>
                                        <td class="num" t-att-style="'padding: 5px 8px;' + (line.get('type') in ('group', 'subtotal') and ' font-weight: 600;' or '')">
                                            <t t-if="bal == 0"><span class="val-zero">-</span></t>
                                            <t t-else=""><t t-esc="'{:,.2f}'.format(bal)"/></t>
                                        </td>
                                    </tr>
                                </t>
                                <tr t-attf-style="border-top: 2px solid #1e293b; background: {{pl}};">
                                    <td colspan="2" style="padding: 8px; font-weight: 700; text-transform: uppercase; font-size: 9pt;">Total Equity</td>
                                    <td class="num" style="padding: 8px; font-weight: 700; font-size: 9pt; color: #9333ea;"><t t-esc="'{:,.2f}'.format(total_equity)"/></td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- GRAND TOTAL: L + E -->
                        <div style="page-break-inside: avoid; margin-top: 18px;">
                            <table width="100%" t-attf-style="border-collapse: collapse; background: {{pc}};">
                                <tr>
                                    <td style="padding: 15px; width: 70%;">
                                        <div t-attf-style="font-size: 11pt; font-weight: 700; color: {{tc}}; text-transform: uppercase;">Total Liabilities + Equity</div>
                                        <div t-attf-style="font-size: 7.5pt; color: {{tc}}; opacity: 0.8; margin-top: 2px;">Must equal Total Assets (A = L + E)</div>
                                    </td>
                                    <td class="num" style="padding: 15px; width: 30%;">
                                        <div t-attf-style="font-family: Consolas, Monaco, monospace; font-size: 16pt; font-weight: 700; color: {{tc}};">
                                            <t t-esc="'{:,.2f}'.format(total_liabilities + total_equity)"/>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <!-- SIGNATURE BLOCK -->
                        <div style="margin-top: 28px; page-break-inside: avoid;">
                            <table width="100%" style="border-collapse: collapse; border: none;">
                                <tr style="border: none;">
                                    <td style="border: none; width: 33%; padding: 0 16px 0 0;">
                                        <div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">Prepared by</div>
                                        <div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">Name / Date</div>
                                    </td>
                                    <td style="border: none; width: 33%; padding: 0 16px; border-left: 1px solid #e2e8f0;">
                                        <div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">Reviewed by</div>
                                        <div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">Name / Date</div>
                                    </td>
                                    <td style="border: none; width: 33%; padding: 0 0 0 16px; border-left: 1px solid #e2e8f0;">
                                        <div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">Approved by</div>
                                        <div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">Name / Date</div>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <!-- FIXED FOOTER -->
                        <div class="page-footer-fixed">
                            <table style="width: 100%; border-collapse: collapse;">
                                <tr>
                                    <td style="width: 50%; text-align: left; vertical-align: middle; padding: 4px 0;">
                                        <span style="font-size: 8pt; color: #666666;">Powered by</span>
                                        <span style="display: inline-block; background: linear-gradient(135deg, #3b82f6, #1e40af); color: #ffffff; padding: 3px 8px; border-radius: 4px; font-size: 7pt; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; font-family: Arial, Helvetica, sans-serif; vertical-align: middle; margin-left: 4px; -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important;">OPS Framework</span>
                                    </td>
                                    <td style="width: 50%; text-align: right; vertical-align: middle; padding: 4px 0;">
                                        <span style="font-size: 6.5pt; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.5px;">Confidential - For authorized personnel only</span>
                                    </td>
                                </tr>
                            </table>
                        </div>

                    </div>
                </t>
            </t>
        </t>
    </template>

    <!-- Legacy Report Action -->
    <record id="action_report_ops_financial" model="ir.actions.report">
        <field name="name">Financial Report (Legacy)</field>
        <field name="model">ops.general.ledger.wizard.enhanced</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">ops_matrix_accounting.report_ops_financial_minimal</field>
        <field name="report_file">ops_matrix_accounting.report_ops_financial_minimal</field>
        <field name="binding_model_id" ref="model_ops_general_ledger_wizard_enhanced"/>
        <field name="print_report_name">'Financial_Report_%s_%s_%s' % (object.report_type, object.date_from, object.date_to)</field>
        <field name="paperformat_id" ref="ops_matrix_accounting.paperformat_ops_a4_financial"/>
    </record>

</odoo>
