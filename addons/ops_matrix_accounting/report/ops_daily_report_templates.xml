<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- ==================== CASH BOOK REPORT ==================== -->

    <record id="action_report_cash_book" model="ir.actions.report">
        <field name="name">Cash Book</field>
        <field name="model">ops.cash.book.wizard</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">ops_matrix_accounting.report_cash_book</field>
        <field name="report_file">ops_matrix_accounting.report_cash_book</field>
        <field name="print_report_name">'Cash_Book_%s_%s' % (object.date_from, object.date_to)</field>
        <field name="binding_type">report</field>
    </record>

    <template id="report_cash_book">
        <t t-call="web.html_container">
            <t t-call="web.external_layout">
                <div class="page">
                    <style>
                        .report-header { text-align: center; margin-bottom: 20px; }
                        .report-title { font-size: 18px; font-weight: bold; }
                        .report-subtitle { font-size: 14px; color: #666; }
                        .report-table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 11px; }
                        .report-table th { background-color: #4472C4; color: white; padding: 8px; text-align: left; border: 1px solid #ddd; }
                        .report-table td { padding: 6px 8px; border: 1px solid #ddd; }
                        .report-table tr:nth-child(even) { background-color: #f9f9f9; }
                        .report-table tr.total-row { background-color: #E2EFDA; font-weight: bold; }
                        .text-right { text-align: right; }
                        .text-center { text-align: center; }
                        .opening-balance { background-color: #FCE4D6; padding: 10px; margin-bottom: 10px; }
                        .closing-balance { background-color: #E2EFDA; padding: 10px; margin-top: 10px; font-weight: bold; }
                        .amount { font-family: monospace; }
                    </style>

                    <div class="report-header">
                        <div class="report-title">CASH BOOK</div>
                        <div class="report-subtitle">
                            <t t-esc="report_data['company']"/>
                        </div>
                        <div class="report-subtitle">
                            Period: <t t-esc="report_data['date_from']"/> to <t t-esc="report_data['date_to']"/>
                        </div>
                        <div class="report-subtitle">
                            Journals: <t t-esc="report_data['journals']"/> | Branches: <t t-esc="report_data['branches']"/>
                        </div>
                    </div>

                    <div class="opening-balance">
                        <strong>Opening Balance:</strong>
                        <span class="amount" t-esc="'%.2f' % report_data['opening_balance']"/>
                        <t t-esc="report_data['currency'].symbol"/>
                    </div>

                    <table class="report-table">
                        <thead>
                            <tr>
                                <th style="width: 10%;">Date</th>
                                <th style="width: 12%;">Reference</th>
                                <th style="width: 15%;">Partner</th>
                                <th style="width: 23%;">Description</th>
                                <th style="width: 12%;" class="text-right">Debit</th>
                                <th style="width: 12%;" class="text-right">Credit</th>
                                <th style="width: 14%;" class="text-right">Balance</th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-foreach="report_data['lines']" t-as="line">
                                <tr>
                                    <td><t t-esc="line['date']"/></td>
                                    <td><t t-esc="line['ref']"/></td>
                                    <td><t t-esc="line['partner']"/></td>
                                    <td><t t-esc="line['label']"/></td>
                                    <td class="text-right amount"><t t-esc="'%.2f' % line['debit']"/></td>
                                    <td class="text-right amount"><t t-esc="'%.2f' % line['credit']"/></td>
                                    <td class="text-right amount"><t t-esc="'%.2f' % line['balance']"/></td>
                                </tr>
                            </t>
                            <tr class="total-row">
                                <td colspan="4" class="text-right"><strong>TOTALS</strong></td>
                                <td class="text-right amount"><t t-esc="'%.2f' % report_data['total_debit']"/></td>
                                <td class="text-right amount"><t t-esc="'%.2f' % report_data['total_credit']"/></td>
                                <td class="text-right amount"><t t-esc="'%.2f' % report_data['closing_balance']"/></td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="closing-balance">
                        <strong>Closing Balance:</strong>
                        <span class="amount" t-esc="'%.2f' % report_data['closing_balance']"/>
                        <t t-esc="report_data['currency'].symbol"/>
                    </div>
                </div>
            </t>
        </t>
    </template>

    <!-- ==================== DAY BOOK REPORT ==================== -->

    <record id="action_report_day_book" model="ir.actions.report">
        <field name="name">Day Book</field>
        <field name="model">ops.day.book.wizard</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">ops_matrix_accounting.report_day_book</field>
        <field name="report_file">ops_matrix_accounting.report_day_book</field>
        <field name="print_report_name">'Day_Book_%s' % object.date</field>
        <field name="binding_type">report</field>
    </record>

    <template id="report_day_book">
        <t t-call="web.html_container">
            <t t-call="web.external_layout">
                <div class="page">
                    <style>
                        .report-header { text-align: center; margin-bottom: 20px; }
                        .report-title { font-size: 18px; font-weight: bold; }
                        .report-subtitle { font-size: 14px; color: #666; }
                        .journal-section { margin-bottom: 25px; }
                        .journal-header { background-color: #D9E1F2; padding: 10px; font-weight: bold; font-size: 13px; border-left: 4px solid #4472C4; }
                        .move-header { background-color: #FCE4D6; padding: 8px; font-weight: bold; margin-top: 10px; font-size: 12px; }
                        .report-table { width: 100%; border-collapse: collapse; margin-top: 5px; font-size: 11px; }
                        .report-table th { background-color: #E2EFDA; padding: 6px; text-align: left; border: 1px solid #ddd; }
                        .report-table td { padding: 5px 6px; border: 1px solid #ddd; }
                        .journal-total { background-color: #E2EFDA; padding: 8px; text-align: right; font-weight: bold; margin-top: 5px; }
                        .grand-total { background-color: #4472C4; color: white; padding: 12px; text-align: right; font-weight: bold; margin-top: 20px; font-size: 14px; }
                        .text-right { text-align: right; }
                        .amount { font-family: monospace; }
                    </style>

                    <div class="report-header">
                        <div class="report-title">DAY BOOK</div>
                        <div class="report-subtitle">
                            <t t-esc="report_data['company']"/>
                        </div>
                        <div class="report-subtitle">
                            Date: <t t-esc="report_data['date']"/>
                        </div>
                        <div class="report-subtitle">
                            Branches: <t t-esc="report_data['branches']"/>
                        </div>
                    </div>

                    <t t-foreach="report_data['journals_data']" t-as="journal">
                        <div class="journal-section">
                            <div class="journal-header">
                                Journal: <t t-esc="journal['journal']"/>
                            </div>

                            <t t-foreach="journal['moves']" t-as="move">
                                <div class="move-header">
                                    <t t-esc="move['name']"/>
                                    <t t-if="move['partner']"> - <t t-esc="move['partner']"/></t>
                                    <t t-if="move['ref']"> (<t t-esc="move['ref']"/>)</t>
                                </div>

                                <table class="report-table">
                                    <thead>
                                        <tr>
                                            <th style="width: 35%;">Account</th>
                                            <th style="width: 35%;">Description</th>
                                            <th style="width: 15%;" class="text-right">Debit</th>
                                            <th style="width: 15%;" class="text-right">Credit</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <t t-foreach="move['lines']" t-as="line">
                                            <tr>
                                                <td><t t-esc="line['account']"/></td>
                                                <td><t t-esc="line['label']"/></td>
                                                <td class="text-right amount"><t t-esc="'%.2f' % line['debit']"/></td>
                                                <td class="text-right amount"><t t-esc="'%.2f' % line['credit']"/></td>
                                            </tr>
                                        </t>
                                    </tbody>
                                </table>
                            </t>

                            <div class="journal-total">
                                Journal Total:
                                Debit <span class="amount"><t t-esc="'%.2f' % journal['total_debit']"/></span> |
                                Credit <span class="amount"><t t-esc="'%.2f' % journal['total_credit']"/></span>
                            </div>
                        </div>
                    </t>

                    <div class="grand-total">
                        GRAND TOTAL:
                        Debit <span class="amount"><t t-esc="'%.2f' % report_data['grand_total_debit']"/></span> |
                        Credit <span class="amount"><t t-esc="'%.2f' % report_data['grand_total_credit']"/></span>
                    </div>
                </div>
            </t>
        </t>
    </template>

    <!-- ==================== BANK BOOK REPORT ==================== -->

    <record id="action_report_bank_book" model="ir.actions.report">
        <field name="name">Bank Book</field>
        <field name="model">ops.bank.book.wizard</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">ops_matrix_accounting.report_bank_book</field>
        <field name="report_file">ops_matrix_accounting.report_bank_book</field>
        <field name="print_report_name">'Bank_Book_%s_%s' % (object.date_from, object.date_to)</field>
        <field name="binding_type">report</field>
    </record>

    <template id="report_bank_book">
        <t t-call="web.html_container">
            <t t-call="web.external_layout">
                <div class="page">
                    <style>
                        .report-header { text-align: center; margin-bottom: 20px; }
                        .report-title { font-size: 18px; font-weight: bold; }
                        .report-subtitle { font-size: 14px; color: #666; }
                        .bank-section { margin-bottom: 30px; page-break-inside: avoid; }
                        .bank-header { background-color: #4472C4; color: white; padding: 12px; font-weight: bold; font-size: 14px; }
                        .bank-account { font-size: 12px; font-weight: normal; }
                        .opening-balance { background-color: #FCE4D6; padding: 8px; margin-top: 5px; }
                        .report-table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 10px; }
                        .report-table th { background-color: #D9E1F2; padding: 6px; text-align: left; border: 1px solid #ddd; }
                        .report-table td { padding: 5px 6px; border: 1px solid #ddd; }
                        .report-table tr:nth-child(even) { background-color: #f9f9f9; }
                        .report-table tr.total-row { background-color: #E2EFDA; font-weight: bold; }
                        .closing-balance { background-color: #E2EFDA; padding: 8px; font-weight: bold; margin-top: 5px; }
                        .summary-section { margin-top: 30px; border-top: 2px solid #4472C4; padding-top: 20px; }
                        .summary-table { width: 60%; margin: 0 auto; }
                        .summary-table th { background-color: #4472C4; color: white; }
                        .summary-table tr.grand-total { background-color: #4472C4; color: white; font-weight: bold; }
                        .text-right { text-align: right; }
                        .text-center { text-align: center; }
                        .amount { font-family: monospace; }
                    </style>

                    <div class="report-header">
                        <div class="report-title">BANK BOOK</div>
                        <div class="report-subtitle">
                            <t t-esc="report_data['company']"/>
                        </div>
                        <div class="report-subtitle">
                            Period: <t t-esc="report_data['date_from']"/> to <t t-esc="report_data['date_to']"/>
                        </div>
                        <div class="report-subtitle">
                            Branches: <t t-esc="report_data['branches']"/>
                        </div>
                    </div>

                    <t t-foreach="report_data['banks_data']" t-as="bank">
                        <div class="bank-section">
                            <div class="bank-header">
                                <t t-esc="bank['journal']"/>
                                <span class="bank-account">(<t t-esc="bank['account']"/>)</span>
                            </div>

                            <div class="opening-balance">
                                <strong>Opening Balance:</strong>
                                <span class="amount"><t t-esc="'%.2f' % bank['opening_balance']"/></span>
                            </div>

                            <table class="report-table">
                                <thead>
                                    <tr>
                                        <th style="width: 10%;">Date</th>
                                        <th style="width: 12%;">Reference</th>
                                        <th style="width: 15%;">Partner</th>
                                        <th style="width: 23%;">Description</th>
                                        <th style="width: 12%;" class="text-right">Debit</th>
                                        <th style="width: 12%;" class="text-right">Credit</th>
                                        <th style="width: 14%;" class="text-right">Balance</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-foreach="bank['lines']" t-as="line">
                                        <tr>
                                            <td><t t-esc="line['date']"/></td>
                                            <td><t t-esc="line['ref']"/></td>
                                            <td><t t-esc="line['partner']"/></td>
                                            <td><t t-esc="line['label']"/></td>
                                            <td class="text-right amount"><t t-esc="'%.2f' % line['debit']"/></td>
                                            <td class="text-right amount"><t t-esc="'%.2f' % line['credit']"/></td>
                                            <td class="text-right amount"><t t-esc="'%.2f' % line['balance']"/></td>
                                        </tr>
                                    </t>
                                    <tr class="total-row">
                                        <td colspan="4" class="text-right"><strong>TOTALS</strong></td>
                                        <td class="text-right amount"><t t-esc="'%.2f' % bank['total_debit']"/></td>
                                        <td class="text-right amount"><t t-esc="'%.2f' % bank['total_credit']"/></td>
                                        <td class="text-right amount"><t t-esc="'%.2f' % bank['closing_balance']"/></td>
                                    </tr>
                                </tbody>
                            </table>

                            <div class="closing-balance">
                                <strong>Closing Balance:</strong>
                                <span class="amount"><t t-esc="'%.2f' % bank['closing_balance']"/></span>
                            </div>
                        </div>
                    </t>

                    <!-- Summary Section -->
                    <div class="summary-section">
                        <h3 class="text-center">SUMMARY</h3>
                        <table class="report-table summary-table">
                            <thead>
                                <tr>
                                    <th>Bank Account</th>
                                    <th class="text-right">Opening</th>
                                    <th class="text-right">Debit</th>
                                    <th class="text-right">Credit</th>
                                    <th class="text-right">Closing</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="report_data['banks_data']" t-as="bank">
                                    <tr>
                                        <td><t t-esc="bank['journal']"/></td>
                                        <td class="text-right amount"><t t-esc="'%.2f' % bank['opening_balance']"/></td>
                                        <td class="text-right amount"><t t-esc="'%.2f' % bank['total_debit']"/></td>
                                        <td class="text-right amount"><t t-esc="'%.2f' % bank['total_credit']"/></td>
                                        <td class="text-right amount"><t t-esc="'%.2f' % bank['closing_balance']"/></td>
                                    </tr>
                                </t>
                                <tr class="grand-total">
                                    <td><strong>GRAND TOTAL</strong></td>
                                    <td class="text-right amount"><t t-esc="'%.2f' % report_data['grand_opening']"/></td>
                                    <td class="text-right amount"><t t-esc="'%.2f' % report_data['grand_debit']"/></td>
                                    <td class="text-right amount"><t t-esc="'%.2f' % report_data['grand_credit']"/></td>
                                    <td class="text-right amount"><t t-esc="'%.2f' % report_data['grand_closing']"/></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </t>
        </t>
    </template>
</odoo>
