<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!--
        ================================================================
        OPS CORPORATE DAILY REPORTS — Wave 1 Redesign
        ================================================================
        wkhtmltopdf-compatible: NO flexbox, NO font-variant-numeric,
        NO external CSS dependency for critical styles.
        All layouts use tables/inline-block for QtWebKit ~534.

        REPORTS:
        1. Cash Book  — Portrait A4, 7 columns
        2. Day Book   — Portrait A4, grouped by journal
        3. Bank Book  — Portrait A4, grouped by bank account
    -->

    <!-- ==================== CASH BOOK REPORT ==================== -->

    <template id="report_cash_book_corporate">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">

                <!-- Color variables from Python parser -->
                <t t-set="pc" t-value="primary_color"/>
                <t t-set="tc" t-value="text_on_primary"/>
                <t t-set="pl" t-value="primary_light"/>
                <t t-set="pd" t-value="primary_dark"/>

                <t t-call="ops_matrix_accounting.ops_corporate_pdf_layout">

                    <style>
                        * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
                        @page { size: A4 portrait; margin: 15mm 12mm 25mm 12mm; }
                        .num { text-align: right; font-family: Consolas, Monaco, 'Courier New', monospace; }
                        .val-positive { color: #16a34a; }
                        .val-negative { color: #dc2626; }
                        .val-zero { color: #bbbbbb; }
                        .page-footer-fixed {
                            position: fixed;
                            bottom: 0;
                            left: 0;
                            right: 0;
                            padding: 6px 0 0 0;
                            border-top: 1px solid #e2e8f0;
                        }
                    </style>

                    <div class="page ops-report" t-attf-style="color: {{body_text_color}}; font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, Helvetica, sans-serif; font-size: 8.5pt; line-height: 1.45;">

                        <!-- ================================================
                             HEADER
                             ================================================ -->
                        <table width="100%" style="border-collapse: collapse; margin-bottom: 15px;" t-attf-style="border-bottom: 2px solid {{pc}}; padding-bottom: 10px;">
                            <tr>
                                <td style="vertical-align: middle; width: 60%;">
                                    <table style="border-collapse: collapse;">
                                        <tr>
                                            <t t-if="company.logo">
                                                <td style="vertical-align: middle; padding-right: 12px;">
                                                    <img t-att-src="image_data_uri(company.logo)"
                                                         style="max-height: 45px; max-width: 100px; border-radius: 6px; object-fit: contain;"
                                                         alt="Company Logo"/>
                                                </td>
                                            </t>
                                            <t t-else="">
                                                <td style="vertical-align: middle; padding-right: 12px;">
                                                    <div t-attf-style="width: 45px; height: 45px; border-radius: 6px; background: {{pc}}; color: {{tc}}; font-weight: 700; font-size: 14pt; text-align: center; line-height: 45px;">
                                                        <t t-esc="(company.name or 'CO')[:2].upper()"/>
                                                    </div>
                                                </td>
                                            </t>
                                            <td style="vertical-align: middle;">
                                                <div style="font-size: 14pt; font-weight: 700; color: #1e293b; line-height: 1.2;">
                                                    <t t-esc="company.name"/>
                                                </div>
                                                <div style="font-size: 8.5pt; color: #666666; margin-top: 1px;">
                                                    <t t-if="company.city"><t t-esc="company.city"/></t>
                                                    <t t-if="company.city and company.country_id">, </t>
                                                    <t t-esc="company.country_id.name or ''"/>
                                                </div>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                                <td style="vertical-align: top; width: 40%; text-align: right;">
                                    <div style="font-size: 8pt; color: #666666; line-height: 1.6;">
                                        Printed: <t t-esc="context_timestamp(datetime.datetime.now()).strftime('%d %b %Y %H:%M')"/><br/>
                                        Generated by: <t t-esc="user.name"/>
                                    </div>
                                    <div style="font-family: 'Courier New', monospace; font-size: 7pt; color: #94a3b8; letter-spacing: 0.3px; margin-top: 2px;">
                                        Report ID: <t t-esc="report_run_id"/>
                                    </div>
                                </td>
                            </tr>
                        </table>

                        <!-- ================================================
                             TITLE BLOCK
                             ================================================ -->
                        <div style="margin: 8px 0 4px 0;">
                            <div style="font-size: 16pt; font-weight: 700; color: #1e293b; margin-bottom: 4px;">
                                Cash Book
                            </div>
                            <div style="font-size: 8.5pt; color: #666666;">
                                <t t-esc="date_from"/> &#x2013; <t t-esc="date_to"/>
                                <span style="color: #94a3b8;"> | </span>
                                <t t-esc="currency_name"/>
                                <span style="color: #94a3b8;"> | </span>
                                <t t-if="target_move == 'posted'">Posted Entries</t>
                                <t t-else="">All Entries</t>
                                <span style="color: #94a3b8;"> | </span>
                                Journals: <t t-esc="journal_names"/>
                                <t t-if="branch_names != 'All'">
                                    <span style="color: #94a3b8;"> | </span>
                                    Branch: <t t-esc="branch_names"/>
                                </t>
                            </div>
                        </div>

                        <!-- ================================================
                             SUMMARY ROW
                             ================================================ -->
                        <table width="100%" style="border-collapse: collapse; margin: 12px 0 22px 0; border-radius: 4px;" t-attf-style="background: {{pl}};">
                            <tr>
                                <td style="padding: 12px 16px; vertical-align: top; width: 33%;">
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Total Receipts</div>
                                    <div style="font-size: 13pt; font-weight: 700; color: #1e293b; font-family: Consolas, Monaco, monospace;">
                                        <t t-esc="'{:,.2f}'.format(total_debit)"/>
                                    </div>
                                </td>
                                <td style="padding: 12px 16px; vertical-align: top; width: 33%;">
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Total Payments</div>
                                    <div style="font-size: 13pt; font-weight: 700; color: #1e293b; font-family: Consolas, Monaco, monospace;">
                                        <t t-esc="'{:,.2f}'.format(total_credit)"/>
                                    </div>
                                </td>
                                <td style="padding: 12px 16px; vertical-align: top; width: 34%;">
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Net Movement</div>
                                    <div style="font-size: 13pt; font-weight: 700; font-family: Consolas, Monaco, monospace;"
                                         t-att-style="'color: #16a34a;' if net_movement &gt;= 0 else 'color: #dc2626;'">
                                        <t t-if="net_movement &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(net_movement))"/>)</t>
                                        <t t-else=""><t t-esc="'{:,.2f}'.format(net_movement)"/></t>
                                    </div>
                                </td>
                            </tr>
                        </table>

                        <!-- ================================================
                             OPENING BALANCE
                             ================================================ -->
                        <table width="100%" style="border-collapse: collapse; margin-bottom: 2px;" t-attf-style="background: {{pl}}; border-left: 3px solid {{pc}};">
                            <tr>
                                <td style="padding: 7px 12px; vertical-align: middle;">
                                    <span t-attf-style="font-weight: 600; font-size: 9pt; color: {{pd}};">
                                        Opening Balance
                                    </span>
                                </td>
                                <td class="num" style="padding: 7px 12px; vertical-align: middle;">
                                    <span t-attf-style="font-weight: 700; font-size: 9pt; color: {{pd}}; font-family: Consolas, Monaco, monospace;">
                                        <t t-esc="'{:,.2f}'.format(opening_balance)"/>
                                    </span>
                                </td>
                            </tr>
                        </table>

                        <!-- ================================================
                             DATA TABLE
                             ================================================ -->
                        <table width="100%" style="border-collapse: collapse; font-size: 8pt; margin-bottom: 2px;">
                            <thead>
                                <tr>
                                    <th style="width: 10%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; border: none; border-bottom: 2px solid #1e293b; background: #f8fafc;">Date</th>
                                    <th style="width: 10%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; border: none; border-bottom: 2px solid #1e293b; background: #f8fafc;">Reference</th>
                                    <th style="width: 15%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; border: none; border-bottom: 2px solid #1e293b; background: #f8fafc;">Partner</th>
                                    <th style="width: 12%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; border: none; border-bottom: 2px solid #1e293b; background: #f8fafc;">Account</th>
                                    <th style="width: 21%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; border: none; border-bottom: 2px solid #1e293b; background: #f8fafc;">Description</th>
                                    <th class="num" style="width: 11%; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; border: none; border-bottom: 2px solid #1e293b; background: #f8fafc;">Debit (<t t-esc="currency_name"/>)</th>
                                    <th class="num" style="width: 11%; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; border: none; border-bottom: 2px solid #1e293b; background: #f8fafc;">Credit (<t t-esc="currency_name"/>)</th>
                                    <th class="num" style="width: 10%; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; border: none; border-bottom: 2px solid #1e293b; background: #f8fafc;">Balance (<t t-esc="currency_name"/>)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="lines" t-as="line">
                                    <tr t-att-style="'border-bottom: 1px solid #f1f5f9;' + (' background: #f8fafc;' if line_even else '')">
                                        <td style="padding: 5px 8px; white-space: nowrap;">
                                            <t t-esc="line.get('date', '')"/>
                                        </td>
                                        <td style="padding: 5px 8px; font-size: 7.5pt; color: #64748b;">
                                            <t t-esc="line.get('ref', '') or ''"/>
                                        </td>
                                        <td style="padding: 5px 8px;">
                                            <t t-esc="line.get('partner', '') or ''"/>
                                        </td>
                                        <td style="padding: 5px 8px; font-size: 7.5pt; color: #64748b;">
                                            <t t-esc="line.get('account', '')"/>
                                        </td>
                                        <td style="padding: 5px 8px;">
                                            <t t-esc="line.get('label', '')"/>
                                        </td>
                                        <!-- Debit -->
                                        <td class="num" style="padding: 5px 8px;">
                                            <t t-if="line.get('debit', 0) &gt; 0">
                                                <t t-esc="'{:,.2f}'.format(line['debit'])"/>
                                            </t>
                                            <t t-else="">
                                                <span class="val-zero">&#x2014;</span>
                                            </t>
                                        </td>
                                        <!-- Credit -->
                                        <td class="num" style="padding: 5px 8px;">
                                            <t t-if="line.get('credit', 0) &gt; 0">
                                                <t t-esc="'{:,.2f}'.format(line['credit'])"/>
                                            </t>
                                            <t t-else="">
                                                <span class="val-zero">&#x2014;</span>
                                            </t>
                                        </td>
                                        <!-- Running Balance -->
                                        <td class="num" style="padding: 5px 8px; font-weight: 500;">
                                            <t t-if="line.get('balance', 0) &lt; 0">
                                                <span class="val-negative">(<t t-esc="'{:,.2f}'.format(abs(line['balance']))"/>)</span>
                                            </t>
                                            <t t-elif="line.get('balance', 0) == 0">
                                                <span class="val-zero">&#x2014;</span>
                                            </t>
                                            <t t-else="">
                                                <span class="val-positive"><t t-esc="'{:,.2f}'.format(line['balance'])"/></span>
                                            </t>
                                        </td>
                                    </tr>
                                </t>

                                <!-- Empty State -->
                                <t t-if="not lines">
                                    <tr>
                                        <td colspan="8" style="text-align: center; padding: 15px; color: #94a3b8; font-style: italic;">
                                            No transactions in this period
                                        </td>
                                    </tr>
                                </t>

                                <!-- Account Total Row -->
                                <tr t-attf-style="font-weight: 600; background: {{pl}}; page-break-before: avoid;">
                                    <td colspan="5" t-attf-style="padding: 7px 8px; font-size: 8pt; color: {{pd}};">
                                        TOTALS
                                        <span style="font-size: 7pt; color: #94a3b8; font-weight: 400; margin-left: 8px;">
                                            <t t-esc="line_count"/> transactions
                                        </span>
                                    </td>
                                    <td class="num" t-attf-style="padding: 7px 8px; font-size: 8pt; color: {{pd}};">
                                        <t t-esc="'{:,.2f}'.format(total_debit)"/>
                                    </td>
                                    <td class="num" t-attf-style="padding: 7px 8px; font-size: 8pt; color: {{pd}};">
                                        <t t-esc="'{:,.2f}'.format(total_credit)"/>
                                    </td>
                                    <td class="num" t-attf-style="padding: 7px 8px; font-size: 8pt; color: {{pd}};"/>
                                </tr>
                            </tbody>
                        </table>

                        <!-- ================================================
                             GRAND TOTAL — CLOSING BALANCE
                             ================================================ -->
                        <div t-attf-style="margin-top: 4px; border-radius: 4px; overflow: hidden; background: {{pc}}; color: {{tc}}; page-break-inside: avoid;">
                            <table width="100%" style="border-collapse: collapse;">
                                <tr>
                                    <td style="width: 50%; padding: 13px 8px 13px 14px; font-weight: 600; font-size: 9pt; text-transform: uppercase; letter-spacing: 0.3px; border: none;">
                                        CLOSING BALANCE
                                    </td>
                                    <td class="num" style="width: 50%; padding: 13px 8px; font-weight: 700; font-size: 10pt; border: none;">
                                        <t t-if="closing_balance &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(closing_balance))"/>)</t>
                                        <t t-else=""><t t-esc="'{:,.2f}'.format(closing_balance)"/></t>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <!-- ================================================
                             SIGNATURE BLOCK
                             ================================================ -->
                        <div style="margin-top: 28px; page-break-inside: avoid;">
                            <table width="100%" style="border-collapse: collapse; border: none;">
                                <tr style="border: none;">
                                    <td style="border: none; width: 33%; padding: 0 16px 0 0;">
                                        <div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">
                                            Prepared by
                                        </div>
                                        <div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">
                                            Name / Date
                                        </div>
                                    </td>
                                    <td style="border: none; width: 33%; padding: 0 16px; border-left: 1px solid #e2e8f0;">
                                        <div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">
                                            Reviewed by
                                        </div>
                                        <div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">
                                            Name / Date
                                        </div>
                                    </td>
                                    <td style="border: none; width: 33%; padding: 0 0 0 16px; border-left: 1px solid #e2e8f0;">
                                        <div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">
                                            Approved by
                                        </div>
                                        <div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">
                                            Name / Date
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <!-- ================================================
                             FIXED FOOTER
                             ================================================ -->
                        <div class="page-footer-fixed">
                            <table style="width: 100%; border-collapse: collapse;">
                                <tr>
                                    <td style="width: 50%; text-align: left; vertical-align: middle; padding: 4px 0;">
                                        <span style="font-size: 8pt; color: #666666;">Powered by</span>
                                        <img src="/ops_matrix_accounting/static/src/img/ops_badge_footer.png"
                                             style="height: 16px; vertical-align: middle; margin-left: 4px;"
                                             alt="OPS Framework"/>
                                    </td>
                                    <td style="width: 50%; text-align: right; vertical-align: middle; padding: 4px 0;">
                                        <span style="font-size: 6.5pt; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.5px;">
                                            Confidential &#x2014; For authorized personnel only
                                        </span>
                                    </td>
                                </tr>
                            </table>
                        </div>

                    </div>
                </t>
            </t>
        </t>
    </template>

    <record id="action_report_cash_book" model="ir.actions.report">
        <field name="name">Cash Book</field>
        <field name="model">ops.cash.book.wizard</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">ops_matrix_accounting.report_cash_book_corporate</field>
        <field name="report_file">ops_matrix_accounting.report_cash_book_corporate</field>
        <field name="print_report_name">'Cash_Book_%s_%s' % (object.date_from, object.date_to)</field>
        <field name="binding_type">report</field>
        <field name="paperformat_id" ref="paperformat_ops_corporate_a4"/>
    </record>


    <!-- ==================== DAY BOOK REPORT ==================== -->

    <template id="report_day_book_corporate">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">

                <!-- Color variables from Python parser -->
                <t t-set="pc" t-value="primary_color"/>
                <t t-set="tc" t-value="text_on_primary"/>
                <t t-set="pl" t-value="primary_light"/>
                <t t-set="pd" t-value="primary_dark"/>

                <t t-call="ops_matrix_accounting.ops_corporate_pdf_layout">

                    <style>
                        * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
                        @page { size: A4 portrait; margin: 15mm 12mm 25mm 12mm; }
                        .num { text-align: right; font-family: Consolas, Monaco, 'Courier New', monospace; }
                        .val-positive { color: #16a34a; }
                        .val-negative { color: #dc2626; }
                        .val-zero { color: #bbbbbb; }
                        .page-footer-fixed {
                            position: fixed;
                            bottom: 0;
                            left: 0;
                            right: 0;
                            padding: 6px 0 0 0;
                            border-top: 1px solid #e2e8f0;
                        }
                    </style>

                    <div class="page ops-report" t-attf-style="color: {{body_text_color}}; font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, Helvetica, sans-serif; font-size: 8.5pt; line-height: 1.45;">

                        <!-- ================================================
                             HEADER
                             ================================================ -->
                        <table width="100%" style="border-collapse: collapse; margin-bottom: 15px;" t-attf-style="border-bottom: 2px solid {{pc}}; padding-bottom: 10px;">
                            <tr>
                                <td style="vertical-align: middle; width: 60%;">
                                    <table style="border-collapse: collapse;">
                                        <tr>
                                            <t t-if="company.logo">
                                                <td style="vertical-align: middle; padding-right: 12px;">
                                                    <img t-att-src="image_data_uri(company.logo)"
                                                         style="max-height: 45px; max-width: 100px; border-radius: 6px; object-fit: contain;"
                                                         alt="Company Logo"/>
                                                </td>
                                            </t>
                                            <t t-else="">
                                                <td style="vertical-align: middle; padding-right: 12px;">
                                                    <div t-attf-style="width: 45px; height: 45px; border-radius: 6px; background: {{pc}}; color: {{tc}}; font-weight: 700; font-size: 14pt; text-align: center; line-height: 45px;">
                                                        <t t-esc="(company.name or 'CO')[:2].upper()"/>
                                                    </div>
                                                </td>
                                            </t>
                                            <td style="vertical-align: middle;">
                                                <div style="font-size: 14pt; font-weight: 700; color: #1e293b; line-height: 1.2;">
                                                    <t t-esc="company.name"/>
                                                </div>
                                                <div style="font-size: 8.5pt; color: #666666; margin-top: 1px;">
                                                    <t t-if="company.city"><t t-esc="company.city"/></t>
                                                    <t t-if="company.city and company.country_id">, </t>
                                                    <t t-esc="company.country_id.name or ''"/>
                                                </div>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                                <td style="vertical-align: top; width: 40%; text-align: right;">
                                    <div style="font-size: 8pt; color: #666666; line-height: 1.6;">
                                        Printed: <t t-esc="context_timestamp(datetime.datetime.now()).strftime('%d %b %Y %H:%M')"/><br/>
                                        Generated by: <t t-esc="user.name"/>
                                    </div>
                                    <div style="font-family: 'Courier New', monospace; font-size: 7pt; color: #94a3b8; letter-spacing: 0.3px; margin-top: 2px;">
                                        Report ID: <t t-esc="report_run_id"/>
                                    </div>
                                </td>
                            </tr>
                        </table>

                        <!-- ================================================
                             TITLE BLOCK
                             ================================================ -->
                        <div style="margin: 8px 0 4px 0;">
                            <div style="font-size: 16pt; font-weight: 700; color: #1e293b; margin-bottom: 4px;">
                                Day Book
                            </div>
                            <div style="font-size: 8.5pt; color: #666666;">
                                <t t-esc="report_date_long"/>
                                <span style="color: #94a3b8;"> | </span>
                                <t t-esc="currency_name"/>
                                <span style="color: #94a3b8;"> | </span>
                                <t t-if="target_move == 'posted'">Posted Entries</t>
                                <t t-else="">All Entries</t>
                                <t t-if="journal_filter != 'All'">
                                    <span style="color: #94a3b8;"> | </span>
                                    Journals: <t t-esc="journal_filter"/>
                                </t>
                                <t t-if="branch_names != 'All'">
                                    <span style="color: #94a3b8;"> | </span>
                                    Branch: <t t-esc="branch_names"/>
                                </t>
                            </div>
                        </div>

                        <!-- ================================================
                             SUMMARY ROW
                             ================================================ -->
                        <table width="100%" style="border-collapse: collapse; margin: 12px 0 22px 0; border-radius: 4px;" t-attf-style="background: {{pl}};">
                            <tr>
                                <td style="padding: 12px 16px; vertical-align: top; width: 33%;">
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Total Debit</div>
                                    <div style="font-size: 13pt; font-weight: 700; color: #1e293b; font-family: Consolas, Monaco, monospace;">
                                        <t t-esc="'{:,.2f}'.format(grand_total_debit)"/>
                                    </div>
                                </td>
                                <td style="padding: 12px 16px; vertical-align: top; width: 33%;">
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Total Credit</div>
                                    <div style="font-size: 13pt; font-weight: 700; color: #1e293b; font-family: Consolas, Monaco, monospace;">
                                        <t t-esc="'{:,.2f}'.format(grand_total_credit)"/>
                                    </div>
                                </td>
                                <td style="padding: 12px 16px; vertical-align: top; width: 34%;">
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Journals</div>
                                    <div style="font-size: 13pt; font-weight: 700; color: #1e293b;">
                                        <t t-esc="journal_count"/>
                                    </div>
                                </td>
                            </tr>
                        </table>

                        <!-- ================================================
                             JOURNAL SECTIONS
                             ================================================ -->
                        <t t-foreach="journals_data" t-as="journal">
                            <!-- Journal Header -->
                            <div style="page-break-after: avoid;">
                                <table width="100%" style="border-collapse: collapse;" t-attf-style="margin-top: 20px; margin-bottom: 0; background: {{pl}}; border-left: 3px solid {{pc}};">
                                    <tr>
                                        <td style="padding: 7px 12px; vertical-align: middle;">
                                            <span t-attf-style="font-weight: 600; font-size: 9pt; color: {{pd}};">
                                                <t t-esc="journal.get('journal', '')"/>
                                            </span>
                                            <span style="font-size: 7pt; color: #94a3b8; font-weight: 400; margin-left: 8px;">
                                                <t t-esc="journal.get('journal_code', '')"/>
                                            </span>
                                        </td>
                                        <td style="padding: 7px 12px; text-align: right; vertical-align: middle; font-size: 7.5pt; color: #94a3b8;">
                                            <t t-esc="len(journal.get('moves', []))"/> entries
                                        </td>
                                    </tr>
                                </table>
                            </div>

                            <!-- Moves within this journal -->
                            <t t-foreach="journal.get('moves', [])" t-as="move">
                                <!-- Move header row -->
                                <table width="100%" style="border-collapse: collapse; margin-top: 8px; margin-bottom: 0;">
                                    <tr style="background: #fefce8;">
                                        <td style="padding: 5px 8px; font-weight: 600; font-size: 8pt; color: #92400e;">
                                            <t t-esc="move.get('name', '')"/>
                                            <t t-if="move.get('partner')">
                                                <span style="font-weight: 400; color: #666666;"> &#x2014; <t t-esc="move['partner']"/></span>
                                            </t>
                                        </td>
                                        <td style="padding: 5px 8px; text-align: right; font-size: 7.5pt; color: #94a3b8;">
                                            <t t-if="move.get('ref')"><t t-esc="move['ref']"/></t>
                                        </td>
                                    </tr>
                                </table>

                                <!-- Move lines table -->
                                <table width="100%" style="border-collapse: collapse; font-size: 8pt; margin-bottom: 2px;">
                                    <thead>
                                        <tr>
                                            <th style="width: 30%; padding: 5px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; border: none; border-bottom: 1px solid #e2e8f0; background: #f8fafc;">Account</th>
                                            <th style="width: 38%; padding: 5px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; border: none; border-bottom: 1px solid #e2e8f0; background: #f8fafc;">Description</th>
                                            <th class="num" style="width: 16%; padding: 5px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; border: none; border-bottom: 1px solid #e2e8f0; background: #f8fafc;">Debit (<t t-esc="currency_name"/>)</th>
                                            <th class="num" style="width: 16%; padding: 5px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; border: none; border-bottom: 1px solid #e2e8f0; background: #f8fafc;">Credit (<t t-esc="currency_name"/>)</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <t t-foreach="move.get('lines', [])" t-as="line">
                                            <tr t-att-style="'border-bottom: 1px solid #f1f5f9;' + (' background: #f8fafc;' if line_even else '')">
                                                <td style="padding: 5px 8px;">
                                                    <t t-esc="line.get('account', '')"/>
                                                </td>
                                                <td style="padding: 5px 8px;">
                                                    <t t-esc="line.get('label', '')"/>
                                                </td>
                                                <td class="num" style="padding: 5px 8px;">
                                                    <t t-if="line.get('debit', 0) &gt; 0">
                                                        <t t-esc="'{:,.2f}'.format(line['debit'])"/>
                                                    </t>
                                                    <t t-else="">
                                                        <span class="val-zero">&#x2014;</span>
                                                    </t>
                                                </td>
                                                <td class="num" style="padding: 5px 8px;">
                                                    <t t-if="line.get('credit', 0) &gt; 0">
                                                        <t t-esc="'{:,.2f}'.format(line['credit'])"/>
                                                    </t>
                                                    <t t-else="">
                                                        <span class="val-zero">&#x2014;</span>
                                                    </t>
                                                </td>
                                            </tr>
                                        </t>
                                    </tbody>
                                </table>
                            </t>

                            <!-- Journal total -->
                            <table width="100%" style="border-collapse: collapse; margin-bottom: 4px;">
                                <tr t-attf-style="font-weight: 600; background: {{pl}};">
                                    <td style="width: 68%; padding: 7px 8px; font-size: 8pt;" t-attf-style="color: {{pd}};">
                                        Journal Total: <t t-esc="journal.get('journal', '')"/>
                                    </td>
                                    <td class="num" style="width: 16%; padding: 7px 8px; font-size: 8pt;" t-attf-style="color: {{pd}};">
                                        <t t-esc="'{:,.2f}'.format(journal.get('total_debit', 0))"/>
                                    </td>
                                    <td class="num" style="width: 16%; padding: 7px 8px; font-size: 8pt;" t-attf-style="color: {{pd}};">
                                        <t t-esc="'{:,.2f}'.format(journal.get('total_credit', 0))"/>
                                    </td>
                                </tr>
                            </table>
                        </t>

                        <!-- ================================================
                             GRAND TOTAL
                             ================================================ -->
                        <div t-attf-style="margin-top: 24px; border-radius: 4px; overflow: hidden; background: {{pc}}; color: {{tc}}; page-break-inside: avoid;">
                            <table width="100%" style="border-collapse: collapse;">
                                <tr>
                                    <td style="width: 68%; padding: 13px 8px 13px 14px; font-weight: 600; font-size: 9pt; text-transform: uppercase; letter-spacing: 0.3px; border: none;">
                                        GRAND TOTAL
                                    </td>
                                    <td class="num" style="width: 16%; padding: 13px 8px; font-weight: 700; font-size: 10pt; border: none;">
                                        <t t-esc="'{:,.2f}'.format(grand_total_debit)"/>
                                    </td>
                                    <td class="num" style="width: 16%; padding: 13px 8px; font-weight: 700; font-size: 10pt; border: none;">
                                        <t t-esc="'{:,.2f}'.format(grand_total_credit)"/>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <!-- ================================================
                             SIGNATURE BLOCK
                             ================================================ -->
                        <div style="margin-top: 28px; page-break-inside: avoid;">
                            <table width="100%" style="border-collapse: collapse; border: none;">
                                <tr style="border: none;">
                                    <td style="border: none; width: 33%; padding: 0 16px 0 0;">
                                        <div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">
                                            Prepared by
                                        </div>
                                        <div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">
                                            Name / Date
                                        </div>
                                    </td>
                                    <td style="border: none; width: 33%; padding: 0 16px; border-left: 1px solid #e2e8f0;">
                                        <div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">
                                            Reviewed by
                                        </div>
                                        <div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">
                                            Name / Date
                                        </div>
                                    </td>
                                    <td style="border: none; width: 33%; padding: 0 0 0 16px; border-left: 1px solid #e2e8f0;">
                                        <div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">
                                            Approved by
                                        </div>
                                        <div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">
                                            Name / Date
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <!-- ================================================
                             FIXED FOOTER
                             ================================================ -->
                        <div class="page-footer-fixed">
                            <table style="width: 100%; border-collapse: collapse;">
                                <tr>
                                    <td style="width: 50%; text-align: left; vertical-align: middle; padding: 4px 0;">
                                        <span style="font-size: 8pt; color: #666666;">Powered by</span>
                                        <img src="/ops_matrix_accounting/static/src/img/ops_badge_footer.png"
                                             style="height: 16px; vertical-align: middle; margin-left: 4px;"
                                             alt="OPS Framework"/>
                                    </td>
                                    <td style="width: 50%; text-align: right; vertical-align: middle; padding: 4px 0;">
                                        <span style="font-size: 6.5pt; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.5px;">
                                            Confidential &#x2014; For authorized personnel only
                                        </span>
                                    </td>
                                </tr>
                            </table>
                        </div>

                    </div>
                </t>
            </t>
        </t>
    </template>

    <record id="action_report_day_book" model="ir.actions.report">
        <field name="name">Day Book</field>
        <field name="model">ops.day.book.wizard</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">ops_matrix_accounting.report_day_book_corporate</field>
        <field name="report_file">ops_matrix_accounting.report_day_book_corporate</field>
        <field name="print_report_name">'Day_Book_%s' % object.date</field>
        <field name="binding_type">report</field>
        <field name="paperformat_id" ref="paperformat_ops_corporate_a4"/>
    </record>


    <!-- ==================== BANK BOOK REPORT ==================== -->

    <template id="report_bank_book_corporate">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">

                <!-- Color variables from Python parser -->
                <t t-set="pc" t-value="primary_color"/>
                <t t-set="tc" t-value="text_on_primary"/>
                <t t-set="pl" t-value="primary_light"/>
                <t t-set="pd" t-value="primary_dark"/>

                <t t-call="ops_matrix_accounting.ops_corporate_pdf_layout">

                    <style>
                        * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
                        @page { size: A4 portrait; margin: 15mm 12mm 25mm 12mm; }
                        .num { text-align: right; font-family: Consolas, Monaco, 'Courier New', monospace; }
                        .val-positive { color: #16a34a; }
                        .val-negative { color: #dc2626; }
                        .val-zero { color: #bbbbbb; }
                        .page-footer-fixed {
                            position: fixed;
                            bottom: 0;
                            left: 0;
                            right: 0;
                            padding: 6px 0 0 0;
                            border-top: 1px solid #e2e8f0;
                        }
                    </style>

                    <div class="page ops-report" t-attf-style="color: {{body_text_color}}; font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, Helvetica, sans-serif; font-size: 8.5pt; line-height: 1.45;">

                        <!-- ================================================
                             HEADER
                             ================================================ -->
                        <table width="100%" style="border-collapse: collapse; margin-bottom: 15px;" t-attf-style="border-bottom: 2px solid {{pc}}; padding-bottom: 10px;">
                            <tr>
                                <td style="vertical-align: middle; width: 60%;">
                                    <table style="border-collapse: collapse;">
                                        <tr>
                                            <t t-if="company.logo">
                                                <td style="vertical-align: middle; padding-right: 12px;">
                                                    <img t-att-src="image_data_uri(company.logo)"
                                                         style="max-height: 45px; max-width: 100px; border-radius: 6px; object-fit: contain;"
                                                         alt="Company Logo"/>
                                                </td>
                                            </t>
                                            <t t-else="">
                                                <td style="vertical-align: middle; padding-right: 12px;">
                                                    <div t-attf-style="width: 45px; height: 45px; border-radius: 6px; background: {{pc}}; color: {{tc}}; font-weight: 700; font-size: 14pt; text-align: center; line-height: 45px;">
                                                        <t t-esc="(company.name or 'CO')[:2].upper()"/>
                                                    </div>
                                                </td>
                                            </t>
                                            <td style="vertical-align: middle;">
                                                <div style="font-size: 14pt; font-weight: 700; color: #1e293b; line-height: 1.2;">
                                                    <t t-esc="company.name"/>
                                                </div>
                                                <div style="font-size: 8.5pt; color: #666666; margin-top: 1px;">
                                                    <t t-if="company.city"><t t-esc="company.city"/></t>
                                                    <t t-if="company.city and company.country_id">, </t>
                                                    <t t-esc="company.country_id.name or ''"/>
                                                </div>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                                <td style="vertical-align: top; width: 40%; text-align: right;">
                                    <div style="font-size: 8pt; color: #666666; line-height: 1.6;">
                                        Printed: <t t-esc="context_timestamp(datetime.datetime.now()).strftime('%d %b %Y %H:%M')"/><br/>
                                        Generated by: <t t-esc="user.name"/>
                                    </div>
                                    <div style="font-family: 'Courier New', monospace; font-size: 7pt; color: #94a3b8; letter-spacing: 0.3px; margin-top: 2px;">
                                        Report ID: <t t-esc="report_run_id"/>
                                    </div>
                                </td>
                            </tr>
                        </table>

                        <!-- ================================================
                             TITLE BLOCK
                             ================================================ -->
                        <div style="margin: 8px 0 4px 0;">
                            <div style="font-size: 16pt; font-weight: 700; color: #1e293b; margin-bottom: 4px;">
                                Bank Book
                            </div>
                            <div style="font-size: 8.5pt; color: #666666;">
                                <t t-esc="date_from"/> &#x2013; <t t-esc="date_to"/>
                                <span style="color: #94a3b8;"> | </span>
                                <t t-esc="currency_name"/>
                                <span style="color: #94a3b8;"> | </span>
                                <t t-if="target_move == 'posted'">Posted Entries</t>
                                <t t-else="">All Entries</t>
                                <span style="color: #94a3b8;"> | </span>
                                Journals: <t t-esc="journal_names"/>
                                <t t-if="branch_names != 'All'">
                                    <span style="color: #94a3b8;"> | </span>
                                    Branch: <t t-esc="branch_names"/>
                                </t>
                            </div>
                        </div>

                        <!-- ================================================
                             SUMMARY ROW
                             ================================================ -->
                        <table width="100%" style="border-collapse: collapse; margin: 12px 0 22px 0; border-radius: 4px;" t-attf-style="background: {{pl}};">
                            <tr>
                                <td style="padding: 12px 16px; vertical-align: top; width: 25%;">
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Opening</div>
                                    <div style="font-size: 13pt; font-weight: 700; color: #1e293b; font-family: Consolas, Monaco, monospace;">
                                        <t t-esc="'{:,.2f}'.format(grand_opening)"/>
                                    </div>
                                </td>
                                <td style="padding: 12px 16px; vertical-align: top; width: 25%;">
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Total Debit</div>
                                    <div style="font-size: 13pt; font-weight: 700; color: #1e293b; font-family: Consolas, Monaco, monospace;">
                                        <t t-esc="'{:,.2f}'.format(grand_debit)"/>
                                    </div>
                                </td>
                                <td style="padding: 12px 16px; vertical-align: top; width: 25%;">
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Total Credit</div>
                                    <div style="font-size: 13pt; font-weight: 700; color: #1e293b; font-family: Consolas, Monaco, monospace;">
                                        <t t-esc="'{:,.2f}'.format(grand_credit)"/>
                                    </div>
                                </td>
                                <td style="padding: 12px 16px; vertical-align: top; width: 25%;">
                                    <div t-attf-style="font-size: 8pt; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 600; color: {{pd}}; margin-bottom: 2px;">Closing</div>
                                    <div style="font-size: 13pt; font-weight: 700; color: #1e293b; font-family: Consolas, Monaco, monospace;">
                                        <t t-esc="'{:,.2f}'.format(grand_closing)"/>
                                    </div>
                                </td>
                            </tr>
                        </table>

                        <!-- ================================================
                             BANK ACCOUNT SECTIONS
                             ================================================ -->
                        <t t-foreach="banks_data" t-as="bank">
                            <!-- Bank Header -->
                            <div style="page-break-after: avoid;">
                                <table width="100%" style="border-collapse: collapse;" t-attf-style="margin-top: 20px; margin-bottom: 0; background: {{pl}}; border-left: 3px solid {{pc}};">
                                    <tr>
                                        <td style="padding: 7px 12px; vertical-align: middle;">
                                            <span t-attf-style="font-weight: 600; font-size: 9pt; color: {{pd}};">
                                                <t t-esc="bank.get('journal', '')"/>
                                            </span>
                                            <span style="font-size: 7.5pt; color: #94a3b8; font-weight: 400; margin-left: 8px;">
                                                (<t t-esc="bank.get('account', '')"/>)
                                            </span>
                                        </td>
                                        <td style="padding: 7px 12px; text-align: right; vertical-align: middle;">
                                            <span style="font-size: 8pt; color: #666666;">Opening: </span>
                                            <span style="font-weight: 600; font-size: 8.5pt; font-family: Consolas, Monaco, monospace;" t-attf-style="color: {{pd}};">
                                                <t t-esc="'{:,.2f}'.format(bank.get('opening_balance', 0))"/>
                                            </span>
                                        </td>
                                    </tr>
                                </table>
                            </div>

                            <!-- Data Table -->
                            <table width="100%" style="border-collapse: collapse; font-size: 8pt; margin-bottom: 2px;">
                                <thead>
                                    <tr>
                                        <th style="width: 10%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; border: none; border-bottom: 2px solid #1e293b; background: #f8fafc;">Date</th>
                                        <th style="width: 10%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; border: none; border-bottom: 2px solid #1e293b; background: #f8fafc;">Reference</th>
                                        <th style="width: 15%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; border: none; border-bottom: 2px solid #1e293b; background: #f8fafc;">Partner</th>
                                        <th style="width: 12%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; border: none; border-bottom: 2px solid #1e293b; background: #f8fafc;">Account</th>
                                        <th style="width: 21%; padding: 7px 8px; text-align: left; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; border: none; border-bottom: 2px solid #1e293b; background: #f8fafc;">Description</th>
                                        <th class="num" style="width: 11%; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; border: none; border-bottom: 2px solid #1e293b; background: #f8fafc;">Debit (<t t-esc="currency_name"/>)</th>
                                        <th class="num" style="width: 11%; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; border: none; border-bottom: 2px solid #1e293b; background: #f8fafc;">Credit (<t t-esc="currency_name"/>)</th>
                                        <th class="num" style="width: 10%; padding: 7px 8px; font-weight: 600; font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; color: #666666; border: none; border-bottom: 2px solid #1e293b; background: #f8fafc;">Balance (<t t-esc="currency_name"/>)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-foreach="bank.get('lines', [])" t-as="line">
                                        <tr t-att-style="'border-bottom: 1px solid #f1f5f9;' + (' background: #f8fafc;' if line_even else '')">
                                            <td style="padding: 5px 8px; white-space: nowrap;">
                                                <t t-esc="line.get('date', '')"/>
                                            </td>
                                            <td style="padding: 5px 8px; font-size: 7.5pt; color: #64748b;">
                                                <t t-esc="line.get('ref', '') or ''"/>
                                            </td>
                                            <td style="padding: 5px 8px;">
                                                <t t-esc="line.get('partner', '') or ''"/>
                                            </td>
                                            <td style="padding: 5px 8px; font-size: 7.5pt; color: #64748b;">
                                                <t t-esc="line.get('account', '')"/>
                                            </td>
                                            <td style="padding: 5px 8px;">
                                                <t t-esc="line.get('label', '')"/>
                                            </td>
                                            <!-- Debit -->
                                            <td class="num" style="padding: 5px 8px;">
                                                <t t-if="line.get('debit', 0) &gt; 0">
                                                    <t t-esc="'{:,.2f}'.format(line['debit'])"/>
                                                </t>
                                                <t t-else="">
                                                    <span class="val-zero">&#x2014;</span>
                                                </t>
                                            </td>
                                            <!-- Credit -->
                                            <td class="num" style="padding: 5px 8px;">
                                                <t t-if="line.get('credit', 0) &gt; 0">
                                                    <t t-esc="'{:,.2f}'.format(line['credit'])"/>
                                                </t>
                                                <t t-else="">
                                                    <span class="val-zero">&#x2014;</span>
                                                </t>
                                            </td>
                                            <!-- Running Balance -->
                                            <td class="num" style="padding: 5px 8px; font-weight: 500;">
                                                <t t-if="line.get('balance', 0) &lt; 0">
                                                    <span class="val-negative">(<t t-esc="'{:,.2f}'.format(abs(line['balance']))"/>)</span>
                                                </t>
                                                <t t-elif="line.get('balance', 0) == 0">
                                                    <span class="val-zero">&#x2014;</span>
                                                </t>
                                                <t t-else="">
                                                    <span class="val-positive"><t t-esc="'{:,.2f}'.format(line['balance'])"/></span>
                                                </t>
                                            </td>
                                        </tr>
                                    </t>

                                    <!-- Empty State -->
                                    <t t-if="not bank.get('lines')">
                                        <tr>
                                            <td colspan="8" style="text-align: center; padding: 15px; color: #94a3b8; font-style: italic;">
                                                No transactions in this period
                                            </td>
                                        </tr>
                                    </t>

                                    <!-- Bank Total Row -->
                                    <tr t-attf-style="font-weight: 600; background: {{pl}}; page-break-before: avoid;">
                                        <td colspan="5" t-attf-style="padding: 7px 8px; font-size: 8pt; color: {{pd}};">
                                            Total <t t-esc="bank.get('journal', '')"/>
                                            <span style="font-size: 7pt; color: #94a3b8; font-weight: 400; margin-left: 8px;">
                                                <t t-esc="len(bank.get('lines', []))"/> txn
                                            </span>
                                        </td>
                                        <td class="num" t-attf-style="padding: 7px 8px; font-size: 8pt; color: {{pd}};">
                                            <t t-esc="'{:,.2f}'.format(bank.get('total_debit', 0))"/>
                                        </td>
                                        <td class="num" t-attf-style="padding: 7px 8px; font-size: 8pt; color: {{pd}};">
                                            <t t-esc="'{:,.2f}'.format(bank.get('total_credit', 0))"/>
                                        </td>
                                        <td class="num" t-attf-style="padding: 7px 8px; font-size: 8pt; font-weight: 700; color: {{pd}};">
                                            <t t-set="cb" t-value="bank.get('closing_balance', 0)"/>
                                            <t t-if="cb &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(cb))"/>)</t>
                                            <t t-else=""><t t-esc="'{:,.2f}'.format(cb)"/></t>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </t>

                        <!-- ================================================
                             GRAND TOTAL
                             ================================================ -->
                        <div t-attf-style="margin-top: 24px; border-radius: 4px; overflow: hidden; background: {{pc}}; color: {{tc}}; page-break-inside: avoid;">
                            <table width="100%" style="border-collapse: collapse;">
                                <tr>
                                    <td style="width: 45%; padding: 13px 8px 13px 14px; font-weight: 600; font-size: 9pt; text-transform: uppercase; letter-spacing: 0.3px; border: none;">
                                        GRAND TOTAL &#x2014; <t t-esc="bank_count"/> Accounts
                                    </td>
                                    <td class="num" style="width: 18%; padding: 13px 8px; border: none;">
                                        <div style="font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; margin-bottom: 1px;">Debit</div>
                                        <div style="font-weight: 700; font-size: 10pt;">
                                            <t t-esc="'{:,.2f}'.format(grand_debit)"/>
                                        </div>
                                    </td>
                                    <td class="num" style="width: 18%; padding: 13px 8px; border: none;">
                                        <div style="font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; margin-bottom: 1px;">Credit</div>
                                        <div style="font-weight: 700; font-size: 10pt;">
                                            <t t-esc="'{:,.2f}'.format(grand_credit)"/>
                                        </div>
                                    </td>
                                    <td class="num" style="width: 19%; padding: 13px 8px; border: none;">
                                        <div style="font-size: 7pt; text-transform: uppercase; letter-spacing: 0.3px; margin-bottom: 1px;">Closing</div>
                                        <div style="font-weight: 700; font-size: 10pt;">
                                            <t t-if="grand_closing &lt; 0">(<t t-esc="'{:,.2f}'.format(abs(grand_closing))"/>)</t>
                                            <t t-else=""><t t-esc="'{:,.2f}'.format(grand_closing)"/></t>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <!-- ================================================
                             SIGNATURE BLOCK
                             ================================================ -->
                        <div style="margin-top: 28px; page-break-inside: avoid;">
                            <table width="100%" style="border-collapse: collapse; border: none;">
                                <tr style="border: none;">
                                    <td style="border: none; width: 33%; padding: 0 16px 0 0;">
                                        <div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">
                                            Prepared by
                                        </div>
                                        <div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">
                                            Name / Date
                                        </div>
                                    </td>
                                    <td style="border: none; width: 33%; padding: 0 16px; border-left: 1px solid #e2e8f0;">
                                        <div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">
                                            Reviewed by
                                        </div>
                                        <div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">
                                            Name / Date
                                        </div>
                                    </td>
                                    <td style="border: none; width: 33%; padding: 0 0 0 16px; border-left: 1px solid #e2e8f0;">
                                        <div style="font-size: 7.5pt; text-transform: uppercase; letter-spacing: 0.3px; color: #94a3b8; font-weight: 600; margin-bottom: 24px;">
                                            Approved by
                                        </div>
                                        <div style="border-top: 1px solid #cbd5e1; padding-top: 4px; font-size: 7.5pt; color: #666666;">
                                            Name / Date
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <!-- ================================================
                             FIXED FOOTER
                             ================================================ -->
                        <div class="page-footer-fixed">
                            <table style="width: 100%; border-collapse: collapse;">
                                <tr>
                                    <td style="width: 50%; text-align: left; vertical-align: middle; padding: 4px 0;">
                                        <span style="font-size: 8pt; color: #666666;">Powered by</span>
                                        <img src="/ops_matrix_accounting/static/src/img/ops_badge_footer.png"
                                             style="height: 16px; vertical-align: middle; margin-left: 4px;"
                                             alt="OPS Framework"/>
                                    </td>
                                    <td style="width: 50%; text-align: right; vertical-align: middle; padding: 4px 0;">
                                        <span style="font-size: 6.5pt; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.5px;">
                                            Confidential &#x2014; For authorized personnel only
                                        </span>
                                    </td>
                                </tr>
                            </table>
                        </div>

                    </div>
                </t>
            </t>
        </t>
    </template>

    <record id="action_report_bank_book" model="ir.actions.report">
        <field name="name">Bank Book</field>
        <field name="model">ops.bank.book.wizard</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">ops_matrix_accounting.report_bank_book_corporate</field>
        <field name="report_file">ops_matrix_accounting.report_bank_book_corporate</field>
        <field name="print_report_name">'Bank_Book_%s_%s' % (object.date_from, object.date_to)</field>
        <field name="binding_type">report</field>
        <field name="paperformat_id" ref="paperformat_ops_corporate_a4"/>
    </record>

</odoo>
