<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!--
        OPS CORPORATE REPORT COMPONENTS
        ================================
        Version: 1.0.0
        Reference: OPS_REPORT_BRANDING_GUIDE_v1.0.0

        SHARED COMPONENTS FOR ALL 16 OFFICIAL CORPORATE REPORTS:

        FINANCIAL (9):
        1. Balance Sheet
        2. Profit & Loss Statement
        3. Cash Flow Statement
        4. Trial Balance
        5. General Ledger
        6. Aged Receivables
        7. Aged Payables
        8. Partner Ledger
        9. Statement of Account

        TREASURY (3):
        10. PDC Registry
        11. PDC Maturity Analysis
        12. PDCs in Hand

        ASSET (2):
        13. Fixed Asset Register
        14. Depreciation Schedule

        INVENTORY (2):
        15. Stock Valuation
        16. Inventory Aging

        DESIGN: wkhtmltopdf compatible (CSS2.1, table-based layouts)
    -->

    <!-- ================================================================
         CORPORATE REPORT HEADER
         Shared component for all OPS corporate reports
         ================================================================ -->

    <template id="report_corporate_header">
        <!-- Gold Accent Bar - OPS Brand Color #5B6BBB or Company Primary -->
        <div style="height: 4px; background-color: #5B6BBB; margin-bottom: 0;"></div>

        <!-- Two-Column Header Table -->
        <table width="100%" style="border-collapse: collapse; margin-top: 15px; margin-bottom: 10px;">
            <tr>
                <!-- Company Info (Left) -->
                <td style="vertical-align: top; width: 60%;">
                    <table style="border-collapse: collapse;">
                        <tr>
                            <!-- Company Logo -->
                            <t t-if="doc.company_id.logo">
                                <td style="vertical-align: middle; padding-right: 15px;">
                                    <img t-att-src="image_data_uri(doc.company_id.logo)"
                                         style="max-height: 50px; max-width: 120px;"
                                         alt="Company Logo"/>
                                </td>
                            </t>
                            <t t-else="">
                                <td style="vertical-align: middle; padding-right: 15px;">
                                    <div style="width: 50px; height: 50px; background-color: #5B6BBB;
                                                color: #ffffff; font-size: 18px; font-weight: bold;
                                                text-align: center; line-height: 50px; border-radius: 4px;">
                                        <t t-esc="doc.company_id.name[:2].upper()"/>
                                    </div>
                                </td>
                            </t>
                            <!-- Company Details -->
                            <td style="vertical-align: middle;">
                                <div style="font-size: 16px; font-weight: 700; color: #1e293b; margin: 0;
                                            font-family: Arial, Helvetica, sans-serif;">
                                    <t t-esc="doc.company_id.name"/>
                                </div>
                                <div style="font-size: 10px; color: #64748b; margin-top: 3px;
                                            font-family: Arial, Helvetica, sans-serif;">
                                    <t t-if="doc.company_id.city">
                                        <t t-esc="doc.company_id.city"/><t t-if="doc.company_id.country_id">, </t>
                                    </t>
                                    <t t-esc="doc.company_id.country_id.name or ''"/>
                                </div>
                            </td>
                        </tr>
                    </table>
                </td>

                <!-- Report Meta (Right) -->
                <td style="vertical-align: top; width: 40%; text-align: right;">
                    <div style="font-size: 9px; color: #94a3b8; text-transform: uppercase;
                                letter-spacing: 0.5px; font-family: Arial, Helvetica, sans-serif;">
                        Printed: <t t-esc="context_timestamp(datetime.datetime.now()).strftime('%b %d, %Y %H:%M')"/>
                    </div>
                    <div style="font-size: 9px; color: #94a3b8; margin-top: 3px;
                                font-family: Arial, Helvetica, sans-serif;">
                        Generated by: <t t-esc="user.name"/>
                    </div>
                </td>
            </tr>
        </table>

        <!-- Separator Line -->
        <div style="height: 1px; background-color: #e2e8f0; margin: 10px 0;"></div>
    </template>

    <!-- ================================================================
         REPORT TITLE SECTION
         Title + Pillar + Period display
         ================================================================ -->

    <template id="report_corporate_title">
        <div style="text-align: center; margin: 20px 0 25px 0;">
            <!-- Report Title -->
            <h1 style="font-size: 24px; font-weight: 300; font-family: Georgia, 'Times New Roman', serif;
                       color: #1e293b; margin: 0; line-height: 1.2;">
                <t t-esc="report_title or 'Financial Report'"/>
            </h1>

            <!-- Pillar/Category -->
            <t t-if="report_pillar">
                <div style="font-size: 10px; color: #64748b; text-transform: uppercase;
                            letter-spacing: 1px; margin-top: 5px; font-family: Arial, Helvetica, sans-serif;">
                    <t t-esc="report_pillar"/>
                </div>
            </t>

            <!-- Period Display -->
            <div style="font-size: 11px; color: #475569; margin-top: 8px;
                        font-family: Arial, Helvetica, sans-serif;">
                <t t-if="date_from and date_to">
                    Period: <span style="font-weight: 600;"><t t-esc="date_from"/></span>
                    to <span style="font-weight: 600;"><t t-esc="date_to"/></span>
                </t>
                <t t-elif="date_end">
                    As of: <span style="font-weight: 600;"><t t-esc="date_end"/></span>
                </t>
            </div>
        </div>
    </template>

    <!-- ================================================================
         REPORT FILTER INFO BAR
         Shows applied filters for context
         ================================================================ -->

    <template id="report_filter_bar">
        <div style="background-color: #f8fafc; border: 1px solid #e2e8f0; border-radius: 4px;
                    padding: 10px 15px; margin-bottom: 20px;">
            <table width="100%" style="border-collapse: collapse; font-size: 9px;
                                       font-family: Arial, Helvetica, sans-serif;">
                <tr>
                    <!-- Scope -->
                    <td style="padding-right: 20px; vertical-align: middle;">
                        <span style="color: #64748b; text-transform: uppercase; letter-spacing: 0.5px;">Scope:</span>
                        <span style="color: #1e293b; font-weight: 600; margin-left: 5px;">
                            <t t-if="doc.branch_ids">
                                <t t-esc="', '.join(doc.branch_ids.mapped('name')[:3])"/>
                                <t t-if="len(doc.branch_ids) > 3"> (+<t t-esc="len(doc.branch_ids) - 3"/> more)</t>
                            </t>
                            <t t-else="">Consolidated</t>
                        </span>
                    </td>

                    <!-- Currency -->
                    <td style="padding-right: 20px; vertical-align: middle;">
                        <span style="color: #64748b; text-transform: uppercase; letter-spacing: 0.5px;">Currency:</span>
                        <span style="color: #1e293b; font-weight: 600; margin-left: 5px;">
                            <t t-esc="doc.company_id.currency_id.name"/>
                        </span>
                    </td>

                    <!-- Business Units (if applicable) -->
                    <t t-if="doc.business_unit_ids">
                        <td style="padding-right: 20px; vertical-align: middle;">
                            <span style="color: #64748b; text-transform: uppercase; letter-spacing: 0.5px;">Business Units:</span>
                            <span style="color: #1e293b; font-weight: 600; margin-left: 5px;">
                                <t t-esc="', '.join(doc.business_unit_ids.mapped('name')[:2])"/>
                                <t t-if="len(doc.business_unit_ids) > 2"> (+<t t-esc="len(doc.business_unit_ids) - 2"/>)</t>
                            </span>
                        </td>
                    </t>

                    <!-- Status (if applicable) -->
                    <t t-if="doc.target_move">
                        <td style="vertical-align: middle;">
                            <span style="color: #64748b; text-transform: uppercase; letter-spacing: 0.5px;">Entries:</span>
                            <span style="color: #1e293b; font-weight: 600; margin-left: 5px;">
                                <t t-if="doc.target_move == 'posted'">Posted Only</t>
                                <t t-else="">All Entries</t>
                            </span>
                        </td>
                    </t>
                </tr>
            </table>
        </div>
    </template>

    <!-- ================================================================
         REPORT NOTES SECTION
         For disclosures and compliance notes
         ================================================================ -->

    <template id="report_notes_section">
        <div style="margin-top: 30px; padding-top: 15px; border-top: 1px solid #e2e8f0;">
            <div style="font-size: 10px; font-weight: 600; color: #64748b; text-transform: uppercase;
                        letter-spacing: 0.5px; margin-bottom: 8px; font-family: Arial, Helvetica, sans-serif;">
                Notes:
            </div>
            <div style="font-size: 9px; color: #64748b; font-family: Arial, Helvetica, sans-serif;">
                <ul style="margin: 0; padding-left: 15px; list-style-type: disc;">
                    <li style="margin-bottom: 3px;">
                        All amounts are in <t t-esc="doc.company_id.currency_id.name"/> unless otherwise stated.
                    </li>
                    <t t-if="doc.show_comparison">
                        <li style="margin-bottom: 3px;">
                            Comparative figures are for the same period in the prior year.
                        </li>
                    </t>
                    <t t-if="doc.target_move == 'posted'">
                        <li style="margin-bottom: 3px;">
                            This report includes posted entries only.
                        </li>
                    </t>
                    <t t-if="doc.branch_ids">
                        <li style="margin-bottom: 3px;">
                            Data is filtered by selected branch(es).
                        </li>
                    </t>
                    <li style="margin-bottom: 3px;">
                        Negative values are shown in parentheses with red color.
                    </li>
                </ul>
            </div>
        </div>
    </template>

    <!-- ================================================================
         CORPORATE REPORT FOOTER
         With OPS Framework branding badge
         ================================================================ -->

    <template id="report_corporate_footer">
        <div style="margin-top: 30px; padding-top: 15px; border-top: 1px solid #e2e8f0;">
            <table width="100%" style="border-collapse: collapse; font-family: Arial, Helvetica, sans-serif;">
                <tr>
                    <!-- Branding (Left) -->
                    <td style="vertical-align: middle; width: 50%;">
                        <span style="font-size: 8px; color: #94a3b8;">Powered by</span>
                        <span style="display: inline-block; background: linear-gradient(135deg, #3b82f6, #1e40af);
                                     color: #ffffff; padding: 3px 8px; border-radius: 4px; font-size: 7pt;
                                     font-weight: 600; margin-left: 5px; letter-spacing: 0.5px;
                                     text-transform: uppercase;">
                            OPS Framework
                        </span>
                    </td>

                    <!-- Page Info (Right) -->
                    <td style="text-align: right; vertical-align: middle; width: 50%;">
                        <span style="font-size: 9px; color: #64748b;">
                            Page <span class="page"/> of <span class="topage"/>
                        </span>
                    </td>
                </tr>
            </table>
        </div>
    </template>

    <!-- ================================================================
         NUMBER FORMATTING HELPERS
         ================================================================ -->

    <!-- Format amount with color coding -->
    <template id="format_corporate_amount">
        <t t-if="not value or value == 0">
            <span style="color: #94a3b8;">0.00</span>
        </t>
        <t t-elif="value &lt; 0">
            <span style="color: #dc2626;">(<t t-esc="'{:,.2f}'.format(abs(value))"/>)</span>
        </t>
        <t t-else="">
            <span style="color: #1e293b;"><t t-esc="'{:,.2f}'.format(value)"/></span>
        </t>
    </template>

    <!-- Format percentage -->
    <template id="format_corporate_percentage">
        <t t-if="not value or value == 0">
            <span style="color: #94a3b8;">0.0%</span>
        </t>
        <t t-elif="value &lt; 0">
            <span style="color: #dc2626;">(<t t-esc="'{:.1f}'.format(abs(value))"/>%)</span>
        </t>
        <t t-else="">
            <span style="color: #16a34a;"><t t-esc="'{:.1f}'.format(value)"/>%</span>
        </t>
    </template>

    <!-- Format variance (with arrow indicators) -->
    <template id="format_corporate_variance">
        <t t-if="not value or value == 0">
            <span style="color: #94a3b8;">-</span>
        </t>
        <t t-elif="value &lt; 0">
            <span style="color: #dc2626;">
                <t t-esc="'{:,.2f}'.format(value)"/>
            </span>
        </t>
        <t t-else="">
            <span style="color: #16a34a;">
                +<t t-esc="'{:,.2f}'.format(value)"/>
            </span>
        </t>
    </template>

    <!-- ================================================================
         SECTION HEADER TEMPLATES
         Color-coded by report pillar
         ================================================================ -->

    <!-- Financial Section Header (Blue accent) -->
    <template id="section_header_financial">
        <div style="background-color: #f8fafc; border-left: 4px solid #5B6BBB;
                    padding: 8px 12px; margin: 15px 0 10px 0;">
            <span style="font-size: 12px; font-weight: 600; color: #1e293b; text-transform: uppercase;
                         letter-spacing: 0.5px; font-family: Arial, Helvetica, sans-serif;">
                <t t-esc="section_title"/>
            </span>
        </div>
    </template>

    <!-- Asset Section Header (Green accent) -->
    <template id="section_header_asset">
        <div style="background-color: #f0fdf4; border-left: 4px solid #16a34a;
                    padding: 8px 12px; margin: 15px 0 10px 0;">
            <span style="font-size: 12px; font-weight: 600; color: #1e293b; text-transform: uppercase;
                         letter-spacing: 0.5px; font-family: Arial, Helvetica, sans-serif;">
                <t t-esc="section_title"/>
            </span>
        </div>
    </template>

    <!-- Liability Section Header (Orange accent) -->
    <template id="section_header_liability">
        <div style="background-color: #fff7ed; border-left: 4px solid #f59e0b;
                    padding: 8px 12px; margin: 15px 0 10px 0;">
            <span style="font-size: 12px; font-weight: 600; color: #1e293b; text-transform: uppercase;
                         letter-spacing: 0.5px; font-family: Arial, Helvetica, sans-serif;">
                <t t-esc="section_title"/>
            </span>
        </div>
    </template>

    <!-- Equity Section Header (Purple accent) -->
    <template id="section_header_equity">
        <div style="background-color: #faf5ff; border-left: 4px solid #9333ea;
                    padding: 8px 12px; margin: 15px 0 10px 0;">
            <span style="font-size: 12px; font-weight: 600; color: #1e293b; text-transform: uppercase;
                         letter-spacing: 0.5px; font-family: Arial, Helvetica, sans-serif;">
                <t t-esc="section_title"/>
            </span>
        </div>
    </template>

    <!-- Revenue Section Header (Green accent) -->
    <template id="section_header_revenue">
        <div style="background-color: #f0fdf4; border-left: 4px solid #16a34a;
                    padding: 8px 12px; margin: 15px 0 10px 0;">
            <span style="font-size: 12px; font-weight: 600; color: #1e293b; text-transform: uppercase;
                         letter-spacing: 0.5px; font-family: Arial, Helvetica, sans-serif;">
                <t t-esc="section_title"/>
            </span>
        </div>
    </template>

    <!-- Expense Section Header (Red accent) -->
    <template id="section_header_expense">
        <div style="background-color: #fef2f2; border-left: 4px solid #dc2626;
                    padding: 8px 12px; margin: 15px 0 10px 0;">
            <span style="font-size: 12px; font-weight: 600; color: #1e293b; text-transform: uppercase;
                         letter-spacing: 0.5px; font-family: Arial, Helvetica, sans-serif;">
                <t t-esc="section_title"/>
            </span>
        </div>
    </template>

    <!-- Treasury Section Header (Cyan accent) -->
    <template id="section_header_treasury">
        <div style="background-color: #ecfeff; border-left: 4px solid #0891b2;
                    padding: 8px 12px; margin: 15px 0 10px 0;">
            <span style="font-size: 12px; font-weight: 600; color: #1e293b; text-transform: uppercase;
                         letter-spacing: 0.5px; font-family: Arial, Helvetica, sans-serif;">
                <t t-esc="section_title"/>
            </span>
        </div>
    </template>

    <!-- ================================================================
         TABLE STYLING TEMPLATES
         ================================================================ -->

    <!-- Data Table Header Row -->
    <template id="table_header_row">
        <tr style="border-bottom: 2px solid #1e293b;">
            <t t-foreach="columns" t-as="col">
                <th t-att-style="'padding: 8px 10px; font-size: 9px; font-weight: 600; color: #1e293b;
                                  text-transform: uppercase; letter-spacing: 0.5px;
                                  text-align: ' + (col.get('align', 'left')) + ';
                                  font-family: Arial, Helvetica, sans-serif;'">
                    <t t-esc="col.get('label', '')"/>
                </th>
            </t>
        </tr>
    </template>

    <!-- Subtotal Row -->
    <template id="subtotal_row">
        <tr style="border-top: 1px solid #e2e8f0; background-color: #f8fafc;">
            <td t-att-colspan="label_colspan or 1"
                style="padding: 6px 10px; font-size: 10px; font-weight: 600; color: #475569;
                       font-family: Arial, Helvetica, sans-serif;">
                <t t-esc="label"/>
            </td>
            <td t-att-style="'padding: 6px 10px; font-size: 10px; font-weight: 600; color: #1e293b;
                             text-align: right; font-family: Consolas, Monaco, monospace;'">
                <t t-call="ops_matrix_accounting.format_corporate_amount">
                    <t t-set="value" t-value="amount"/>
                </t>
            </td>
        </tr>
    </template>

    <!-- Grand Total Row -->
    <template id="grand_total_row">
        <tr style="border-top: 2px solid #1e293b; border-bottom: 3px double #1e293b;
                   background-color: #f1f5f9;">
            <td t-att-colspan="label_colspan or 1"
                style="padding: 10px; font-size: 11px; font-weight: 700; color: #1e293b;
                       text-transform: uppercase; letter-spacing: 0.5px;
                       font-family: Arial, Helvetica, sans-serif;">
                <t t-esc="label"/>
            </td>
            <td t-att-style="'padding: 10px; font-size: 12px; font-weight: 700; color: #1e293b;
                             text-align: right; font-family: Consolas, Monaco, monospace;'">
                <t t-call="ops_matrix_accounting.format_corporate_amount">
                    <t t-set="value" t-value="amount"/>
                </t>
            </td>
        </tr>
    </template>

    <!-- ================================================================
         VERIFICATION BADGE TEMPLATES
         ================================================================ -->

    <!-- Balance Check Badge -->
    <template id="balance_check_badge">
        <div style="text-align: center; margin-top: 20px;">
            <t t-if="is_balanced">
                <span style="display: inline-block; background-color: #dcfce7; color: #16a34a;
                             padding: 8px 16px; border-radius: 4px; font-size: 11px; font-weight: 600;
                             border: 1px solid #86efac; font-family: Arial, Helvetica, sans-serif;">
                    BALANCED
                </span>
            </t>
            <t t-else="">
                <span style="display: inline-block; background-color: #fef2f2; color: #dc2626;
                             padding: 8px 16px; border-radius: 4px; font-size: 11px; font-weight: 600;
                             border: 1px solid #fecaca; font-family: Arial, Helvetica, sans-serif;">
                    UNBALANCED - Difference: <t t-esc="'{:,.2f}'.format(difference or 0)"/>
                </span>
            </t>
        </div>
    </template>

    <!-- ================================================================
         KPI CARD TEMPLATE
         ================================================================ -->

    <template id="kpi_card">
        <div t-att-style="'display: inline-block; width: ' + (width or '23%') + ';
                          margin-right: 1%; vertical-align: top;
                          background-color: #ffffff; border: 1px solid #e2e8f0;
                          border-top: 3px solid ' + (accent_color or '#5B6BBB') + ';
                          border-radius: 4px; padding: 12px; text-align: center;'">
            <div style="font-size: 9px; color: #64748b; text-transform: uppercase;
                        letter-spacing: 0.5px; margin-bottom: 5px;
                        font-family: Arial, Helvetica, sans-serif;">
                <t t-esc="label"/>
            </div>
            <div style="font-size: 18px; font-weight: 700; color: #1e293b;
                        font-family: Consolas, Monaco, monospace;">
                <t t-call="ops_matrix_accounting.format_corporate_amount">
                    <t t-set="value" t-value="amount"/>
                </t>
            </div>
            <t t-if="subtitle">
                <div style="font-size: 8px; color: #94a3b8; margin-top: 3px;
                            font-family: Arial, Helvetica, sans-serif;">
                    <t t-esc="subtitle"/>
                </div>
            </t>
        </div>
    </template>

</odoo>
